2022-08-22 11:15:12.985549 (MainThread): Running with dbt=0.21.1
2022-08-22 11:15:13.090287 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-08-22 11:15:13.092109 (MainThread): Tracking: tracking
2022-08-22 11:15:13.105333 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117d1a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd6990>]}
2022-08-22 11:15:13.120739 (MainThread): Partial parsing not enabled
2022-08-22 11:15:13.133995 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:15:13.138446 (MainThread): Parsing macros/relations.sql
2022-08-22 11:15:13.140331 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:15:13.170938 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:15:13.173281 (MainThread): Parsing macros/core.sql
2022-08-22 11:15:13.178485 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:15:13.187727 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:15:13.200714 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:15:13.202946 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:15:13.226672 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:15:13.274428 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:15:13.305963 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:15:13.308303 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:15:13.322687 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:15:13.350625 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:15:13.369884 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:15:13.381160 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:15:13.391785 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:15:13.397119 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:15:13.399108 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:15:13.400390 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:15:13.402484 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:15:13.414392 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:15:13.416895 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:15:13.420516 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:15:13.422964 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:15:13.501070 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:15:13.503397 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:15:13.504954 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:15:13.506711 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:15:13.739346 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:15:13.755893 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:15:13.791165 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:15:13.793405 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:15:13.795640 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:15:13.797685 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:15:13.822393 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-22 11:15:13.829157 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06278848-f145-43bf-82ad-48d8173c4eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d91a10>]}
2022-08-22 11:15:13.835177 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:15:13.835630 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06278848-f145-43bf-82ad-48d8173c4eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dbf490>]}
2022-08-22 11:15:13.835949 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-22 11:15:13.837401 (MainThread): 
2022-08-22 11:15:13.837790 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:15:13.838704 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:15:13.851498 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:15:13.851811 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:15:13.852004 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:15:13.922393 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.07 seconds
2022-08-22 11:15:13.922727 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:15:13.922943 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:15:13.954737 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.03 seconds
2022-08-22 11:15:13.956783 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:15:13.957920 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:15:13.963517 (MainThread): Using postgres connection "master".
2022-08-22 11:15:13.963828 (MainThread): On master: BEGIN
2022-08-22 11:15:13.964064 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:15:13.980847 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:15:13.981166 (MainThread): Using postgres connection "master".
2022-08-22 11:15:13.981369 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:15:14.164171 (MainThread): SQL status: SELECT 37 in 0.18 seconds
2022-08-22 11:15:14.170373 (MainThread): On master: ROLLBACK
2022-08-22 11:15:14.171792 (MainThread): On master: Close
2022-08-22 11:15:14.172567 (MainThread): 14:15:14 | Concurrency: 4 threads (target='dev')
2022-08-22 11:15:14.173006 (MainThread): 14:15:14 | 
2022-08-22 11:15:14.177317 (Thread-1): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:15:14.178043 (Thread-1): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:15:14.178338 (Thread-1): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:15:14.181209 (Thread-1): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:15:14.181974 (Thread-1): finished collecting timing info
2022-08-22 11:15:14.182276 (Thread-1): finished collecting timing info
2022-08-22 11:15:14.182779 (Thread-1): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:15:14.183457 (Thread-3): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 11:15:14.183876 (Thread-4): Began running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:15:14.184130 (Thread-2): Began running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:15:14.184528 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:15:14.184945 (Thread-4): Acquiring new postgres connection "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710".
2022-08-22 11:15:14.185338 (Thread-2): Acquiring new postgres connection "test.dbt_test.unique_my_first_dbt_model_id.16e066b321".
2022-08-22 11:15:14.185583 (Thread-3): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 11:15:14.185803 (Thread-4): Compiling test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:15:14.186016 (Thread-2): Compiling test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:15:14.188446 (Thread-3): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:15:14.212543 (Thread-2): Writing injected SQL for node "test.dbt_test.unique_my_first_dbt_model_id.16e066b321"
2022-08-22 11:15:14.212962 (Thread-4): Writing injected SQL for node "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710"
2022-08-22 11:15:14.213516 (Thread-3): finished collecting timing info
2022-08-22 11:15:14.213887 (Thread-3): finished collecting timing info
2022-08-22 11:15:14.214336 (Thread-3): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 11:15:14.214565 (Thread-4): finished collecting timing info
2022-08-22 11:15:14.214866 (Thread-2): finished collecting timing info
2022-08-22 11:15:14.215156 (Thread-4): finished collecting timing info
2022-08-22 11:15:14.215470 (Thread-1): Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:15:14.215694 (Thread-2): finished collecting timing info
2022-08-22 11:15:14.215900 (Thread-3): Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:15:14.216274 (Thread-4): Finished running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:15:14.216623 (Thread-1): Acquiring new postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 11:15:14.216999 (Thread-2): Finished running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:15:14.217358 (Thread-3): Acquiring new postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 11:15:14.217681 (Thread-1): Compiling test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:15:14.217982 (Thread-3): Compiling test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:15:14.221897 (Thread-1): Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 11:15:14.225244 (Thread-3): Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 11:15:14.225696 (Thread-1): finished collecting timing info
2022-08-22 11:15:14.225958 (Thread-1): finished collecting timing info
2022-08-22 11:15:14.226178 (Thread-3): finished collecting timing info
2022-08-22 11:15:14.226535 (Thread-1): Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:15:14.226768 (Thread-3): finished collecting timing info
2022-08-22 11:15:14.227215 (Thread-3): Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:15:14.281771 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:15:14.282046 (MainThread): Connection 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
2022-08-22 11:15:14.282283 (MainThread): Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
2022-08-22 11:15:14.282517 (MainThread): Connection 'test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
2022-08-22 11:15:14.282745 (MainThread): Connection 'test.dbt_test.unique_my_first_dbt_model_id.16e066b321' was properly closed.
2022-08-22 11:15:14.289266 (MainThread): 14:15:14 | Done.
2022-08-22 11:15:14.289656 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d57990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d57790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c90dd0>]}
2022-08-22 11:15:14.290033 (MainThread): Flushing usage events
2022-08-22 11:16:44.241711 (MainThread): Running with dbt=0.21.1
2022-08-22 11:16:44.333740 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-08-22 11:16:44.335363 (MainThread): Tracking: tracking
2022-08-22 11:16:44.347669 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f328750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f328950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f809d50>]}
2022-08-22 11:16:44.362223 (MainThread): Partial parsing not enabled
2022-08-22 11:16:44.373411 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:16:44.377759 (MainThread): Parsing macros/relations.sql
2022-08-22 11:16:44.379696 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:16:44.410695 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:16:44.413056 (MainThread): Parsing macros/core.sql
2022-08-22 11:16:44.418073 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:16:44.427431 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:16:44.440810 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:16:44.443055 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:16:44.466878 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:16:44.517219 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:16:44.549390 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:16:44.551748 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:16:44.566442 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:16:44.595178 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:16:44.614868 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:16:44.626481 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:16:44.637182 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:16:44.642388 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:16:44.644355 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:16:44.645614 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:16:44.647885 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:16:44.660083 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:16:44.662549 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:16:44.665817 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:16:44.667957 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:16:44.745784 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:16:44.748120 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:16:44.749708 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:16:44.751530 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:16:44.983052 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:16:44.999637 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:16:45.050380 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:16:45.052661 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:16:45.054790 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:16:45.056939 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:16:45.070984 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-22 11:16:45.077569 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f7edfcb-d1db-4276-aecd-7a8ac9ca3db2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f85bbd0>]}
2022-08-22 11:16:45.083047 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:16:45.083670 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f7edfcb-d1db-4276-aecd-7a8ac9ca3db2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f843490>]}
2022-08-22 11:16:45.083998 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:16:45.085552 (MainThread): 
2022-08-22 11:16:45.085951 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:16:45.086873 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:16:45.099575 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:16:45.099849 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:16:45.100059 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:16:45.151550 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.05 seconds
2022-08-22 11:16:45.151896 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:16:45.152109 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:16:45.175414 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.02 seconds
2022-08-22 11:16:45.177336 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:16:45.178513 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:16:45.183419 (MainThread): Using postgres connection "master".
2022-08-22 11:16:45.183689 (MainThread): On master: BEGIN
2022-08-22 11:16:45.183896 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:16:45.200027 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:16:45.200354 (MainThread): Using postgres connection "master".
2022-08-22 11:16:45.200566 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:16:45.362637 (MainThread): SQL status: SELECT 37 in 0.16 seconds
2022-08-22 11:16:45.370119 (MainThread): On master: ROLLBACK
2022-08-22 11:16:45.371398 (MainThread): On master: Close
2022-08-22 11:16:45.372169 (MainThread): 14:16:45 | Concurrency: 4 threads (target='dev')
2022-08-22 11:16:45.372608 (MainThread): 14:16:45 | 
2022-08-22 11:16:45.376009 (Thread-1): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:16:45.376622 (Thread-1): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:16:45.376924 (Thread-1): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:16:45.379786 (Thread-1): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:16:45.380403 (Thread-1): finished collecting timing info
2022-08-22 11:16:45.380689 (Thread-1): finished collecting timing info
2022-08-22 11:16:45.381091 (Thread-1): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:16:45.381542 (Thread-3): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 11:16:45.381799 (Thread-4): Began running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:16:45.382173 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:16:45.382371 (Thread-2): Began running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:16:45.382747 (Thread-4): Acquiring new postgres connection "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710".
2022-08-22 11:16:45.383037 (Thread-3): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 11:16:45.383443 (Thread-2): Acquiring new postgres connection "test.dbt_test.unique_my_first_dbt_model_id.16e066b321".
2022-08-22 11:16:45.383679 (Thread-4): Compiling test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:16:45.386168 (Thread-3): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:16:45.386427 (Thread-2): Compiling test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:16:45.401600 (Thread-4): Writing injected SQL for node "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710"
2022-08-22 11:16:45.410573 (Thread-2): Writing injected SQL for node "test.dbt_test.unique_my_first_dbt_model_id.16e066b321"
2022-08-22 11:16:45.411060 (Thread-3): finished collecting timing info
2022-08-22 11:16:45.411421 (Thread-3): finished collecting timing info
2022-08-22 11:16:45.411947 (Thread-3): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 11:16:45.412480 (Thread-4): finished collecting timing info
2022-08-22 11:16:45.412746 (Thread-2): finished collecting timing info
2022-08-22 11:16:45.413022 (Thread-4): finished collecting timing info
2022-08-22 11:16:45.413264 (Thread-1): Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:16:45.413529 (Thread-3): Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:16:45.413768 (Thread-2): finished collecting timing info
2022-08-22 11:16:45.414211 (Thread-4): Finished running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:16:45.414603 (Thread-1): Acquiring new postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 11:16:45.414975 (Thread-3): Acquiring new postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 11:16:45.415385 (Thread-2): Finished running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:16:45.415757 (Thread-1): Compiling test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:16:45.415999 (Thread-3): Compiling test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:16:45.419980 (Thread-1): Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 11:16:45.424457 (Thread-3): Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 11:16:45.425009 (Thread-1): finished collecting timing info
2022-08-22 11:16:45.425257 (Thread-3): finished collecting timing info
2022-08-22 11:16:45.425507 (Thread-1): finished collecting timing info
2022-08-22 11:16:45.425752 (Thread-3): finished collecting timing info
2022-08-22 11:16:45.426143 (Thread-1): Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:16:45.426529 (Thread-3): Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:16:45.481015 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:16:45.481316 (MainThread): Connection 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
2022-08-22 11:16:45.481564 (MainThread): Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
2022-08-22 11:16:45.481811 (MainThread): Connection 'test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
2022-08-22 11:16:45.482048 (MainThread): Connection 'test.dbt_test.unique_my_first_dbt_model_id.16e066b321' was properly closed.
2022-08-22 11:16:45.488363 (MainThread): 14:16:45 | Done.
2022-08-22 11:16:45.488771 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100a0090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100a0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100a0350>]}
2022-08-22 11:16:45.489116 (MainThread): Flushing usage events
2022-08-22 11:19:19.663203 (MainThread): Running with dbt=0.21.1
2022-08-22 11:19:19.753905 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 11:19:19.755528 (MainThread): Tracking: tracking
2022-08-22 11:19:19.768542 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b850950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b885d50>]}
2022-08-22 11:19:19.783217 (MainThread): Partial parsing not enabled
2022-08-22 11:19:19.794377 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:19:19.798524 (MainThread): Parsing macros/relations.sql
2022-08-22 11:19:19.800393 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:19:19.830545 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:19:19.832861 (MainThread): Parsing macros/core.sql
2022-08-22 11:19:19.837814 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:19:19.847051 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:19:19.860136 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:19:19.862341 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:19:19.885749 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:19:19.933357 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:19:19.964667 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:19:19.966969 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:19:19.981229 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:19:20.009106 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:19:20.028562 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:19:20.039757 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:19:20.050103 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:19:20.055265 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:19:20.057220 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:19:20.058477 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:19:20.060558 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:19:20.072254 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:19:20.074622 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:19:20.077784 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:19:20.079831 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:19:20.154405 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:19:20.156621 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:19:20.158156 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:19:20.159874 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:19:20.388595 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:19:20.404853 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:19:20.455128 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:19:20.457380 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:19:20.459438 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:19:20.461505 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:19:20.475325 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-22 11:19:20.481996 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1437528-c2b5-478c-a011-157d46661928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2fe1d0>]}
2022-08-22 11:19:20.487635 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:19:20.488291 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1437528-c2b5-478c-a011-157d46661928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2fdfd0>]}
2022-08-22 11:19:20.488606 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:19:20.490080 (MainThread): 
2022-08-22 11:19:20.490480 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:19:20.491478 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 11:19:20.503940 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 11:19:20.504259 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 11:19:20.504472 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:19:20.560596 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-08-22 11:19:20.562647 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 11:19:20.563471 (ThreadPoolExecutor-0_1): Acquiring new postgres connection "create_dvdrental_dvd_schema".
2022-08-22 11:19:20.563932 (ThreadPoolExecutor-0_1): Acquiring new postgres connection "create_dvdrental_dvd_schema".
2022-08-22 11:19:20.564231 (ThreadPoolExecutor-0_1): Creating schema ""dvdrental"."dvd_schema""
2022-08-22 11:19:20.570728 (ThreadPoolExecutor-0_1): Using postgres connection "create_dvdrental_dvd_schema".
2022-08-22 11:19:20.570977 (ThreadPoolExecutor-0_1): On create_dvdrental_dvd_schema: BEGIN
2022-08-22 11:19:20.571177 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state init
2022-08-22 11:19:20.587768 (ThreadPoolExecutor-0_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:19:20.588101 (ThreadPoolExecutor-0_1): Using postgres connection "create_dvdrental_dvd_schema".
2022-08-22 11:19:20.588308 (ThreadPoolExecutor-0_1): On create_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dvdrental_dvd_schema"} */
create schema if not exists "dvd_schema"
2022-08-22 11:19:20.596747 (ThreadPoolExecutor-0_1): SQL status: CREATE SCHEMA in 0.01 seconds
2022-08-22 11:19:20.597846 (ThreadPoolExecutor-0_1): On create_dvdrental_dvd_schema: COMMIT
2022-08-22 11:19:20.598081 (ThreadPoolExecutor-0_1): Using postgres connection "create_dvdrental_dvd_schema".
2022-08-22 11:19:20.598278 (ThreadPoolExecutor-0_1): On create_dvdrental_dvd_schema: COMMIT
2022-08-22 11:19:20.602309 (ThreadPoolExecutor-0_1): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:19:20.602591 (ThreadPoolExecutor-0_1): On create_dvdrental_dvd_schema: Close
2022-08-22 11:19:20.603904 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:19:20.610882 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:19:20.611304 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:19:20.611525 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 11:19:20.629181 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:19:20.629511 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:19:20.629716 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:19:20.643789 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2022-08-22 11:19:20.645181 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:19:20.646299 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:19:20.651069 (MainThread): Using postgres connection "master".
2022-08-22 11:19:20.651352 (MainThread): On master: BEGIN
2022-08-22 11:19:20.651566 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:19:20.666756 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:19:20.667073 (MainThread): Using postgres connection "master".
2022-08-22 11:19:20.667298 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:19:20.820674 (MainThread): SQL status: SELECT 37 in 0.15 seconds
2022-08-22 11:19:20.826108 (MainThread): On master: ROLLBACK
2022-08-22 11:19:20.827619 (MainThread): Using postgres connection "master".
2022-08-22 11:19:20.828066 (MainThread): On master: BEGIN
2022-08-22 11:19:20.830145 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 11:19:20.830621 (MainThread): On master: COMMIT
2022-08-22 11:19:20.831024 (MainThread): Using postgres connection "master".
2022-08-22 11:19:20.831409 (MainThread): On master: COMMIT
2022-08-22 11:19:20.832694 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:19:20.833135 (MainThread): On master: Close
2022-08-22 11:19:20.833950 (MainThread): 14:19:20 | Concurrency: 4 threads (target='dev')
2022-08-22 11:19:20.834395 (MainThread): 14:19:20 | 
2022-08-22 11:19:20.838012 (Thread-1): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:19:20.838683 (Thread-1): 14:19:20 | 1 of 2 START table model dvd_schema.my_first_dbt_model............... [RUN]
2022-08-22 11:19:20.839158 (Thread-1): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:19:20.839420 (Thread-1): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:19:20.842258 (Thread-1): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:19:20.842872 (Thread-1): finished collecting timing info
2022-08-22 11:19:20.878812 (Thread-1): Writing runtime SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:19:20.879830 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:19:20.880088 (Thread-1): On model.dbt_test.my_first_dbt_model: BEGIN
2022-08-22 11:19:20.880320 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:19:20.897776 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:19:20.898130 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:19:20.898336 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */


  create  table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-08-22 11:19:20.922608 (Thread-1): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 11:19:20.929927 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:19:20.930163 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-08-22 11:19:20.931979 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:19:20.946056 (Thread-1): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:19:20.946345 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:19:20.946586 (Thread-1): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:19:20.951885 (Thread-1): SQL status: COMMIT in 0.01 seconds
2022-08-22 11:19:20.957471 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:19:20.957709 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_backup" cascade
2022-08-22 11:19:20.958980 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2022-08-22 11:19:20.960216 (Thread-1): finished collecting timing info
2022-08-22 11:19:20.960480 (Thread-1): On model.dbt_test.my_first_dbt_model: Close
2022-08-22 11:19:20.960927 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1437528-c2b5-478c-a011-157d46661928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb57dd0>]}
2022-08-22 11:19:20.961328 (Thread-1): 14:19:20 | 1 of 2 OK created table model dvd_schema.my_first_dbt_model.......... [SELECT 2 in 0.12s]
2022-08-22 11:19:20.961579 (Thread-1): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:19:20.962010 (Thread-3): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 11:19:20.962331 (Thread-3): 14:19:20 | 2 of 2 START view model dvd_schema.my_second_dbt_model............... [RUN]
2022-08-22 11:19:20.962694 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:19:20.962914 (Thread-3): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 11:19:20.965670 (Thread-3): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:19:20.966467 (Thread-3): finished collecting timing info
2022-08-22 11:19:20.989056 (Thread-3): Writing runtime SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:19:20.989705 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:19:20.989919 (Thread-3): On model.dbt_test.my_second_dbt_model: BEGIN
2022-08-22 11:19:20.990124 (Thread-3): Opening a new connection, currently in state init
2022-08-22 11:19:21.007291 (Thread-3): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:19:21.007649 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:19:21.007884 (Thread-3): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."dvd_schema"."my_first_dbt_model"
where id = 1
  );

2022-08-22 11:19:21.026510 (Thread-3): SQL status: CREATE VIEW in 0.02 seconds
2022-08-22 11:19:21.029183 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:19:21.029413 (Thread-3): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-08-22 11:19:21.030511 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:19:21.031729 (Thread-3): On model.dbt_test.my_second_dbt_model: COMMIT
2022-08-22 11:19:21.031951 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:19:21.032146 (Thread-3): On model.dbt_test.my_second_dbt_model: COMMIT
2022-08-22 11:19:21.036931 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:19:21.038769 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:19:21.039007 (Thread-3): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_backup" cascade
2022-08-22 11:19:21.040362 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-08-22 11:19:21.041528 (Thread-3): finished collecting timing info
2022-08-22 11:19:21.041788 (Thread-3): On model.dbt_test.my_second_dbt_model: Close
2022-08-22 11:19:21.042224 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1437528-c2b5-478c-a011-157d46661928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb0e350>]}
2022-08-22 11:19:21.042624 (Thread-3): 14:19:21 | 2 of 2 OK created view model dvd_schema.my_second_dbt_model.......... [CREATE VIEW in 0.08s]
2022-08-22 11:19:21.042868 (Thread-3): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 11:19:21.047050 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:19:21.047333 (MainThread): Using postgres connection "master".
2022-08-22 11:19:21.047528 (MainThread): On master: BEGIN
2022-08-22 11:19:21.047722 (MainThread): Opening a new connection, currently in state closed
2022-08-22 11:19:21.064378 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:19:21.064734 (MainThread): On master: COMMIT
2022-08-22 11:19:21.064950 (MainThread): Using postgres connection "master".
2022-08-22 11:19:21.065154 (MainThread): On master: COMMIT
2022-08-22 11:19:21.066282 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:19:21.066578 (MainThread): On master: Close
2022-08-22 11:19:21.067152 (MainThread): 14:19:21 | 
2022-08-22 11:19:21.067396 (MainThread): 14:19:21 | Finished running 1 table model, 1 view model in 0.58s.
2022-08-22 11:19:21.067623 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:19:21.067811 (MainThread): Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
2022-08-22 11:19:21.067992 (MainThread): Connection 'create_dvdrental_dvd_schema' was properly closed.
2022-08-22 11:19:21.068170 (MainThread): Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
2022-08-22 11:19:21.073318 (MainThread): 
2022-08-22 11:19:21.073612 (MainThread): Completed successfully
2022-08-22 11:19:21.073855 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-08-22 11:19:21.074153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb0bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e211090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa7b410>]}
2022-08-22 11:19:21.074473 (MainThread): Flushing usage events
2022-08-22 11:24:50.146427 (MainThread): Running with dbt=0.21.1
2022-08-22 11:24:50.250515 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 11:24:50.252190 (MainThread): Tracking: tracking
2022-08-22 11:24:50.265897 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f168150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1573d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f63fa90>]}
2022-08-22 11:24:50.281147 (MainThread): Partial parsing not enabled
2022-08-22 11:24:50.294510 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:24:50.298853 (MainThread): Parsing macros/relations.sql
2022-08-22 11:24:50.300723 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:24:50.331159 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:24:50.333475 (MainThread): Parsing macros/core.sql
2022-08-22 11:24:50.338455 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:24:50.347642 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:24:50.360789 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:24:50.362991 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:24:50.386519 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:24:50.434446 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:24:50.465771 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:24:50.468113 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:24:50.482452 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:24:50.510279 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:24:50.529413 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:24:50.540551 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:24:50.550885 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:24:50.556013 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:24:50.557952 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:24:50.559221 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:24:50.561276 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:24:50.572933 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:24:50.575304 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:24:50.578467 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:24:50.580516 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:24:50.655181 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:24:50.657385 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:24:50.658902 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:24:50.660677 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:24:50.891509 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:24:50.908205 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:24:50.958950 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:24:50.961216 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:24:50.963328 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:24:50.965482 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:24:50.987091 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '037d6222-7679-4dc9-aae2-07e65491f2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6b4b50>]}
2022-08-22 11:24:50.992617 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:24:50.993235 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '037d6222-7679-4dc9-aae2-07e65491f2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6ad3d0>]}
2022-08-22 11:24:50.993560 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:24:50.995082 (MainThread): 
2022-08-22 11:24:50.995486 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:24:50.996530 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 11:24:51.008866 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 11:24:51.009137 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 11:24:51.009342 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:24:51.079339 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.07 seconds
2022-08-22 11:24:51.081328 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 11:24:51.082506 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:24:51.089654 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:24:51.089917 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:24:51.090122 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 11:24:51.108888 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:24:51.109219 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:24:51.109426 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:24:51.128386 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 11:24:51.129908 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:24:51.130952 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:24:51.135766 (MainThread): Using postgres connection "master".
2022-08-22 11:24:51.136047 (MainThread): On master: BEGIN
2022-08-22 11:24:51.136252 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:24:51.151555 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:24:51.151880 (MainThread): Using postgres connection "master".
2022-08-22 11:24:51.152085 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:24:51.330765 (MainThread): SQL status: SELECT 38 in 0.18 seconds
2022-08-22 11:24:51.338674 (MainThread): On master: ROLLBACK
2022-08-22 11:24:51.340274 (MainThread): Using postgres connection "master".
2022-08-22 11:24:51.340512 (MainThread): On master: BEGIN
2022-08-22 11:24:51.342482 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 11:24:51.342717 (MainThread): On master: COMMIT
2022-08-22 11:24:51.342931 (MainThread): Using postgres connection "master".
2022-08-22 11:24:51.343120 (MainThread): On master: COMMIT
2022-08-22 11:24:51.344286 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:24:51.344531 (MainThread): On master: Close
2022-08-22 11:24:51.344962 (MainThread): 14:24:51 | Concurrency: 4 threads (target='dev')
2022-08-22 11:24:51.345201 (MainThread): 14:24:51 | 
2022-08-22 11:24:51.347614 (Thread-1): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:24:51.348067 (Thread-1): 14:24:51 | 1 of 2 START table model dvd_schema.my_first_dbt_model............... [RUN]
2022-08-22 11:24:51.348540 (Thread-1): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:24:51.348810 (Thread-1): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:24:51.351651 (Thread-1): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:24:51.352218 (Thread-1): finished collecting timing info
2022-08-22 11:24:51.386160 (Thread-1): Writing runtime SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:24:51.386885 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:24:51.387101 (Thread-1): On model.dbt_test.my_first_dbt_model: BEGIN
2022-08-22 11:24:51.387305 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:24:51.404908 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:24:51.405245 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:24:51.405459 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */


  create  table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-08-22 11:24:51.427985 (Thread-1): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 11:24:51.435383 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:24:51.435661 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-08-22 11:24:51.437053 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:24:51.439411 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:24:51.439630 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-08-22 11:24:51.441090 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:24:51.455133 (Thread-1): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:24:51.455414 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:24:51.455655 (Thread-1): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:24:51.459366 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:24:51.464937 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:24:51.465187 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_backup" cascade
2022-08-22 11:24:51.485786 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2022-08-22 11:24:51.487260 (Thread-1): finished collecting timing info
2022-08-22 11:24:51.487542 (Thread-1): On model.dbt_test.my_first_dbt_model: Close
2022-08-22 11:24:51.488022 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '037d6222-7679-4dc9-aae2-07e65491f2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fea60d0>]}
2022-08-22 11:24:51.488440 (Thread-1): 14:24:51 | 1 of 2 OK created table model dvd_schema.my_first_dbt_model.......... [SELECT 2 in 0.14s]
2022-08-22 11:24:51.488683 (Thread-1): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:24:51.489224 (Thread-3): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 11:24:51.489542 (Thread-3): 14:24:51 | 2 of 2 START view model dvd_schema.my_second_dbt_model............... [RUN]
2022-08-22 11:24:51.489916 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:24:51.490126 (Thread-3): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 11:24:51.492937 (Thread-3): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:24:51.493489 (Thread-3): finished collecting timing info
2022-08-22 11:24:51.516236 (Thread-3): Writing runtime SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:24:51.517045 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:24:51.517264 (Thread-3): On model.dbt_test.my_second_dbt_model: BEGIN
2022-08-22 11:24:51.517476 (Thread-3): Opening a new connection, currently in state init
2022-08-22 11:24:51.534298 (Thread-3): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:24:51.534651 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:24:51.534862 (Thread-3): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."dvd_schema"."my_first_dbt_model"
where id = 1
  );

2022-08-22 11:24:51.551143 (Thread-3): SQL status: CREATE VIEW in 0.02 seconds
2022-08-22 11:24:51.553790 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:24:51.554020 (Thread-3): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-08-22 11:24:51.555150 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:24:51.556376 (Thread-3): On model.dbt_test.my_second_dbt_model: COMMIT
2022-08-22 11:24:51.556601 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:24:51.556800 (Thread-3): On model.dbt_test.my_second_dbt_model: COMMIT
2022-08-22 11:24:51.561030 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:24:51.562797 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:24:51.563018 (Thread-3): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_backup" cascade
2022-08-22 11:24:51.564250 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-08-22 11:24:51.565454 (Thread-3): finished collecting timing info
2022-08-22 11:24:51.565720 (Thread-3): On model.dbt_test.my_second_dbt_model: Close
2022-08-22 11:24:51.566164 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '037d6222-7679-4dc9-aae2-07e65491f2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fea6710>]}
2022-08-22 11:24:51.566568 (Thread-3): 14:24:51 | 2 of 2 OK created view model dvd_schema.my_second_dbt_model.......... [CREATE VIEW in 0.08s]
2022-08-22 11:24:51.566810 (Thread-3): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 11:24:51.663061 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:24:51.663583 (MainThread): Using postgres connection "master".
2022-08-22 11:24:51.663909 (MainThread): On master: BEGIN
2022-08-22 11:24:51.664225 (MainThread): Opening a new connection, currently in state closed
2022-08-22 11:24:51.681298 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:24:51.681627 (MainThread): On master: COMMIT
2022-08-22 11:24:51.681845 (MainThread): Using postgres connection "master".
2022-08-22 11:24:51.682041 (MainThread): On master: COMMIT
2022-08-22 11:24:51.683244 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:24:51.683506 (MainThread): On master: Close
2022-08-22 11:24:51.683948 (MainThread): 14:24:51 | 
2022-08-22 11:24:51.684185 (MainThread): 14:24:51 | Finished running 1 table model, 1 view model in 0.69s.
2022-08-22 11:24:51.684403 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:24:51.684591 (MainThread): Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
2022-08-22 11:24:51.684773 (MainThread): Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
2022-08-22 11:24:51.690259 (MainThread): 
2022-08-22 11:24:51.690539 (MainThread): Completed successfully
2022-08-22 11:24:51.690768 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-08-22 11:24:51.691069 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f69aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fef1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fef7710>]}
2022-08-22 11:24:51.691364 (MainThread): Flushing usage events
2022-08-22 11:25:41.354982 (MainThread): Running with dbt=0.21.1
2022-08-22 11:25:41.450038 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-08-22 11:25:41.451710 (MainThread): Tracking: tracking
2022-08-22 11:25:41.465607 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce51f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d37b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d35a790>]}
2022-08-22 11:25:41.481076 (MainThread): Partial parsing not enabled
2022-08-22 11:25:41.495682 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:25:41.500826 (MainThread): Parsing macros/relations.sql
2022-08-22 11:25:41.503014 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:25:41.533682 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:25:41.536026 (MainThread): Parsing macros/core.sql
2022-08-22 11:25:41.541040 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:25:41.550348 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:25:41.563544 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:25:41.565773 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:25:41.589669 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:25:41.638298 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:25:41.670076 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:25:41.672427 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:25:41.686957 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:25:41.715128 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:25:41.734517 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:25:41.745858 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:25:41.756296 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:25:41.761592 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:25:41.763547 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:25:41.764821 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:25:41.766906 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:25:41.778763 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:25:41.781170 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:25:41.784379 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:25:41.786447 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:25:41.861765 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:25:41.864025 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:25:41.865561 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:25:41.867314 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:25:42.099864 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:25:42.116912 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:25:42.168498 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:25:42.170794 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:25:42.172939 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:25:42.175113 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:25:42.195411 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9c9e853-f441-4c67-a54c-bc85a9050788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3ac7d0>]}
2022-08-22 11:25:42.200909 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:25:42.201574 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9c9e853-f441-4c67-a54c-bc85a9050788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3f3bd0>]}
2022-08-22 11:25:42.201909 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:25:42.203508 (MainThread): 
2022-08-22 11:25:42.203907 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:25:42.204846 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:25:42.217404 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:25:42.217685 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:25:42.217897 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:25:42.263437 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.05 seconds
2022-08-22 11:25:42.263805 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:25:42.264028 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:25:42.283479 (ThreadPoolExecutor-0_0): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 11:25:42.285532 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:25:42.287540 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:25:42.293005 (MainThread): Using postgres connection "master".
2022-08-22 11:25:42.293323 (MainThread): On master: BEGIN
2022-08-22 11:25:42.293539 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:25:42.314179 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:25:42.314534 (MainThread): Using postgres connection "master".
2022-08-22 11:25:42.314753 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:25:42.487196 (MainThread): SQL status: SELECT 38 in 0.17 seconds
2022-08-22 11:25:42.493964 (MainThread): On master: ROLLBACK
2022-08-22 11:25:42.495552 (MainThread): On master: Close
2022-08-22 11:25:42.496392 (MainThread): 14:25:42 | Concurrency: 4 threads (target='dev')
2022-08-22 11:25:42.496846 (MainThread): 14:25:42 | 
2022-08-22 11:25:42.499919 (Thread-1): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:25:42.500490 (Thread-1): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:25:42.500767 (Thread-1): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:25:42.503779 (Thread-1): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:25:42.504396 (Thread-1): finished collecting timing info
2022-08-22 11:25:42.504694 (Thread-1): finished collecting timing info
2022-08-22 11:25:42.505096 (Thread-1): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:25:42.505561 (Thread-3): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 11:25:42.505997 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:25:42.506253 (Thread-4): Began running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:25:42.506483 (Thread-3): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 11:25:42.506673 (Thread-2): Began running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:25:42.507074 (Thread-4): Acquiring new postgres connection "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710".
2022-08-22 11:25:42.509798 (Thread-3): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:25:42.510246 (Thread-2): Acquiring new postgres connection "test.dbt_test.unique_my_first_dbt_model_id.16e066b321".
2022-08-22 11:25:42.510484 (Thread-4): Compiling test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:25:42.510809 (Thread-2): Compiling test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:25:42.531520 (Thread-4): Writing injected SQL for node "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710"
2022-08-22 11:25:42.533312 (Thread-2): Writing injected SQL for node "test.dbt_test.unique_my_first_dbt_model_id.16e066b321"
2022-08-22 11:25:42.533580 (Thread-3): finished collecting timing info
2022-08-22 11:25:42.534080 (Thread-3): finished collecting timing info
2022-08-22 11:25:42.534595 (Thread-3): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 11:25:42.534954 (Thread-4): finished collecting timing info
2022-08-22 11:25:42.535256 (Thread-2): finished collecting timing info
2022-08-22 11:25:42.535480 (Thread-4): finished collecting timing info
2022-08-22 11:25:42.535840 (Thread-2): finished collecting timing info
2022-08-22 11:25:42.536048 (Thread-1): Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:25:42.536272 (Thread-3): Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:25:42.536633 (Thread-4): Finished running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:25:42.537012 (Thread-2): Finished running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:25:42.537361 (Thread-1): Acquiring new postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 11:25:42.537732 (Thread-3): Acquiring new postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 11:25:42.538194 (Thread-1): Compiling test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:25:42.538444 (Thread-3): Compiling test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:25:42.542566 (Thread-1): Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 11:25:42.547163 (Thread-3): Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 11:25:42.547678 (Thread-1): finished collecting timing info
2022-08-22 11:25:42.547918 (Thread-3): finished collecting timing info
2022-08-22 11:25:42.548155 (Thread-1): finished collecting timing info
2022-08-22 11:25:42.548402 (Thread-3): finished collecting timing info
2022-08-22 11:25:42.548803 (Thread-1): Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:25:42.549160 (Thread-3): Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:25:42.604861 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:25:42.605142 (MainThread): Connection 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
2022-08-22 11:25:42.605387 (MainThread): Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
2022-08-22 11:25:42.605625 (MainThread): Connection 'test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
2022-08-22 11:25:42.605862 (MainThread): Connection 'test.dbt_test.unique_my_first_dbt_model_id.16e066b321' was properly closed.
2022-08-22 11:25:42.612166 (MainThread): 14:25:42 | Done.
2022-08-22 11:25:42.612565 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc0c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc0c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc0c550>]}
2022-08-22 11:25:42.612908 (MainThread): Flushing usage events
2022-08-22 11:30:20.246780 (MainThread): Running with dbt=0.21.1
2022-08-22 11:30:20.354558 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-08-22 11:30:20.356442 (MainThread): Tracking: tracking
2022-08-22 11:30:20.370159 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d951c10>]}
2022-08-22 11:30:20.389632 (MainThread): Partial parsing not enabled
2022-08-22 11:30:20.404166 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:30:20.408444 (MainThread): Parsing macros/relations.sql
2022-08-22 11:30:20.410298 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:30:20.440677 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:30:20.442981 (MainThread): Parsing macros/core.sql
2022-08-22 11:30:20.447957 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:30:20.457235 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:30:20.470249 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:30:20.472466 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:30:20.496000 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:30:20.543963 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:30:20.575383 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:30:20.577779 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:30:20.592101 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:30:20.619959 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:30:20.639178 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:30:20.650348 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:30:20.660659 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:30:20.665799 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:30:20.667747 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:30:20.669006 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:30:20.671098 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:30:20.682768 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:30:20.685153 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:30:20.688358 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:30:20.690428 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:30:20.765366 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:30:20.767717 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:30:20.769257 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:30:20.771003 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:30:21.000274 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:30:21.016673 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:30:21.020929 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:30:21.025576 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:30:21.029912 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:30:21.034697 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:30:21.085080 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:30:21.087292 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:30:21.089448 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:30:21.092695 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:30:21.113900 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33d3d90b-dff6-4440-bc4f-b737d1f062e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e11af50>]}
2022-08-22 11:30:21.119923 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:30:21.120611 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33d3d90b-dff6-4440-bc4f-b737d1f062e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e110350>]}
2022-08-22 11:30:21.120937 (MainThread): Found 6 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:30:21.122939 (MainThread): 
2022-08-22 11:30:21.123348 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:30:21.124617 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:30:21.137193 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:30:21.137476 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:30:21.137694 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:30:21.201178 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.06 seconds
2022-08-22 11:30:21.201550 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:30:21.201769 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:30:21.223326 (ThreadPoolExecutor-0_0): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 11:30:21.225325 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:30:21.226665 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:30:21.232065 (MainThread): Using postgres connection "master".
2022-08-22 11:30:21.232349 (MainThread): On master: BEGIN
2022-08-22 11:30:21.232570 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:30:21.249749 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:30:21.250092 (MainThread): Using postgres connection "master".
2022-08-22 11:30:21.250309 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:30:21.429237 (MainThread): SQL status: SELECT 38 in 0.18 seconds
2022-08-22 11:30:21.436817 (MainThread): On master: ROLLBACK
2022-08-22 11:30:21.438225 (MainThread): On master: Close
2022-08-22 11:30:21.439018 (MainThread): 14:30:21 | Concurrency: 4 threads (target='dev')
2022-08-22 11:30:21.439468 (MainThread): 14:30:21 | 
2022-08-22 11:30:21.443791 (Thread-1): Began running node model.dbt_test.actor
2022-08-22 11:30:21.444234 (Thread-2): Began running node model.dbt_test.inventory
2022-08-22 11:30:21.444525 (Thread-3): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:30:21.445003 (Thread-1): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:30:21.445246 (Thread-4): Began running node model.dbt_test.rental
2022-08-22 11:30:21.445660 (Thread-2): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:30:21.446087 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:30:21.446551 (Thread-1): Compiling model.dbt_test.actor
2022-08-22 11:30:21.446973 (Thread-4): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:30:21.447257 (Thread-2): Compiling model.dbt_test.inventory
2022-08-22 11:30:21.447538 (Thread-3): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:30:21.450285 (Thread-1): Writing injected SQL for node "model.dbt_test.actor"
2022-08-22 11:30:21.450543 (Thread-4): Compiling model.dbt_test.rental
2022-08-22 11:30:21.453378 (Thread-2): Writing injected SQL for node "model.dbt_test.inventory"
2022-08-22 11:30:21.455781 (Thread-3): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:30:21.458251 (Thread-4): Writing injected SQL for node "model.dbt_test.rental"
2022-08-22 11:30:21.459019 (Thread-2): finished collecting timing info
2022-08-22 11:30:21.459276 (Thread-1): finished collecting timing info
2022-08-22 11:30:21.459544 (Thread-2): finished collecting timing info
2022-08-22 11:30:21.459809 (Thread-4): finished collecting timing info
2022-08-22 11:30:21.460046 (Thread-1): finished collecting timing info
2022-08-22 11:30:21.460239 (Thread-3): finished collecting timing info
2022-08-22 11:30:21.460653 (Thread-2): Finished running node model.dbt_test.inventory
2022-08-22 11:30:21.460895 (Thread-4): finished collecting timing info
2022-08-22 11:30:21.461279 (Thread-1): Finished running node model.dbt_test.actor
2022-08-22 11:30:21.461519 (Thread-3): finished collecting timing info
2022-08-22 11:30:21.462045 (Thread-4): Finished running node model.dbt_test.rental
2022-08-22 11:30:21.462548 (Thread-3): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:30:21.463108 (Thread-2): Began running node model.dbt_test.mart
2022-08-22 11:30:21.463357 (Thread-1): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 11:30:21.463940 (Thread-2): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:30:21.464140 (Thread-4): Began running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:30:21.464376 (Thread-3): Began running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:30:21.464713 (Thread-1): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:30:21.464946 (Thread-2): Compiling model.dbt_test.mart
2022-08-22 11:30:21.465348 (Thread-4): Acquiring new postgres connection "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710".
2022-08-22 11:30:21.465788 (Thread-3): Acquiring new postgres connection "test.dbt_test.unique_my_first_dbt_model_id.16e066b321".
2022-08-22 11:30:21.466069 (Thread-1): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 11:30:21.468948 (Thread-2): Writing injected SQL for node "model.dbt_test.mart"
2022-08-22 11:30:21.469200 (Thread-4): Compiling test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:30:21.469474 (Thread-3): Compiling test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:30:21.472565 (Thread-1): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:30:21.485417 (Thread-4): Writing injected SQL for node "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710"
2022-08-22 11:30:21.492275 (Thread-3): Writing injected SQL for node "test.dbt_test.unique_my_first_dbt_model_id.16e066b321"
2022-08-22 11:30:21.492706 (Thread-2): finished collecting timing info
2022-08-22 11:30:21.493138 (Thread-2): finished collecting timing info
2022-08-22 11:30:21.493394 (Thread-1): finished collecting timing info
2022-08-22 11:30:21.493650 (Thread-4): finished collecting timing info
2022-08-22 11:30:21.494038 (Thread-2): Finished running node model.dbt_test.mart
2022-08-22 11:30:21.494309 (Thread-1): finished collecting timing info
2022-08-22 11:30:21.494529 (Thread-3): finished collecting timing info
2022-08-22 11:30:21.494747 (Thread-4): finished collecting timing info
2022-08-22 11:30:21.495268 (Thread-1): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 11:30:21.495507 (Thread-3): finished collecting timing info
2022-08-22 11:30:21.495903 (Thread-4): Finished running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:30:21.496405 (Thread-3): Finished running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:30:21.496744 (Thread-4): Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:30:21.496960 (Thread-2): Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:30:21.497438 (Thread-4): Acquiring new postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 11:30:21.497789 (Thread-2): Acquiring new postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 11:30:21.498014 (Thread-4): Compiling test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:30:21.498229 (Thread-2): Compiling test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:30:21.501669 (Thread-4): Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 11:30:21.505164 (Thread-2): Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 11:30:21.505803 (Thread-4): finished collecting timing info
2022-08-22 11:30:21.506035 (Thread-2): finished collecting timing info
2022-08-22 11:30:21.506266 (Thread-4): finished collecting timing info
2022-08-22 11:30:21.506507 (Thread-2): finished collecting timing info
2022-08-22 11:30:21.506902 (Thread-4): Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:30:21.507297 (Thread-2): Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:30:21.548149 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:30:21.548365 (MainThread): Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
2022-08-22 11:30:21.548557 (MainThread): Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
2022-08-22 11:30:21.548746 (MainThread): Connection 'test.dbt_test.unique_my_first_dbt_model_id.16e066b321' was properly closed.
2022-08-22 11:30:21.548928 (MainThread): Connection 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
2022-08-22 11:30:21.554266 (MainThread): 14:30:21 | Done.
2022-08-22 11:30:21.554576 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d451810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9cec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0d8dd0>]}
2022-08-22 11:30:21.554883 (MainThread): Flushing usage events
2022-08-22 11:31:00.800282 (MainThread): Running with dbt=0.21.1
2022-08-22 11:31:00.892429 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['staging'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 11:31:00.893948 (MainThread): Tracking: tracking
2022-08-22 11:31:00.906304 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca72f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf9dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf7f610>]}
2022-08-22 11:31:00.920922 (MainThread): Partial parsing not enabled
2022-08-22 11:31:00.932800 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:31:00.936876 (MainThread): Parsing macros/relations.sql
2022-08-22 11:31:00.938723 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:31:00.968714 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:31:00.971009 (MainThread): Parsing macros/core.sql
2022-08-22 11:31:00.975939 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:31:00.985076 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:31:00.998106 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:31:01.000286 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:31:01.024165 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:31:01.071798 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:31:01.103207 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:31:01.105518 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:31:01.119801 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:31:01.147512 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:31:01.166714 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:31:01.177807 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:31:01.188147 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:31:01.193241 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:31:01.195198 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:31:01.196456 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:31:01.198510 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:31:01.210056 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:31:01.226171 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:31:01.229350 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:31:01.231398 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:31:01.305695 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:31:01.307974 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:31:01.309512 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:31:01.311249 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:31:01.538080 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:31:01.554662 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:31:01.558927 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:31:01.563651 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:31:01.568022 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:31:01.572847 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:31:01.623680 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:31:01.625827 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:31:01.627968 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:31:01.631172 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:31:01.651079 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61ffc3e1-670e-40f4-bc32-527fff393ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d768b10>]}
2022-08-22 11:31:01.656867 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:31:01.657511 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61ffc3e1-670e-40f4-bc32-527fff393ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d75d710>]}
2022-08-22 11:31:01.657836 (MainThread): Found 6 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:31:01.659421 (MainThread): 
2022-08-22 11:31:01.659822 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:31:01.661057 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 11:31:01.672807 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 11:31:01.673033 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 11:31:01.673240 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:31:01.729108 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.06 seconds
2022-08-22 11:31:01.731030 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 11:31:01.732569 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:31:01.739631 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:31:01.739891 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:31:01.740100 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 11:31:01.756154 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:31:01.756479 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:31:01.756696 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:31:01.771015 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.01 seconds
2022-08-22 11:31:01.772514 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:31:01.773644 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:31:01.778915 (MainThread): Using postgres connection "master".
2022-08-22 11:31:01.779202 (MainThread): On master: BEGIN
2022-08-22 11:31:01.779418 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:31:01.795290 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:31:01.795635 (MainThread): Using postgres connection "master".
2022-08-22 11:31:01.795878 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:31:01.964858 (MainThread): SQL status: SELECT 38 in 0.17 seconds
2022-08-22 11:31:01.971931 (MainThread): On master: ROLLBACK
2022-08-22 11:31:01.973505 (MainThread): Using postgres connection "master".
2022-08-22 11:31:01.973985 (MainThread): On master: BEGIN
2022-08-22 11:31:01.976346 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 11:31:01.976783 (MainThread): On master: COMMIT
2022-08-22 11:31:01.977173 (MainThread): Using postgres connection "master".
2022-08-22 11:31:01.977542 (MainThread): On master: COMMIT
2022-08-22 11:31:01.978925 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:31:01.979337 (MainThread): On master: Close
2022-08-22 11:31:01.980119 (MainThread): 14:31:01 | Concurrency: 4 threads (target='dev')
2022-08-22 11:31:01.980550 (MainThread): 14:31:01 | 
2022-08-22 11:31:01.983499 (Thread-1): Began running node model.dbt_test.actor
2022-08-22 11:31:01.983840 (Thread-2): Began running node model.dbt_test.inventory
2022-08-22 11:31:01.984092 (Thread-3): Began running node model.dbt_test.rental
2022-08-22 11:31:01.984447 (Thread-1): 14:31:01 | 1 of 4 START table model dvd_schema.actor............................ [RUN]
2022-08-22 11:31:01.984814 (Thread-2): 14:31:01 | 2 of 4 START table model dvd_schema.inventory........................ [RUN]
2022-08-22 11:31:01.985104 (Thread-3): 14:31:01 | 3 of 4 START table model dvd_schema.rental........................... [RUN]
2022-08-22 11:31:01.985648 (Thread-1): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:31:01.986049 (Thread-2): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:31:01.986374 (Thread-1): Compiling model.dbt_test.actor
2022-08-22 11:31:01.986705 (Thread-3): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:31:01.986932 (Thread-2): Compiling model.dbt_test.inventory
2022-08-22 11:31:01.990263 (Thread-1): Writing injected SQL for node "model.dbt_test.actor"
2022-08-22 11:31:01.990519 (Thread-3): Compiling model.dbt_test.rental
2022-08-22 11:31:01.992876 (Thread-2): Writing injected SQL for node "model.dbt_test.inventory"
2022-08-22 11:31:01.995705 (Thread-3): Writing injected SQL for node "model.dbt_test.rental"
2022-08-22 11:31:01.996408 (Thread-1): finished collecting timing info
2022-08-22 11:31:02.002328 (Thread-2): finished collecting timing info
2022-08-22 11:31:02.002574 (Thread-3): finished collecting timing info
2022-08-22 11:31:02.048159 (Thread-3): Writing runtime SQL for node "model.dbt_test.rental"
2022-08-22 11:31:02.056430 (Thread-1): Writing runtime SQL for node "model.dbt_test.actor"
2022-08-22 11:31:02.054539 (Thread-2): Writing runtime SQL for node "model.dbt_test.inventory"
2022-08-22 11:31:02.057349 (Thread-1): Using postgres connection "model.dbt_test.actor".
2022-08-22 11:31:02.057626 (Thread-3): Using postgres connection "model.dbt_test.rental".
2022-08-22 11:31:02.057843 (Thread-2): Using postgres connection "model.dbt_test.inventory".
2022-08-22 11:31:02.058031 (Thread-1): On model.dbt_test.actor: BEGIN
2022-08-22 11:31:02.058239 (Thread-3): On model.dbt_test.rental: BEGIN
2022-08-22 11:31:02.058436 (Thread-2): On model.dbt_test.inventory: BEGIN
2022-08-22 11:31:02.058638 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:31:02.058836 (Thread-3): Opening a new connection, currently in state init
2022-08-22 11:31:02.059021 (Thread-2): Opening a new connection, currently in state init
2022-08-22 11:31:02.079156 (Thread-2): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:31:02.079523 (Thread-2): Using postgres connection "model.dbt_test.inventory".
2022-08-22 11:31:02.079740 (Thread-2): On model.dbt_test.inventory: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.inventory"} */


  create  table "dvdrental"."dvd_schema"."inventory__dbt_tmp"
  as (
    select * from "dvdrental"."public"."inventory"
  );
2022-08-22 11:31:02.081447 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:31:02.081682 (Thread-1): Using postgres connection "model.dbt_test.actor".
2022-08-22 11:31:02.081881 (Thread-1): On model.dbt_test.actor: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.actor"} */


  create  table "dvdrental"."dvd_schema"."actor__dbt_tmp"
  as (
    select * from "dvdrental"."public"."actor"
  );
2022-08-22 11:31:02.082214 (Thread-3): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:31:02.082487 (Thread-3): Using postgres connection "model.dbt_test.rental".
2022-08-22 11:31:02.082696 (Thread-3): On model.dbt_test.rental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.rental"} */


  create  table "dvdrental"."dvd_schema"."rental__dbt_tmp"
  as (
    select * from "dvdrental"."public"."rental"
  );
2022-08-22 11:31:02.119913 (Thread-1): SQL status: SELECT 200 in 0.04 seconds
2022-08-22 11:31:02.127251 (Thread-1): Using postgres connection "model.dbt_test.actor".
2022-08-22 11:31:02.127530 (Thread-1): On model.dbt_test.actor: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.actor"} */
alter table "dvdrental"."dvd_schema"."actor__dbt_tmp" rename to "actor"
2022-08-22 11:31:02.135613 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2022-08-22 11:31:02.150509 (Thread-1): On model.dbt_test.actor: COMMIT
2022-08-22 11:31:02.150841 (Thread-1): Using postgres connection "model.dbt_test.actor".
2022-08-22 11:31:02.151080 (Thread-1): On model.dbt_test.actor: COMMIT
2022-08-22 11:31:02.163153 (Thread-1): SQL status: COMMIT in 0.01 seconds
2022-08-22 11:31:02.169478 (Thread-1): Using postgres connection "model.dbt_test.actor".
2022-08-22 11:31:02.169799 (Thread-1): On model.dbt_test.actor: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.actor"} */
drop table if exists "dvdrental"."dvd_schema"."actor__dbt_backup" cascade
2022-08-22 11:31:02.171687 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2022-08-22 11:31:02.173223 (Thread-1): finished collecting timing info
2022-08-22 11:31:02.173560 (Thread-1): On model.dbt_test.actor: Close
2022-08-22 11:31:02.174111 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ffc3e1-670e-40f4-bc32-527fff393ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d737c50>]}
2022-08-22 11:31:02.174584 (Thread-1): 14:31:02 | 1 of 4 OK created table model dvd_schema.actor....................... [SELECT 200 in 0.19s]
2022-08-22 11:31:02.174885 (Thread-1): Finished running node model.dbt_test.actor
2022-08-22 11:31:02.200173 (Thread-2): SQL status: SELECT 4581 in 0.12 seconds
2022-08-22 11:31:02.202781 (Thread-2): Using postgres connection "model.dbt_test.inventory".
2022-08-22 11:31:02.203023 (Thread-2): On model.dbt_test.inventory: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.inventory"} */
alter table "dvdrental"."dvd_schema"."inventory__dbt_tmp" rename to "inventory"
2022-08-22 11:31:02.204600 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:31:02.206045 (Thread-2): On model.dbt_test.inventory: COMMIT
2022-08-22 11:31:02.206285 (Thread-2): Using postgres connection "model.dbt_test.inventory".
2022-08-22 11:31:02.206488 (Thread-2): On model.dbt_test.inventory: COMMIT
2022-08-22 11:31:02.220500 (Thread-2): SQL status: COMMIT in 0.01 seconds
2022-08-22 11:31:02.222670 (Thread-2): Using postgres connection "model.dbt_test.inventory".
2022-08-22 11:31:02.222934 (Thread-2): On model.dbt_test.inventory: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.inventory"} */
drop table if exists "dvdrental"."dvd_schema"."inventory__dbt_backup" cascade
2022-08-22 11:31:02.224554 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-08-22 11:31:02.225909 (Thread-2): finished collecting timing info
2022-08-22 11:31:02.226195 (Thread-2): On model.dbt_test.inventory: Close
2022-08-22 11:31:02.226658 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ffc3e1-670e-40f4-bc32-527fff393ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d752810>]}
2022-08-22 11:31:02.227060 (Thread-2): 14:31:02 | 2 of 4 OK created table model dvd_schema.inventory................... [SELECT 4581 in 0.24s]
2022-08-22 11:31:02.227302 (Thread-2): Finished running node model.dbt_test.inventory
2022-08-22 11:31:02.543485 (Thread-3): SQL status: SELECT 16044 in 0.46 seconds
2022-08-22 11:31:02.549333 (Thread-3): Using postgres connection "model.dbt_test.rental".
2022-08-22 11:31:02.549802 (Thread-3): On model.dbt_test.rental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.rental"} */
alter table "dvdrental"."dvd_schema"."rental__dbt_tmp" rename to "rental"
2022-08-22 11:31:02.551746 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:31:02.554290 (Thread-3): On model.dbt_test.rental: COMMIT
2022-08-22 11:31:02.554687 (Thread-3): Using postgres connection "model.dbt_test.rental".
2022-08-22 11:31:02.555057 (Thread-3): On model.dbt_test.rental: COMMIT
2022-08-22 11:31:02.559972 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:31:02.562115 (Thread-3): Using postgres connection "model.dbt_test.rental".
2022-08-22 11:31:02.562360 (Thread-3): On model.dbt_test.rental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.rental"} */
drop table if exists "dvdrental"."dvd_schema"."rental__dbt_backup" cascade
2022-08-22 11:31:02.563783 (Thread-3): SQL status: DROP TABLE in 0.00 seconds
2022-08-22 11:31:02.565152 (Thread-3): finished collecting timing info
2022-08-22 11:31:02.565424 (Thread-3): On model.dbt_test.rental: Close
2022-08-22 11:31:02.565881 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ffc3e1-670e-40f4-bc32-527fff393ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d800190>]}
2022-08-22 11:31:02.566292 (Thread-3): 14:31:02 | 3 of 4 OK created table model dvd_schema.rental...................... [SELECT 16044 in 0.58s]
2022-08-22 11:31:02.566539 (Thread-3): Finished running node model.dbt_test.rental
2022-08-22 11:31:02.567027 (Thread-4): Began running node model.dbt_test.mart
2022-08-22 11:31:02.567357 (Thread-4): 14:31:02 | 4 of 4 START table model dvd_schema.mart............................. [RUN]
2022-08-22 11:31:02.567736 (Thread-4): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:31:02.567953 (Thread-4): Compiling model.dbt_test.mart
2022-08-22 11:31:02.570965 (Thread-4): Writing injected SQL for node "model.dbt_test.mart"
2022-08-22 11:31:02.571502 (Thread-4): finished collecting timing info
2022-08-22 11:31:02.575008 (Thread-4): Writing runtime SQL for node "model.dbt_test.mart"
2022-08-22 11:31:02.575461 (Thread-4): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:31:02.575665 (Thread-4): On model.dbt_test.mart: BEGIN
2022-08-22 11:31:02.575862 (Thread-4): Opening a new connection, currently in state init
2022-08-22 11:31:02.593534 (Thread-4): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:31:02.593885 (Thread-4): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:31:02.594101 (Thread-4): On model.dbt_test.mart: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.mart"} */


  create  table "dvdrental"."dvd_schema"."mart__dbt_tmp"
  as (
    select r.customer_id,
count(i.inventory_id) as cnt
from "dvdrental"."dvd_schema"."rental" r
left join "dvdrental"."dvd_schema"."inventory" i
on r.inventory_id = i.inventory_id
group by r.customer_id
order by cnt desc
limit 10
  );
2022-08-22 11:31:02.631784 (Thread-4): SQL status: SELECT 10 in 0.04 seconds
2022-08-22 11:31:02.637751 (Thread-4): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:31:02.638241 (Thread-4): On model.dbt_test.mart: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.mart"} */
alter table "dvdrental"."dvd_schema"."mart__dbt_tmp" rename to "mart"
2022-08-22 11:31:02.639841 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:31:02.641309 (Thread-4): On model.dbt_test.mart: COMMIT
2022-08-22 11:31:02.641547 (Thread-4): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:31:02.641754 (Thread-4): On model.dbt_test.mart: COMMIT
2022-08-22 11:31:02.645634 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:31:02.647591 (Thread-4): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:31:02.647828 (Thread-4): On model.dbt_test.mart: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.mart"} */
drop table if exists "dvdrental"."dvd_schema"."mart__dbt_backup" cascade
2022-08-22 11:31:02.649179 (Thread-4): SQL status: DROP TABLE in 0.00 seconds
2022-08-22 11:31:02.650458 (Thread-4): finished collecting timing info
2022-08-22 11:31:02.650731 (Thread-4): On model.dbt_test.mart: Close
2022-08-22 11:31:02.651192 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ffc3e1-670e-40f4-bc32-527fff393ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d869350>]}
2022-08-22 11:31:02.651604 (Thread-4): 14:31:02 | 4 of 4 OK created table model dvd_schema.mart........................ [SELECT 10 in 0.08s]
2022-08-22 11:31:02.651850 (Thread-4): Finished running node model.dbt_test.mart
2022-08-22 11:31:02.691875 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:31:02.692758 (MainThread): Using postgres connection "master".
2022-08-22 11:31:02.693223 (MainThread): On master: BEGIN
2022-08-22 11:31:02.693692 (MainThread): Opening a new connection, currently in state closed
2022-08-22 11:31:02.710372 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:31:02.710997 (MainThread): On master: COMMIT
2022-08-22 11:31:02.711379 (MainThread): Using postgres connection "master".
2022-08-22 11:31:02.711753 (MainThread): On master: COMMIT
2022-08-22 11:31:02.713307 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:31:02.713716 (MainThread): On master: Close
2022-08-22 11:31:02.714580 (MainThread): 14:31:02 | 
2022-08-22 11:31:02.715026 (MainThread): 14:31:02 | Finished running 4 table models in 1.05s.
2022-08-22 11:31:02.715438 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:31:02.715794 (MainThread): Connection 'model.dbt_test.actor' was properly closed.
2022-08-22 11:31:02.716148 (MainThread): Connection 'model.dbt_test.inventory' was properly closed.
2022-08-22 11:31:02.716556 (MainThread): Connection 'model.dbt_test.rental' was properly closed.
2022-08-22 11:31:02.716771 (MainThread): Connection 'model.dbt_test.mart' was properly closed.
2022-08-22 11:31:02.722207 (MainThread): 
2022-08-22 11:31:02.722485 (MainThread): Completed successfully
2022-08-22 11:31:02.722726 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2022-08-22 11:31:02.723019 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d87d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d75d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca7e890>]}
2022-08-22 11:31:02.723318 (MainThread): Flushing usage events
2022-08-22 11:35:46.270845 (MainThread): Running with dbt=0.21.1
2022-08-22 11:35:46.376896 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-08-22 11:35:46.381291 (MainThread): Tracking: tracking
2022-08-22 11:35:46.395014 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4d2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4bd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4dcb50>]}
2022-08-22 11:35:46.410563 (MainThread): Partial parsing not enabled
2022-08-22 11:35:46.425353 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:35:46.429819 (MainThread): Parsing macros/relations.sql
2022-08-22 11:35:46.431692 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:35:46.462184 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:35:46.464449 (MainThread): Parsing macros/core.sql
2022-08-22 11:35:46.469384 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:35:46.478661 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:35:46.491677 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:35:46.493892 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:35:46.517278 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:35:46.564786 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:35:46.595998 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:35:46.598312 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:35:46.612557 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:35:46.640273 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:35:46.659386 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:35:46.670843 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:35:46.681184 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:35:46.686309 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:35:46.688258 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:35:46.689512 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:35:46.691561 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:35:46.703187 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:35:46.705542 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:35:46.708697 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:35:46.710738 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:35:46.785114 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:35:46.787296 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:35:46.788802 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:35:46.790533 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:35:47.021531 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:35:47.038174 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:35:47.042406 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:35:47.047058 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:35:47.051362 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:35:47.056147 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:35:47.072053 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:35:47.128171 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:35:47.130294 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:35:47.132509 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:35:47.134516 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:35:47.154684 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36c3a13d-36bc-4551-82e5-fadd3ebd36a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa7ff50>]}
2022-08-22 11:35:47.160710 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:35:47.161344 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36c3a13d-36bc-4551-82e5-fadd3ebd36a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110177610>]}
2022-08-22 11:35:47.161668 (MainThread): Found 6 models, 4 tests, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:35:47.163744 (MainThread): 
2022-08-22 11:35:47.164147 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:35:47.165441 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:35:47.171733 (ThreadPoolExecutor-0_1): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:35:47.184349 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:35:47.185543 (ThreadPoolExecutor-0_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:35:47.185786 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:35:47.185995 (ThreadPoolExecutor-0_1): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:35:47.186193 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:35:47.186386 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state init
2022-08-22 11:35:47.252779 (ThreadPoolExecutor-0_1): SQL status: BEGIN in 0.07 seconds
2022-08-22 11:35:47.253134 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.07 seconds
2022-08-22 11:35:47.253363 (ThreadPoolExecutor-0_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:35:47.253602 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:35:47.253847 (ThreadPoolExecutor-0_1): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:35:47.254086 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:35:47.271191 (ThreadPoolExecutor-0_1): SQL status: SELECT 0 in 0.02 seconds
2022-08-22 11:35:47.273110 (ThreadPoolExecutor-0_1): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:35:47.273378 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.02 seconds
2022-08-22 11:35:47.274918 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:35:47.275145 (ThreadPoolExecutor-0_1): On list_dvdrental_snapshots: Close
2022-08-22 11:35:47.276693 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:35:47.282364 (MainThread): Using postgres connection "master".
2022-08-22 11:35:47.282645 (MainThread): On master: BEGIN
2022-08-22 11:35:47.282863 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:35:47.298400 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:35:47.298726 (MainThread): Using postgres connection "master".
2022-08-22 11:35:47.298939 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:35:47.507013 (MainThread): SQL status: SELECT 38 in 0.21 seconds
2022-08-22 11:35:47.513399 (MainThread): On master: ROLLBACK
2022-08-22 11:35:47.514949 (MainThread): On master: Close
2022-08-22 11:35:47.515790 (MainThread): 14:35:47 | Concurrency: 4 threads (target='dev')
2022-08-22 11:35:47.516232 (MainThread): 14:35:47 | 
2022-08-22 11:35:47.520130 (Thread-1): Began running node model.dbt_test.actor
2022-08-22 11:35:47.520471 (Thread-2): Began running node model.dbt_test.inventory
2022-08-22 11:35:47.520721 (Thread-3): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:35:47.521182 (Thread-1): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:35:47.521411 (Thread-4): Began running node model.dbt_test.rental
2022-08-22 11:35:47.521857 (Thread-2): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:35:47.522348 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:35:47.522700 (Thread-1): Compiling model.dbt_test.actor
2022-08-22 11:35:47.523345 (Thread-4): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:35:47.523611 (Thread-2): Compiling model.dbt_test.inventory
2022-08-22 11:35:47.523863 (Thread-3): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:35:47.526821 (Thread-1): Writing injected SQL for node "model.dbt_test.actor"
2022-08-22 11:35:47.527078 (Thread-4): Compiling model.dbt_test.rental
2022-08-22 11:35:47.529449 (Thread-2): Writing injected SQL for node "model.dbt_test.inventory"
2022-08-22 11:35:47.532279 (Thread-3): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:35:47.534878 (Thread-4): Writing injected SQL for node "model.dbt_test.rental"
2022-08-22 11:35:47.535553 (Thread-2): finished collecting timing info
2022-08-22 11:35:47.535871 (Thread-2): finished collecting timing info
2022-08-22 11:35:47.536314 (Thread-2): Finished running node model.dbt_test.inventory
2022-08-22 11:35:47.536568 (Thread-2): Began running node snapshot.dbt_test.actor_snapshot
2022-08-22 11:35:47.536801 (Thread-1): finished collecting timing info
2022-08-22 11:35:47.537102 (Thread-3): finished collecting timing info
2022-08-22 11:35:47.537482 (Thread-2): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:35:47.537733 (Thread-1): finished collecting timing info
2022-08-22 11:35:47.537963 (Thread-4): finished collecting timing info
2022-08-22 11:35:47.538180 (Thread-3): finished collecting timing info
2022-08-22 11:35:47.538430 (Thread-2): Compiling snapshot.dbt_test.actor_snapshot
2022-08-22 11:35:47.538823 (Thread-1): Finished running node model.dbt_test.actor
2022-08-22 11:35:47.539069 (Thread-4): finished collecting timing info
2022-08-22 11:35:47.539446 (Thread-3): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:35:47.543168 (Thread-2): finished collecting timing info
2022-08-22 11:35:47.543711 (Thread-4): Finished running node model.dbt_test.rental
2022-08-22 11:35:47.544098 (Thread-2): finished collecting timing info
2022-08-22 11:35:47.544471 (Thread-1): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 11:35:47.544704 (Thread-4): Began running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:35:47.544919 (Thread-3): Began running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:35:47.545347 (Thread-2): Finished running node snapshot.dbt_test.actor_snapshot
2022-08-22 11:35:47.545753 (Thread-1): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:35:47.546102 (Thread-4): Acquiring new postgres connection "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710".
2022-08-22 11:35:47.546527 (Thread-3): Acquiring new postgres connection "test.dbt_test.unique_my_first_dbt_model_id.16e066b321".
2022-08-22 11:35:47.546835 (Thread-2): Began running node model.dbt_test.mart
2022-08-22 11:35:47.547195 (Thread-1): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 11:35:47.547473 (Thread-4): Compiling test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:35:47.547736 (Thread-3): Compiling test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:35:47.548170 (Thread-2): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:35:47.550816 (Thread-1): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:35:47.569060 (Thread-4): Writing injected SQL for node "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710"
2022-08-22 11:35:47.573271 (Thread-3): Writing injected SQL for node "test.dbt_test.unique_my_first_dbt_model_id.16e066b321"
2022-08-22 11:35:47.573489 (Thread-2): Compiling model.dbt_test.mart
2022-08-22 11:35:47.576458 (Thread-2): Writing injected SQL for node "model.dbt_test.mart"
2022-08-22 11:35:47.576946 (Thread-4): finished collecting timing info
2022-08-22 11:35:47.577239 (Thread-4): finished collecting timing info
2022-08-22 11:35:47.577471 (Thread-2): finished collecting timing info
2022-08-22 11:35:47.577878 (Thread-4): Finished running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:35:47.578082 (Thread-1): finished collecting timing info
2022-08-22 11:35:47.578304 (Thread-3): finished collecting timing info
2022-08-22 11:35:47.578525 (Thread-2): finished collecting timing info
2022-08-22 11:35:47.578849 (Thread-1): finished collecting timing info
2022-08-22 11:35:47.579073 (Thread-3): finished collecting timing info
2022-08-22 11:35:47.579435 (Thread-2): Finished running node model.dbt_test.mart
2022-08-22 11:35:47.579780 (Thread-1): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 11:35:47.580115 (Thread-3): Finished running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:35:47.580666 (Thread-4): Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:35:47.580890 (Thread-2): Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:35:47.581220 (Thread-4): Acquiring new postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 11:35:47.581561 (Thread-2): Acquiring new postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 11:35:47.581775 (Thread-4): Compiling test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:35:47.581985 (Thread-2): Compiling test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:35:47.585435 (Thread-4): Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 11:35:47.589982 (Thread-2): Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 11:35:47.590485 (Thread-4): finished collecting timing info
2022-08-22 11:35:47.590755 (Thread-4): finished collecting timing info
2022-08-22 11:35:47.591144 (Thread-4): Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:35:47.591357 (Thread-2): finished collecting timing info
2022-08-22 11:35:47.591668 (Thread-2): finished collecting timing info
2022-08-22 11:35:47.592024 (Thread-2): Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:35:47.624801 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:35:47.625005 (MainThread): Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
2022-08-22 11:35:47.625185 (MainThread): Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
2022-08-22 11:35:47.625361 (MainThread): Connection 'test.dbt_test.unique_my_first_dbt_model_id.16e066b321' was properly closed.
2022-08-22 11:35:47.625536 (MainThread): Connection 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
2022-08-22 11:35:47.631018 (MainThread): 14:35:47 | Done.
2022-08-22 11:35:47.631322 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110339950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f2790>]}
2022-08-22 11:35:47.631623 (MainThread): Flushing usage events
2022-08-22 11:36:05.918267 (MainThread): Running with dbt=0.21.1
2022-08-22 11:36:06.010367 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 11:36:06.011990 (MainThread): Tracking: tracking
2022-08-22 11:36:06.025179 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cafcb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cff7210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cff7c50>]}
2022-08-22 11:36:06.039788 (MainThread): Partial parsing not enabled
2022-08-22 11:36:06.051993 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:36:06.056243 (MainThread): Parsing macros/relations.sql
2022-08-22 11:36:06.058177 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:36:06.089772 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:36:06.092126 (MainThread): Parsing macros/core.sql
2022-08-22 11:36:06.097131 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:36:06.106599 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:36:06.120018 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:36:06.122262 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:36:06.146056 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:36:06.197041 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:36:06.229547 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:36:06.231885 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:36:06.246554 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:36:06.275799 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:36:06.295808 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:36:06.307393 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:36:06.318126 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:36:06.323322 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:36:06.325269 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:36:06.326522 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:36:06.328586 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:36:06.340538 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:36:06.342929 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:36:06.346122 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:36:06.348188 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:36:06.427109 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:36:06.429325 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:36:06.430841 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:36:06.432606 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:36:06.662913 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:36:06.679594 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:36:06.683826 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:36:06.688490 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:36:06.692922 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:36:06.697776 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:36:06.713507 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:36:06.769994 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:36:06.772124 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:36:06.774361 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:36:06.776384 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:36:06.796686 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9818af8e-ec40-4d54-a1fb-64d745491a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d798590>]}
2022-08-22 11:36:06.802709 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:36:06.803335 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9818af8e-ec40-4d54-a1fb-64d745491a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7b02d0>]}
2022-08-22 11:36:06.803666 (MainThread): Found 6 models, 4 tests, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:36:06.805582 (MainThread): 
2022-08-22 11:36:06.805985 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:36:06.807339 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 11:36:06.819653 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 11:36:06.819899 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 11:36:06.820119 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:36:06.876654 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.06 seconds
2022-08-22 11:36:06.878711 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 11:36:06.880265 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:36:06.887582 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:36:06.888065 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:36:06.889696 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:36:06.889943 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:36:06.890153 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:36:06.890357 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 11:36:06.890556 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 11:36:06.909840 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:36:06.910196 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:36:06.910423 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:36:06.911397 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:36:06.911663 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:36:06.911879 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:36:06.926816 (ThreadPoolExecutor-1_1): SQL status: SELECT 0 in 0.02 seconds
2022-08-22 11:36:06.928262 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:36:06.928522 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.02 seconds
2022-08-22 11:36:06.930011 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:36:06.930241 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: Close
2022-08-22 11:36:06.931430 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:36:06.937053 (MainThread): Using postgres connection "master".
2022-08-22 11:36:06.937362 (MainThread): On master: BEGIN
2022-08-22 11:36:06.937573 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:36:06.952696 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:36:06.953032 (MainThread): Using postgres connection "master".
2022-08-22 11:36:06.953248 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:36:07.158776 (MainThread): SQL status: SELECT 38 in 0.21 seconds
2022-08-22 11:36:07.166466 (MainThread): On master: ROLLBACK
2022-08-22 11:36:07.168026 (MainThread): Using postgres connection "master".
2022-08-22 11:36:07.168429 (MainThread): On master: BEGIN
2022-08-22 11:36:07.170710 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 11:36:07.171138 (MainThread): On master: COMMIT
2022-08-22 11:36:07.171550 (MainThread): Using postgres connection "master".
2022-08-22 11:36:07.171933 (MainThread): On master: COMMIT
2022-08-22 11:36:07.173240 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:36:07.173663 (MainThread): On master: Close
2022-08-22 11:36:07.174434 (MainThread): 14:36:07 | Concurrency: 4 threads (target='dev')
2022-08-22 11:36:07.174874 (MainThread): 14:36:07 | 
2022-08-22 11:36:07.177913 (Thread-1): Began running node model.dbt_test.actor
2022-08-22 11:36:07.178281 (Thread-2): Began running node model.dbt_test.inventory
2022-08-22 11:36:07.178681 (Thread-1): 14:36:07 | 1 of 6 START table model dvd_schema.actor............................ [RUN]
2022-08-22 11:36:07.178925 (Thread-3): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:36:07.179221 (Thread-4): Began running node model.dbt_test.rental
2022-08-22 11:36:07.179525 (Thread-2): 14:36:07 | 2 of 6 START table model dvd_schema.inventory........................ [RUN]
2022-08-22 11:36:07.180038 (Thread-1): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:36:07.180379 (Thread-3): 14:36:07 | 3 of 6 START table model dvd_schema.my_first_dbt_model............... [RUN]
2022-08-22 11:36:07.180683 (Thread-4): 14:36:07 | 4 of 6 START table model dvd_schema.rental........................... [RUN]
2022-08-22 11:36:07.181167 (Thread-2): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:36:07.181436 (Thread-1): Compiling model.dbt_test.actor
2022-08-22 11:36:07.181826 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:36:07.182309 (Thread-4): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:36:07.182560 (Thread-2): Compiling model.dbt_test.inventory
2022-08-22 11:36:07.185631 (Thread-1): Writing injected SQL for node "model.dbt_test.actor"
2022-08-22 11:36:07.185892 (Thread-3): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:36:07.186116 (Thread-4): Compiling model.dbt_test.rental
2022-08-22 11:36:07.188556 (Thread-2): Writing injected SQL for node "model.dbt_test.inventory"
2022-08-22 11:36:07.191208 (Thread-3): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:36:07.193673 (Thread-4): Writing injected SQL for node "model.dbt_test.rental"
2022-08-22 11:36:07.194047 (Thread-1): finished collecting timing info
2022-08-22 11:36:07.194467 (Thread-2): finished collecting timing info
2022-08-22 11:36:07.223957 (Thread-4): finished collecting timing info
2022-08-22 11:36:07.224240 (Thread-3): finished collecting timing info
2022-08-22 11:36:07.235805 (Thread-1): Writing runtime SQL for node "model.dbt_test.actor"
2022-08-22 11:36:07.239271 (Thread-2): Writing runtime SQL for node "model.dbt_test.inventory"
2022-08-22 11:36:07.241610 (Thread-4): Writing runtime SQL for node "model.dbt_test.rental"
2022-08-22 11:36:07.243930 (Thread-3): Writing runtime SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:36:07.244661 (Thread-1): Using postgres connection "model.dbt_test.actor".
2022-08-22 11:36:07.244892 (Thread-1): On model.dbt_test.actor: BEGIN
2022-08-22 11:36:07.245108 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:36:07.245539 (Thread-4): Using postgres connection "model.dbt_test.rental".
2022-08-22 11:36:07.245800 (Thread-2): Using postgres connection "model.dbt_test.inventory".
2022-08-22 11:36:07.246010 (Thread-4): On model.dbt_test.rental: BEGIN
2022-08-22 11:36:07.246343 (Thread-2): On model.dbt_test.inventory: BEGIN
2022-08-22 11:36:07.246601 (Thread-4): Opening a new connection, currently in state init
2022-08-22 11:36:07.246823 (Thread-2): Opening a new connection, currently in state closed
2022-08-22 11:36:07.247041 (Thread-3): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:36:07.247632 (Thread-3): On model.dbt_test.my_first_dbt_model: BEGIN
2022-08-22 11:36:07.247854 (Thread-3): Opening a new connection, currently in state init
2022-08-22 11:36:07.265594 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:36:07.265944 (Thread-1): Using postgres connection "model.dbt_test.actor".
2022-08-22 11:36:07.266170 (Thread-1): On model.dbt_test.actor: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.actor"} */


  create  table "dvdrental"."dvd_schema"."actor__dbt_tmp"
  as (
    select * from "dvdrental"."public"."actor"
  );
2022-08-22 11:36:07.269261 (Thread-3): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:36:07.269820 (Thread-3): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:36:07.270057 (Thread-3): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */


  create  table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-08-22 11:36:07.272686 (Thread-2): SQL status: BEGIN in 0.03 seconds
2022-08-22 11:36:07.272955 (Thread-2): Using postgres connection "model.dbt_test.inventory".
2022-08-22 11:36:07.273155 (Thread-2): On model.dbt_test.inventory: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.inventory"} */


  create  table "dvdrental"."dvd_schema"."inventory__dbt_tmp"
  as (
    select * from "dvdrental"."public"."inventory"
  );
2022-08-22 11:36:07.274681 (Thread-4): SQL status: BEGIN in 0.03 seconds
2022-08-22 11:36:07.274967 (Thread-4): Using postgres connection "model.dbt_test.rental".
2022-08-22 11:36:07.275190 (Thread-4): On model.dbt_test.rental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.rental"} */


  create  table "dvdrental"."dvd_schema"."rental__dbt_tmp"
  as (
    select * from "dvdrental"."public"."rental"
  );
2022-08-22 11:36:07.297271 (Thread-3): SQL status: SELECT 2 in 0.03 seconds
2022-08-22 11:36:07.306022 (Thread-3): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:36:07.306350 (Thread-1): SQL status: SELECT 200 in 0.04 seconds
2022-08-22 11:36:07.306647 (Thread-3): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-08-22 11:36:07.309390 (Thread-1): Using postgres connection "model.dbt_test.actor".
2022-08-22 11:36:07.309806 (Thread-1): On model.dbt_test.actor: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.actor"} */
alter table "dvdrental"."dvd_schema"."actor" rename to "actor__dbt_backup"
2022-08-22 11:36:07.388892 (Thread-2): SQL status: SELECT 4581 in 0.12 seconds
2022-08-22 11:36:07.391701 (Thread-2): Using postgres connection "model.dbt_test.inventory".
2022-08-22 11:36:07.391949 (Thread-2): On model.dbt_test.inventory: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.inventory"} */
alter table "dvdrental"."dvd_schema"."inventory" rename to "inventory__dbt_backup"
2022-08-22 11:36:07.393492 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:36:07.396016 (Thread-2): Using postgres connection "model.dbt_test.inventory".
2022-08-22 11:36:07.396266 (Thread-2): On model.dbt_test.inventory: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.inventory"} */
alter table "dvdrental"."dvd_schema"."inventory__dbt_tmp" rename to "inventory"
2022-08-22 11:36:07.397802 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:36:07.411491 (Thread-2): On model.dbt_test.inventory: COMMIT
2022-08-22 11:36:07.411813 (Thread-2): Using postgres connection "model.dbt_test.inventory".
2022-08-22 11:36:07.412036 (Thread-2): On model.dbt_test.inventory: COMMIT
2022-08-22 11:36:07.430745 (Thread-2): SQL status: COMMIT in 0.02 seconds
2022-08-22 11:36:07.436851 (Thread-2): Using postgres connection "model.dbt_test.inventory".
2022-08-22 11:36:07.437159 (Thread-2): On model.dbt_test.inventory: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.inventory"} */
drop table if exists "dvdrental"."dvd_schema"."inventory__dbt_backup" cascade
2022-08-22 11:36:07.450584 (Thread-1): SQL status: ALTER TABLE in 0.14 seconds
2022-08-22 11:36:07.453410 (Thread-1): Using postgres connection "model.dbt_test.actor".
2022-08-22 11:36:07.453743 (Thread-3): SQL status: ALTER TABLE in 0.14 seconds
2022-08-22 11:36:07.453982 (Thread-1): On model.dbt_test.actor: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.actor"} */
alter table "dvdrental"."dvd_schema"."actor__dbt_tmp" rename to "actor"
2022-08-22 11:36:07.456450 (Thread-3): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:36:07.456823 (Thread-3): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-08-22 11:36:07.459478 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:36:07.459743 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:36:07.461249 (Thread-1): On model.dbt_test.actor: COMMIT
2022-08-22 11:36:07.462586 (Thread-3): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:36:07.462829 (Thread-1): Using postgres connection "model.dbt_test.actor".
2022-08-22 11:36:07.463043 (Thread-3): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:36:07.463286 (Thread-1): On model.dbt_test.actor: COMMIT
2022-08-22 11:36:07.463548 (Thread-3): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:36:07.466446 (Thread-2): SQL status: DROP TABLE in 0.03 seconds
2022-08-22 11:36:07.467819 (Thread-2): finished collecting timing info
2022-08-22 11:36:07.468133 (Thread-2): On model.dbt_test.inventory: Close
2022-08-22 11:36:07.468653 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9818af8e-ec40-4d54-a1fb-64d745491a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8c2a50>]}
2022-08-22 11:36:07.469106 (Thread-2): 14:36:07 | 2 of 6 OK created table model dvd_schema.inventory................... [SELECT 4581 in 0.29s]
2022-08-22 11:36:07.469360 (Thread-2): Finished running node model.dbt_test.inventory
2022-08-22 11:36:07.470599 (Thread-3): SQL status: COMMIT in 0.01 seconds
2022-08-22 11:36:07.472417 (Thread-3): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:36:07.472670 (Thread-3): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_backup" cascade
2022-08-22 11:36:07.474003 (Thread-1): SQL status: COMMIT in 0.01 seconds
2022-08-22 11:36:07.476002 (Thread-1): Using postgres connection "model.dbt_test.actor".
2022-08-22 11:36:07.476265 (Thread-1): On model.dbt_test.actor: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.actor"} */
drop table if exists "dvdrental"."dvd_schema"."actor__dbt_backup" cascade
2022-08-22 11:36:07.491406 (Thread-3): SQL status: DROP TABLE in 0.02 seconds
2022-08-22 11:36:07.492921 (Thread-3): finished collecting timing info
2022-08-22 11:36:07.493206 (Thread-3): On model.dbt_test.my_first_dbt_model: Close
2022-08-22 11:36:07.493684 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9818af8e-ec40-4d54-a1fb-64d745491a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d850f90>]}
2022-08-22 11:36:07.494113 (Thread-3): 14:36:07 | 3 of 6 OK created table model dvd_schema.my_first_dbt_model.......... [SELECT 2 in 0.31s]
2022-08-22 11:36:07.494383 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2022-08-22 11:36:07.494711 (Thread-3): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:36:07.495947 (Thread-1): finished collecting timing info
2022-08-22 11:36:07.496488 (Thread-1): On model.dbt_test.actor: Close
2022-08-22 11:36:07.496855 (Thread-2): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 11:36:07.497305 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9818af8e-ec40-4d54-a1fb-64d745491a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d84d810>]}
2022-08-22 11:36:07.497647 (Thread-2): 14:36:07 | 5 of 6 START view model dvd_schema.my_second_dbt_model............... [RUN]
2022-08-22 11:36:07.498109 (Thread-1): 14:36:07 | 1 of 6 OK created table model dvd_schema.actor....................... [SELECT 200 in 0.32s]
2022-08-22 11:36:07.498933 (Thread-2): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:36:07.499298 (Thread-1): Finished running node model.dbt_test.actor
2022-08-22 11:36:07.499539 (Thread-2): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 11:36:07.502560 (Thread-2): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:36:07.503127 (Thread-2): finished collecting timing info
2022-08-22 11:36:07.527064 (Thread-2): Writing runtime SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:36:07.527767 (Thread-2): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:36:07.527994 (Thread-2): On model.dbt_test.my_second_dbt_model: BEGIN
2022-08-22 11:36:07.528207 (Thread-2): Opening a new connection, currently in state closed
2022-08-22 11:36:07.548869 (Thread-2): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:36:07.549214 (Thread-2): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:36:07.549433 (Thread-2): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."dvd_schema"."my_first_dbt_model"
where id = 1
  );

2022-08-22 11:36:07.563290 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2022-08-22 11:36:07.566089 (Thread-2): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:36:07.566334 (Thread-2): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-08-22 11:36:07.568679 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:36:07.570004 (Thread-2): On model.dbt_test.my_second_dbt_model: COMMIT
2022-08-22 11:36:07.570248 (Thread-2): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:36:07.570457 (Thread-2): On model.dbt_test.my_second_dbt_model: COMMIT
2022-08-22 11:36:07.580305 (Thread-2): SQL status: COMMIT in 0.01 seconds
2022-08-22 11:36:07.582196 (Thread-2): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:36:07.582456 (Thread-2): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_backup" cascade
2022-08-22 11:36:07.584567 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-08-22 11:36:07.585946 (Thread-2): finished collecting timing info
2022-08-22 11:36:07.586236 (Thread-2): On model.dbt_test.my_second_dbt_model: Close
2022-08-22 11:36:07.586702 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9818af8e-ec40-4d54-a1fb-64d745491a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d798d90>]}
2022-08-22 11:36:07.587125 (Thread-2): 14:36:07 | 5 of 6 OK created view model dvd_schema.my_second_dbt_model.......... [CREATE VIEW in 0.09s]
2022-08-22 11:36:07.587372 (Thread-2): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 11:36:07.766370 (Thread-4): SQL status: SELECT 16044 in 0.49 seconds
2022-08-22 11:36:07.772428 (Thread-4): Using postgres connection "model.dbt_test.rental".
2022-08-22 11:36:07.772872 (Thread-4): On model.dbt_test.rental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.rental"} */
alter table "dvdrental"."dvd_schema"."rental" rename to "rental__dbt_backup"
2022-08-22 11:36:07.774523 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:36:07.778804 (Thread-4): Using postgres connection "model.dbt_test.rental".
2022-08-22 11:36:07.779420 (Thread-4): On model.dbt_test.rental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.rental"} */
alter table "dvdrental"."dvd_schema"."rental__dbt_tmp" rename to "rental"
2022-08-22 11:36:07.780682 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:36:07.782184 (Thread-4): On model.dbt_test.rental: COMMIT
2022-08-22 11:36:07.782430 (Thread-4): Using postgres connection "model.dbt_test.rental".
2022-08-22 11:36:07.782641 (Thread-4): On model.dbt_test.rental: COMMIT
2022-08-22 11:36:07.790393 (Thread-4): SQL status: COMMIT in 0.01 seconds
2022-08-22 11:36:07.792399 (Thread-4): Using postgres connection "model.dbt_test.rental".
2022-08-22 11:36:07.794204 (Thread-4): On model.dbt_test.rental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.rental"} */
drop table if exists "dvdrental"."dvd_schema"."rental__dbt_backup" cascade
2022-08-22 11:36:07.813622 (Thread-4): SQL status: DROP TABLE in 0.02 seconds
2022-08-22 11:36:07.816584 (Thread-4): finished collecting timing info
2022-08-22 11:36:07.816972 (Thread-4): On model.dbt_test.rental: Close
2022-08-22 11:36:07.817459 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9818af8e-ec40-4d54-a1fb-64d745491a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9c9850>]}
2022-08-22 11:36:07.817905 (Thread-4): 14:36:07 | 4 of 6 OK created table model dvd_schema.rental...................... [SELECT 16044 in 0.64s]
2022-08-22 11:36:07.818153 (Thread-4): Finished running node model.dbt_test.rental
2022-08-22 11:36:07.818589 (Thread-3): Began running node model.dbt_test.mart
2022-08-22 11:36:07.818919 (Thread-3): 14:36:07 | 6 of 6 START table model dvd_schema.mart............................. [RUN]
2022-08-22 11:36:07.819283 (Thread-3): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:36:07.819506 (Thread-3): Compiling model.dbt_test.mart
2022-08-22 11:36:07.822434 (Thread-3): Writing injected SQL for node "model.dbt_test.mart"
2022-08-22 11:36:07.822983 (Thread-3): finished collecting timing info
2022-08-22 11:36:07.825850 (Thread-3): Writing runtime SQL for node "model.dbt_test.mart"
2022-08-22 11:36:07.826367 (Thread-3): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:36:07.826579 (Thread-3): On model.dbt_test.mart: BEGIN
2022-08-22 11:36:07.826780 (Thread-3): Opening a new connection, currently in state closed
2022-08-22 11:36:07.841490 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-08-22 11:36:07.841849 (Thread-3): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:36:07.842067 (Thread-3): On model.dbt_test.mart: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.mart"} */


  create  table "dvdrental"."dvd_schema"."mart__dbt_tmp"
  as (
    select r.customer_id,
count(i.inventory_id) as cnt
from "dvdrental"."dvd_schema"."rental" r
left join "dvdrental"."dvd_schema"."inventory" i
on r.inventory_id = i.inventory_id
group by r.customer_id
order by cnt desc
limit 10
  );
2022-08-22 11:36:07.870792 (Thread-3): SQL status: SELECT 10 in 0.03 seconds
2022-08-22 11:36:07.877149 (Thread-3): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:36:07.877489 (Thread-3): On model.dbt_test.mart: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.mart"} */
alter table "dvdrental"."dvd_schema"."mart" rename to "mart__dbt_backup"
2022-08-22 11:36:07.878868 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:36:07.881343 (Thread-3): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:36:07.881575 (Thread-3): On model.dbt_test.mart: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.mart"} */
alter table "dvdrental"."dvd_schema"."mart__dbt_tmp" rename to "mart"
2022-08-22 11:36:07.886113 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:36:07.887812 (Thread-3): On model.dbt_test.mart: COMMIT
2022-08-22 11:36:07.888054 (Thread-3): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:36:07.888256 (Thread-3): On model.dbt_test.mart: COMMIT
2022-08-22 11:36:07.892362 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:36:07.894079 (Thread-3): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:36:07.894316 (Thread-3): On model.dbt_test.mart: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.mart"} */
drop table if exists "dvdrental"."dvd_schema"."mart__dbt_backup" cascade
2022-08-22 11:36:07.905328 (Thread-3): SQL status: DROP TABLE in 0.01 seconds
2022-08-22 11:36:07.906752 (Thread-3): finished collecting timing info
2022-08-22 11:36:07.907030 (Thread-3): On model.dbt_test.mart: Close
2022-08-22 11:36:07.907482 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9818af8e-ec40-4d54-a1fb-64d745491a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9c9490>]}
2022-08-22 11:36:07.907897 (Thread-3): 14:36:07 | 6 of 6 OK created table model dvd_schema.mart........................ [SELECT 10 in 0.09s]
2022-08-22 11:36:07.908145 (Thread-3): Finished running node model.dbt_test.mart
2022-08-22 11:36:07.986382 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:36:07.987714 (MainThread): Using postgres connection "master".
2022-08-22 11:36:07.988332 (MainThread): On master: BEGIN
2022-08-22 11:36:07.988975 (MainThread): Opening a new connection, currently in state closed
2022-08-22 11:36:08.005367 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:36:08.005988 (MainThread): On master: COMMIT
2022-08-22 11:36:08.006380 (MainThread): Using postgres connection "master".
2022-08-22 11:36:08.006767 (MainThread): On master: COMMIT
2022-08-22 11:36:08.008244 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:36:08.008662 (MainThread): On master: Close
2022-08-22 11:36:08.009620 (MainThread): 14:36:08 | 
2022-08-22 11:36:08.010077 (MainThread): 14:36:08 | Finished running 5 table models, 1 view model in 1.20s.
2022-08-22 11:36:08.010506 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:36:08.010877 (MainThread): Connection 'model.dbt_test.actor' was properly closed.
2022-08-22 11:36:08.011292 (MainThread): Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
2022-08-22 11:36:08.011524 (MainThread): Connection 'model.dbt_test.mart' was properly closed.
2022-08-22 11:36:08.011725 (MainThread): Connection 'model.dbt_test.rental' was properly closed.
2022-08-22 11:36:08.017463 (MainThread): 
2022-08-22 11:36:08.017775 (MainThread): Completed successfully
2022-08-22 11:36:08.018026 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2022-08-22 11:36:08.018322 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d878ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d878f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d878b10>]}
2022-08-22 11:36:08.018623 (MainThread): Flushing usage events
2022-08-22 11:36:15.418513 (MainThread): Running with dbt=0.21.1
2022-08-22 11:36:15.508939 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='snapshot', write_json=True)
2022-08-22 11:36:15.510587 (MainThread): Tracking: tracking
2022-08-22 11:36:15.522804 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111418790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113fda50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113fdd90>]}
2022-08-22 11:36:15.536945 (MainThread): Partial parsing not enabled
2022-08-22 11:36:15.548905 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:36:15.553041 (MainThread): Parsing macros/relations.sql
2022-08-22 11:36:15.554932 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:36:15.585649 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:36:15.587981 (MainThread): Parsing macros/core.sql
2022-08-22 11:36:15.592963 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:36:15.602270 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:36:15.615482 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:36:15.617689 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:36:15.641268 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:36:15.689914 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:36:15.721793 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:36:15.724127 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:36:15.738467 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:36:15.767179 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:36:15.786680 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:36:15.797870 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:36:15.808293 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:36:15.813434 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:36:15.815373 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:36:15.816623 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:36:15.818674 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:36:15.830475 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:36:15.832843 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:36:15.836011 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:36:15.838057 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:36:15.914713 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:36:15.916934 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:36:15.918448 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:36:15.920173 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:36:16.151101 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:36:16.167771 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:36:16.172018 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:36:16.176676 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:36:16.180981 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:36:16.185866 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:36:16.201466 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:36:16.257379 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:36:16.259511 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:36:16.261739 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:36:16.263768 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:36:16.283917 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05c7b244-19bb-46d1-b6a3-78abd09392c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bd2290>]}
2022-08-22 11:36:16.289805 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:36:16.290390 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05c7b244-19bb-46d1-b6a3-78abd09392c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a2550>]}
2022-08-22 11:36:16.290711 (MainThread): Found 6 models, 4 tests, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:36:16.292427 (MainThread): 
2022-08-22 11:36:16.292825 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:36:16.293709 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 11:36:16.305832 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 11:36:16.306058 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 11:36:16.306267 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:36:16.338883 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2022-08-22 11:36:16.340856 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 11:36:16.341631 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "create_dvdrental_snapshots".
2022-08-22 11:36:16.342130 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "create_dvdrental_snapshots".
2022-08-22 11:36:16.342437 (ThreadPoolExecutor-0_0): Creating schema ""dvdrental"."snapshots""
2022-08-22 11:36:16.348980 (ThreadPoolExecutor-0_0): Using postgres connection "create_dvdrental_snapshots".
2022-08-22 11:36:16.349256 (ThreadPoolExecutor-0_0): On create_dvdrental_snapshots: BEGIN
2022-08-22 11:36:16.349466 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2022-08-22 11:36:16.364655 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:36:16.364985 (ThreadPoolExecutor-0_0): Using postgres connection "create_dvdrental_snapshots".
2022-08-22 11:36:16.365191 (ThreadPoolExecutor-0_0): On create_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dvdrental_snapshots"} */
create schema if not exists "snapshots"
2022-08-22 11:36:16.367721 (ThreadPoolExecutor-0_0): SQL status: CREATE SCHEMA in 0.00 seconds
2022-08-22 11:36:16.368752 (ThreadPoolExecutor-0_0): On create_dvdrental_snapshots: COMMIT
2022-08-22 11:36:16.368981 (ThreadPoolExecutor-0_0): Using postgres connection "create_dvdrental_snapshots".
2022-08-22 11:36:16.369172 (ThreadPoolExecutor-0_0): On create_dvdrental_snapshots: COMMIT
2022-08-22 11:36:16.372675 (ThreadPoolExecutor-0_0): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:36:16.372961 (ThreadPoolExecutor-0_0): On create_dvdrental_snapshots: Close
2022-08-22 11:36:16.374644 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:36:16.375146 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:36:16.382417 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:36:16.384028 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:36:16.384278 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:36:16.384512 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:36:16.384758 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 11:36:16.384997 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 11:36:16.403274 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:36:16.403641 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:36:16.403882 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:36:16.404128 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:36:16.404344 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:36:16.404578 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:36:16.424532 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.02 seconds
2022-08-22 11:36:16.426221 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:36:16.426478 (ThreadPoolExecutor-1_1): SQL status: SELECT 0 in 0.02 seconds
2022-08-22 11:36:16.427758 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:36:16.427989 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:36:16.429164 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: Close
2022-08-22 11:36:16.434455 (MainThread): Using postgres connection "master".
2022-08-22 11:36:16.434730 (MainThread): On master: BEGIN
2022-08-22 11:36:16.434936 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:36:16.451435 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:36:16.451752 (MainThread): Using postgres connection "master".
2022-08-22 11:36:16.451957 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:36:16.661591 (MainThread): SQL status: SELECT 38 in 0.21 seconds
2022-08-22 11:36:16.667880 (MainThread): On master: ROLLBACK
2022-08-22 11:36:16.669551 (MainThread): Using postgres connection "master".
2022-08-22 11:36:16.669970 (MainThread): On master: BEGIN
2022-08-22 11:36:16.672207 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 11:36:16.672619 (MainThread): On master: COMMIT
2022-08-22 11:36:16.672988 (MainThread): Using postgres connection "master".
2022-08-22 11:36:16.673345 (MainThread): On master: COMMIT
2022-08-22 11:36:16.674696 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:36:16.675178 (MainThread): On master: Close
2022-08-22 11:36:16.675996 (MainThread): 14:36:16 | Concurrency: 4 threads (target='dev')
2022-08-22 11:36:16.676428 (MainThread): 14:36:16 | 
2022-08-22 11:36:16.679805 (Thread-1): Began running node snapshot.dbt_test.actor_snapshot
2022-08-22 11:36:16.680301 (Thread-1): 14:36:16 | 1 of 1 START snapshot snapshots.actor_snapshot....................... [RUN]
2022-08-22 11:36:16.680772 (Thread-1): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:36:16.681047 (Thread-1): Compiling snapshot.dbt_test.actor_snapshot
2022-08-22 11:36:16.684872 (Thread-1): finished collecting timing info
2022-08-22 11:36:16.720450 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:36:16.720797 (Thread-1): On snapshot.dbt_test.actor_snapshot: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot"} */

    select count(*) from pg_namespace where nspname = 'snapshots'
  
2022-08-22 11:36:16.721030 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:36:16.740704 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2022-08-22 11:36:16.778370 (Thread-1): Writing runtime SQL for node "snapshot.dbt_test.actor_snapshot"
2022-08-22 11:36:16.779079 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:36:16.779305 (Thread-1): On snapshot.dbt_test.actor_snapshot: BEGIN
2022-08-22 11:36:16.780431 (Thread-1): SQL status: BEGIN in 0.00 seconds
2022-08-22 11:36:16.780695 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:36:16.780904 (Thread-1): On snapshot.dbt_test.actor_snapshot: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot"} */

      

  create  table "dvdrental"."snapshots"."actor_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(actor_id as varchar ), '')
         || '|' || coalesce(cast(last_update as varchar ), '')
        ) as dbt_scd_id,
        last_update as dbt_updated_at,
        last_update as dbt_valid_from,
        nullif(last_update, last_update) as dbt_valid_to
    from (
        



select * from "dvdrental"."public"."actor"

    ) sbq


  );
  
2022-08-22 11:36:16.832226 (Thread-1): SQL status: SELECT 200 in 0.05 seconds
2022-08-22 11:36:16.845659 (Thread-1): On snapshot.dbt_test.actor_snapshot: COMMIT
2022-08-22 11:36:16.845905 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:36:16.846106 (Thread-1): On snapshot.dbt_test.actor_snapshot: COMMIT
2022-08-22 11:36:16.854592 (Thread-1): SQL status: COMMIT in 0.01 seconds
2022-08-22 11:36:16.855320 (Thread-1): finished collecting timing info
2022-08-22 11:36:16.855593 (Thread-1): On snapshot.dbt_test.actor_snapshot: Close
2022-08-22 11:36:16.856075 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05c7b244-19bb-46d1-b6a3-78abd09392c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bbdc90>]}
2022-08-22 11:36:16.856534 (Thread-1): 14:36:16 | 1 of 1 OK snapshotted snapshots.actor_snapshot....................... [SELECT 200 in 0.18s]
2022-08-22 11:36:16.856786 (Thread-1): Finished running node snapshot.dbt_test.actor_snapshot
2022-08-22 11:36:16.885456 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:36:16.885809 (MainThread): Using postgres connection "master".
2022-08-22 11:36:16.886014 (MainThread): On master: BEGIN
2022-08-22 11:36:16.886212 (MainThread): Opening a new connection, currently in state closed
2022-08-22 11:36:16.902329 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:36:16.902703 (MainThread): On master: COMMIT
2022-08-22 11:36:16.902911 (MainThread): Using postgres connection "master".
2022-08-22 11:36:16.903107 (MainThread): On master: COMMIT
2022-08-22 11:36:16.904300 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:36:16.904579 (MainThread): On master: Close
2022-08-22 11:36:16.905022 (MainThread): 14:36:16 | 
2022-08-22 11:36:16.905273 (MainThread): 14:36:16 | Finished running 1 snapshot in 0.61s.
2022-08-22 11:36:16.905500 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:36:16.905690 (MainThread): Connection 'snapshot.dbt_test.actor_snapshot' was properly closed.
2022-08-22 11:36:16.905877 (MainThread): Connection 'list_dvdrental_snapshots' was properly closed.
2022-08-22 11:36:16.911654 (MainThread): 
2022-08-22 11:36:16.911980 (MainThread): Completed successfully
2022-08-22 11:36:16.912226 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-08-22 11:36:16.912526 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bb350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114bf050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c0c390>]}
2022-08-22 11:36:16.912833 (MainThread): Flushing usage events
2022-08-22 11:37:30.041517 (MainThread): Running with dbt=0.21.1
2022-08-22 11:37:30.131744 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['example'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 11:37:30.133243 (MainThread): Tracking: tracking
2022-08-22 11:37:30.145937 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111560110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105ae9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111060510>]}
2022-08-22 11:37:30.160420 (MainThread): Partial parsing not enabled
2022-08-22 11:37:30.172493 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:37:30.176645 (MainThread): Parsing macros/relations.sql
2022-08-22 11:37:30.178556 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:37:30.208933 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:37:30.211315 (MainThread): Parsing macros/core.sql
2022-08-22 11:37:30.216662 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:37:30.226192 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:37:30.239806 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:37:30.242457 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:37:30.267084 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:37:30.315107 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:37:30.346688 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:37:30.349028 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:37:30.363327 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:37:30.391261 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:37:30.410585 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:37:30.421726 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:37:30.432142 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:37:30.437334 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:37:30.439290 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:37:30.440562 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:37:30.442634 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:37:30.454335 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:37:30.456724 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:37:30.459922 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:37:30.461986 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:37:30.536740 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:37:30.538962 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:37:30.540489 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:37:30.542234 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:37:30.772320 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:37:30.788921 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:37:30.793225 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:37:30.797900 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:37:30.802284 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:37:30.807136 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:37:30.822852 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:37:30.878602 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:37:30.880722 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:37:30.882967 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:37:30.884979 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:37:30.904958 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24954a0d-0659-4c95-a49e-596206cf0d75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d05bd0>]}
2022-08-22 11:37:30.910902 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:37:30.911514 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24954a0d-0659-4c95-a49e-596206cf0d75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d14410>]}
2022-08-22 11:37:30.911828 (MainThread): Found 6 models, 4 tests, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:37:30.913312 (MainThread): 
2022-08-22 11:37:30.913706 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:37:30.914817 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 11:37:30.927067 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 11:37:30.927345 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 11:37:30.927552 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:37:30.989300 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.06 seconds
2022-08-22 11:37:30.991265 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 11:37:30.992856 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:37:30.993474 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:37:31.000794 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:37:31.002390 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:37:31.002627 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:37:31.002837 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:37:31.003039 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 11:37:31.003235 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 11:37:31.022668 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:37:31.023018 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:37:31.023235 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:37:31.023643 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:37:31.023892 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:37:31.024095 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:37:31.040122 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.02 seconds
2022-08-22 11:37:31.041621 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:37:31.041876 (ThreadPoolExecutor-1_1): SQL status: SELECT 6 in 0.02 seconds
2022-08-22 11:37:31.043313 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:37:31.043552 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: Close
2022-08-22 11:37:31.044699 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: Close
2022-08-22 11:37:31.050264 (MainThread): Using postgres connection "master".
2022-08-22 11:37:31.050539 (MainThread): On master: BEGIN
2022-08-22 11:37:31.050743 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:37:31.066498 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:37:31.066823 (MainThread): Using postgres connection "master".
2022-08-22 11:37:31.067063 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:37:31.284013 (MainThread): SQL status: SELECT 38 in 0.22 seconds
2022-08-22 11:37:31.291576 (MainThread): On master: ROLLBACK
2022-08-22 11:37:31.292993 (MainThread): Using postgres connection "master".
2022-08-22 11:37:31.293372 (MainThread): On master: BEGIN
2022-08-22 11:37:31.295581 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 11:37:31.296037 (MainThread): On master: COMMIT
2022-08-22 11:37:31.296439 (MainThread): Using postgres connection "master".
2022-08-22 11:37:31.296801 (MainThread): On master: COMMIT
2022-08-22 11:37:31.298087 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:37:31.298553 (MainThread): On master: Close
2022-08-22 11:37:31.299339 (MainThread): 14:37:31 | Concurrency: 4 threads (target='dev')
2022-08-22 11:37:31.299770 (MainThread): 14:37:31 | 
2022-08-22 11:37:31.302878 (Thread-1): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:37:31.303372 (Thread-1): 14:37:31 | 1 of 2 START table model dvd_schema.my_first_dbt_model............... [RUN]
2022-08-22 11:37:31.303823 (Thread-1): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:37:31.304088 (Thread-1): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:37:31.307054 (Thread-1): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:37:31.307645 (Thread-1): finished collecting timing info
2022-08-22 11:37:31.342199 (Thread-1): Writing runtime SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:37:31.342953 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:37:31.343203 (Thread-1): On model.dbt_test.my_first_dbt_model: BEGIN
2022-08-22 11:37:31.343437 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:37:31.358803 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:37:31.359148 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:37:31.359367 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */


  create  table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-08-22 11:37:31.374853 (Thread-1): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 11:37:31.382226 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:37:31.382470 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-08-22 11:37:31.383836 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:37:31.386124 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:37:31.386357 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-08-22 11:37:31.387735 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:37:31.400880 (Thread-1): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:37:31.401134 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:37:31.401339 (Thread-1): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:37:31.405788 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:37:31.411404 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:37:31.411645 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_backup" cascade
2022-08-22 11:37:31.424975 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2022-08-22 11:37:31.426413 (Thread-1): finished collecting timing info
2022-08-22 11:37:31.426690 (Thread-1): On model.dbt_test.my_first_dbt_model: Close
2022-08-22 11:37:31.427156 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24954a0d-0659-4c95-a49e-596206cf0d75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e3edd0>]}
2022-08-22 11:37:31.427569 (Thread-1): 14:37:31 | 1 of 2 OK created table model dvd_schema.my_first_dbt_model.......... [SELECT 2 in 0.12s]
2022-08-22 11:37:31.427819 (Thread-1): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:37:31.428259 (Thread-3): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 11:37:31.428572 (Thread-3): 14:37:31 | 2 of 2 START view model dvd_schema.my_second_dbt_model............... [RUN]
2022-08-22 11:37:31.428954 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:37:31.429166 (Thread-3): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 11:37:31.431906 (Thread-3): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:37:31.432470 (Thread-3): finished collecting timing info
2022-08-22 11:37:31.455028 (Thread-3): Writing runtime SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:37:31.455659 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:37:31.455871 (Thread-3): On model.dbt_test.my_second_dbt_model: BEGIN
2022-08-22 11:37:31.456073 (Thread-3): Opening a new connection, currently in state init
2022-08-22 11:37:31.474214 (Thread-3): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:37:31.474550 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:37:31.474763 (Thread-3): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."dvd_schema"."my_first_dbt_model"
where id = 1
  );

2022-08-22 11:37:31.486867 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-08-22 11:37:31.489519 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:37:31.489752 (Thread-3): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-08-22 11:37:31.491213 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:37:31.492441 (Thread-3): On model.dbt_test.my_second_dbt_model: COMMIT
2022-08-22 11:37:31.492664 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:37:31.492858 (Thread-3): On model.dbt_test.my_second_dbt_model: COMMIT
2022-08-22 11:37:31.497601 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:37:31.500666 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:37:31.500900 (Thread-3): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_backup" cascade
2022-08-22 11:37:31.502073 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-08-22 11:37:31.503295 (Thread-3): finished collecting timing info
2022-08-22 11:37:31.503563 (Thread-3): On model.dbt_test.my_second_dbt_model: Close
2022-08-22 11:37:31.504006 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24954a0d-0659-4c95-a49e-596206cf0d75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ebe150>]}
2022-08-22 11:37:31.504408 (Thread-3): 14:37:31 | 2 of 2 OK created view model dvd_schema.my_second_dbt_model.......... [CREATE VIEW in 0.08s]
2022-08-22 11:37:31.504645 (Thread-3): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 11:37:31.507303 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:37:31.507590 (MainThread): Using postgres connection "master".
2022-08-22 11:37:31.507790 (MainThread): On master: BEGIN
2022-08-22 11:37:31.507988 (MainThread): Opening a new connection, currently in state closed
2022-08-22 11:37:31.524363 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:37:31.524707 (MainThread): On master: COMMIT
2022-08-22 11:37:31.524916 (MainThread): Using postgres connection "master".
2022-08-22 11:37:31.525113 (MainThread): On master: COMMIT
2022-08-22 11:37:31.526598 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:37:31.526863 (MainThread): On master: Close
2022-08-22 11:37:31.527290 (MainThread): 14:37:31 | 
2022-08-22 11:37:31.527520 (MainThread): 14:37:31 | Finished running 1 table model, 1 view model in 0.61s.
2022-08-22 11:37:31.527740 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:37:31.527925 (MainThread): Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
2022-08-22 11:37:31.528107 (MainThread): Connection 'list_dvdrental_dvd_schema' was properly closed.
2022-08-22 11:37:31.528286 (MainThread): Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
2022-08-22 11:37:31.533606 (MainThread): 
2022-08-22 11:37:31.533886 (MainThread): Completed successfully
2022-08-22 11:37:31.534123 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-08-22 11:37:31.534406 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ed5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eca6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ecab50>]}
2022-08-22 11:37:31.534694 (MainThread): Flushing usage events
2022-08-22 11:37:46.994377 (MainThread): Running with dbt=0.21.1
2022-08-22 11:37:47.085956 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['mart'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 11:37:47.087496 (MainThread): Tracking: tracking
2022-08-22 11:37:47.099353 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3c9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3aa490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3b3c50>]}
2022-08-22 11:37:47.113885 (MainThread): Partial parsing not enabled
2022-08-22 11:37:47.125999 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:37:47.130208 (MainThread): Parsing macros/relations.sql
2022-08-22 11:37:47.132119 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:37:47.162819 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:37:47.165118 (MainThread): Parsing macros/core.sql
2022-08-22 11:37:47.170095 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:37:47.179472 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:37:47.192639 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:37:47.194850 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:37:47.218515 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:37:47.268614 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:37:47.300549 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:37:47.302901 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:37:47.317443 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:37:47.346396 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:37:47.366293 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:37:47.377978 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:37:47.388649 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:37:47.393825 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:37:47.395788 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:37:47.397052 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:37:47.399148 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:37:47.411030 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:37:47.413449 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:37:47.416633 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:37:47.418684 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:37:47.495180 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:37:47.497360 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:37:47.498925 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:37:47.500677 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:37:47.729891 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:37:47.746530 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:37:47.750743 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:37:47.755385 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:37:47.759760 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:37:47.764580 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:37:47.780265 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:37:47.835992 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:37:47.838130 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:37:47.840346 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:37:47.842375 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:37:47.862218 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c501678-46e8-4e5f-b686-971183e96940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb6d490>]}
2022-08-22 11:37:47.868063 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:37:47.868655 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c501678-46e8-4e5f-b686-971183e96940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb7c690>]}
2022-08-22 11:37:47.868973 (MainThread): Found 6 models, 4 tests, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:37:47.870371 (MainThread): 
2022-08-22 11:37:47.870764 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:37:47.871769 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 11:37:47.883952 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 11:37:47.884184 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 11:37:47.884391 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:37:47.937150 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.05 seconds
2022-08-22 11:37:47.939031 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 11:37:47.940560 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:37:47.941106 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:37:47.948368 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:37:47.949978 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:37:47.950245 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:37:47.950503 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:37:47.950723 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 11:37:47.950924 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 11:37:47.969270 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:37:47.969689 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:37:47.969946 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:37:47.970218 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:37:47.970470 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:37:47.970700 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:37:47.986163 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.02 seconds
2022-08-22 11:37:47.986488 (ThreadPoolExecutor-1_1): SQL status: SELECT 6 in 0.02 seconds
2022-08-22 11:37:47.987961 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:37:47.989298 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:37:47.990546 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: Close
2022-08-22 11:37:47.990779 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: Close
2022-08-22 11:37:47.996522 (MainThread): Using postgres connection "master".
2022-08-22 11:37:47.996814 (MainThread): On master: BEGIN
2022-08-22 11:37:47.997026 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:37:48.014279 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:37:48.014629 (MainThread): Using postgres connection "master".
2022-08-22 11:37:48.014874 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:37:48.228634 (MainThread): SQL status: SELECT 38 in 0.21 seconds
2022-08-22 11:37:48.236293 (MainThread): On master: ROLLBACK
2022-08-22 11:37:48.237717 (MainThread): Using postgres connection "master".
2022-08-22 11:37:48.238115 (MainThread): On master: BEGIN
2022-08-22 11:37:48.240320 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 11:37:48.240757 (MainThread): On master: COMMIT
2022-08-22 11:37:48.241152 (MainThread): Using postgres connection "master".
2022-08-22 11:37:48.241537 (MainThread): On master: COMMIT
2022-08-22 11:37:48.242737 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:37:48.243156 (MainThread): On master: Close
2022-08-22 11:37:48.243934 (MainThread): 14:37:48 | Concurrency: 4 threads (target='dev')
2022-08-22 11:37:48.244372 (MainThread): 14:37:48 | 
2022-08-22 11:37:48.247452 (Thread-1): Began running node model.dbt_test.mart
2022-08-22 11:37:48.247935 (Thread-1): 14:37:48 | 1 of 1 START table model dvd_schema.mart............................. [RUN]
2022-08-22 11:37:48.248404 (Thread-1): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:37:48.248669 (Thread-1): Compiling model.dbt_test.mart
2022-08-22 11:37:48.251897 (Thread-1): Writing injected SQL for node "model.dbt_test.mart"
2022-08-22 11:37:48.252508 (Thread-1): finished collecting timing info
2022-08-22 11:37:48.287506 (Thread-1): Writing runtime SQL for node "model.dbt_test.mart"
2022-08-22 11:37:48.288238 (Thread-1): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:37:48.288505 (Thread-1): On model.dbt_test.mart: BEGIN
2022-08-22 11:37:48.288752 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:37:48.305995 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:37:48.306340 (Thread-1): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:37:48.306558 (Thread-1): On model.dbt_test.mart: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.mart"} */


  create  table "dvdrental"."dvd_schema"."mart__dbt_tmp"
  as (
    select r.customer_id,
count(i.inventory_id) as cnt
from "dvdrental"."dvd_schema"."rental" r
left join "dvdrental"."dvd_schema"."inventory" i
on r.inventory_id = i.inventory_id
group by r.customer_id
order by cnt desc
limit 10
  );
2022-08-22 11:37:48.333816 (Thread-1): SQL status: SELECT 10 in 0.03 seconds
2022-08-22 11:37:48.341203 (Thread-1): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:37:48.341448 (Thread-1): On model.dbt_test.mart: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.mart"} */
alter table "dvdrental"."dvd_schema"."mart" rename to "mart__dbt_backup"
2022-08-22 11:37:48.343924 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:37:48.346628 (Thread-1): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:37:48.346889 (Thread-1): On model.dbt_test.mart: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.mart"} */
alter table "dvdrental"."dvd_schema"."mart__dbt_tmp" rename to "mart"
2022-08-22 11:37:48.348605 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:37:48.362092 (Thread-1): On model.dbt_test.mart: COMMIT
2022-08-22 11:37:48.362413 (Thread-1): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:37:48.362627 (Thread-1): On model.dbt_test.mart: COMMIT
2022-08-22 11:37:48.368157 (Thread-1): SQL status: COMMIT in 0.01 seconds
2022-08-22 11:37:48.374017 (Thread-1): Using postgres connection "model.dbt_test.mart".
2022-08-22 11:37:48.374309 (Thread-1): On model.dbt_test.mart: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.mart"} */
drop table if exists "dvdrental"."dvd_schema"."mart__dbt_backup" cascade
2022-08-22 11:37:48.395819 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2022-08-22 11:37:48.397495 (Thread-1): finished collecting timing info
2022-08-22 11:37:48.397820 (Thread-1): On model.dbt_test.mart: Close
2022-08-22 11:37:48.398397 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c501678-46e8-4e5f-b686-971183e96940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fca4ad0>]}
2022-08-22 11:37:48.398889 (Thread-1): 14:37:48 | 1 of 1 OK created table model dvd_schema.mart........................ [SELECT 10 in 0.15s]
2022-08-22 11:37:48.399170 (Thread-1): Finished running node model.dbt_test.mart
2022-08-22 11:37:48.452778 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:37:48.453133 (MainThread): Using postgres connection "master".
2022-08-22 11:37:48.453344 (MainThread): On master: BEGIN
2022-08-22 11:37:48.453545 (MainThread): Opening a new connection, currently in state closed
2022-08-22 11:37:48.469583 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:37:48.469937 (MainThread): On master: COMMIT
2022-08-22 11:37:48.470153 (MainThread): Using postgres connection "master".
2022-08-22 11:37:48.470353 (MainThread): On master: COMMIT
2022-08-22 11:37:48.471818 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:37:48.472105 (MainThread): On master: Close
2022-08-22 11:37:48.472552 (MainThread): 14:37:48 | 
2022-08-22 11:37:48.472800 (MainThread): 14:37:48 | Finished running 1 table model in 0.60s.
2022-08-22 11:37:48.473026 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:37:48.473219 (MainThread): Connection 'model.dbt_test.mart' was properly closed.
2022-08-22 11:37:48.473403 (MainThread): Connection 'list_dvdrental_dvd_schema' was properly closed.
2022-08-22 11:37:48.479162 (MainThread): 
2022-08-22 11:37:48.479453 (MainThread): Completed successfully
2022-08-22 11:37:48.479687 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-08-22 11:37:48.479976 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc23f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcd54d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee9da50>]}
2022-08-22 11:37:48.480274 (MainThread): Flushing usage events
2022-08-22 11:38:31.504343 (MainThread): Running with dbt=0.21.1
2022-08-22 11:38:31.596885 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2022-08-22 11:38:31.599647 (MainThread): Tracking: tracking
2022-08-22 11:38:31.612510 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b34750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b3b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b3be50>]}
2022-08-22 11:38:31.627283 (MainThread): Partial parsing not enabled
2022-08-22 11:38:31.639495 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:38:31.643789 (MainThread): Parsing macros/relations.sql
2022-08-22 11:38:31.645732 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:38:31.677447 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:38:31.679783 (MainThread): Parsing macros/core.sql
2022-08-22 11:38:31.684850 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:38:31.694365 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:38:31.707800 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:38:31.710057 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:38:31.733990 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:38:31.784037 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:38:31.816604 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:38:31.818955 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:38:31.833575 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:38:31.862716 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:38:31.882751 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:38:31.894114 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:38:31.904754 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:38:31.909955 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:38:31.911920 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:38:31.913198 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:38:31.915269 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:38:31.927201 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:38:31.929603 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:38:31.932827 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:38:31.934906 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:38:32.014022 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:38:32.016260 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:38:32.017800 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:38:32.019558 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:38:32.252474 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:38:32.269247 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:38:32.273591 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:38:32.278301 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:38:32.282697 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:38:32.287572 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:38:32.303690 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:38:32.360731 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:38:32.362867 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:38:32.365095 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:38:32.367130 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:38:32.387222 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c4ae6bf-2626-4aa2-ab32-cc3e85206b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111be2e10>]}
2022-08-22 11:38:32.393158 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:38:32.393769 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c4ae6bf-2626-4aa2-ab32-cc3e85206b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122d7c50>]}
2022-08-22 11:38:32.394085 (MainThread): Found 6 models, 4 tests, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:38:32.396173 (MainThread): 
2022-08-22 11:38:32.396572 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:38:32.397824 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:38:32.404709 (ThreadPoolExecutor-0_1): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:38:32.417173 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:38:32.418365 (ThreadPoolExecutor-0_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:38:32.418573 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:38:32.418792 (ThreadPoolExecutor-0_1): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:38:32.419001 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:38:32.419199 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state init
2022-08-22 11:38:32.465648 (ThreadPoolExecutor-0_1): SQL status: BEGIN in 0.05 seconds
2022-08-22 11:38:32.466018 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.05 seconds
2022-08-22 11:38:32.466231 (ThreadPoolExecutor-0_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:38:32.466450 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:38:32.466653 (ThreadPoolExecutor-0_1): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:38:32.466868 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:38:32.484289 (ThreadPoolExecutor-0_1): SQL status: SELECT 1 in 0.02 seconds
2022-08-22 11:38:32.486316 (ThreadPoolExecutor-0_1): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:38:32.486612 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.02 seconds
2022-08-22 11:38:32.488048 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:38:32.488283 (ThreadPoolExecutor-0_1): On list_dvdrental_snapshots: Close
2022-08-22 11:38:32.489587 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:38:32.495383 (MainThread): Using postgres connection "master".
2022-08-22 11:38:32.495668 (MainThread): On master: BEGIN
2022-08-22 11:38:32.495874 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:38:32.512885 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:38:32.513224 (MainThread): Using postgres connection "master".
2022-08-22 11:38:32.513438 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:38:32.728087 (MainThread): SQL status: SELECT 38 in 0.21 seconds
2022-08-22 11:38:32.733457 (MainThread): On master: ROLLBACK
2022-08-22 11:38:32.734794 (MainThread): On master: Close
2022-08-22 11:38:32.735637 (MainThread): 14:38:32 | Concurrency: 4 threads (target='dev')
2022-08-22 11:38:32.736085 (MainThread): 14:38:32 | 
2022-08-22 11:38:32.739418 (Thread-1): Began running node model.dbt_test.actor
2022-08-22 11:38:32.739799 (Thread-2): Began running node model.dbt_test.inventory
2022-08-22 11:38:32.740099 (Thread-3): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:38:32.740366 (Thread-4): Began running node model.dbt_test.rental
2022-08-22 11:38:32.740866 (Thread-1): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:38:32.741306 (Thread-2): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:38:32.741744 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:38:32.742371 (Thread-4): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:38:32.742668 (Thread-1): Compiling model.dbt_test.actor
2022-08-22 11:38:32.742890 (Thread-2): Compiling model.dbt_test.inventory
2022-08-22 11:38:32.743095 (Thread-3): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:38:32.743335 (Thread-4): Compiling model.dbt_test.rental
2022-08-22 11:38:32.746252 (Thread-1): Writing injected SQL for node "model.dbt_test.actor"
2022-08-22 11:38:32.748800 (Thread-2): Writing injected SQL for node "model.dbt_test.inventory"
2022-08-22 11:38:32.751348 (Thread-3): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:38:32.753680 (Thread-4): Writing injected SQL for node "model.dbt_test.rental"
2022-08-22 11:38:32.754669 (Thread-3): finished collecting timing info
2022-08-22 11:38:32.754937 (Thread-1): finished collecting timing info
2022-08-22 11:38:32.755159 (Thread-2): finished collecting timing info
2022-08-22 11:38:32.755409 (Thread-3): finished collecting timing info
2022-08-22 11:38:32.755598 (Thread-4): finished collecting timing info
2022-08-22 11:38:32.755843 (Thread-1): finished collecting timing info
2022-08-22 11:38:32.756099 (Thread-2): finished collecting timing info
2022-08-22 11:38:32.756551 (Thread-3): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:38:32.756820 (Thread-4): finished collecting timing info
2022-08-22 11:38:32.757216 (Thread-1): Finished running node model.dbt_test.actor
2022-08-22 11:38:32.757604 (Thread-2): Finished running node model.dbt_test.inventory
2022-08-22 11:38:32.757864 (Thread-3): Began running node snapshot.dbt_test.actor_snapshot
2022-08-22 11:38:32.758352 (Thread-4): Finished running node model.dbt_test.rental
2022-08-22 11:38:32.758713 (Thread-1): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 11:38:32.759005 (Thread-2): Began running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:38:32.759619 (Thread-3): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:38:32.759860 (Thread-4): Began running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:38:32.760262 (Thread-1): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:38:32.760660 (Thread-2): Acquiring new postgres connection "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710".
2022-08-22 11:38:32.760878 (Thread-3): Compiling snapshot.dbt_test.actor_snapshot
2022-08-22 11:38:32.761195 (Thread-4): Acquiring new postgres connection "test.dbt_test.unique_my_first_dbt_model_id.16e066b321".
2022-08-22 11:38:32.761420 (Thread-1): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 11:38:32.761613 (Thread-2): Compiling test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:38:32.765696 (Thread-3): finished collecting timing info
2022-08-22 11:38:32.765948 (Thread-4): Compiling test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:38:32.768567 (Thread-1): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:38:32.781547 (Thread-3): finished collecting timing info
2022-08-22 11:38:32.781909 (Thread-2): Writing injected SQL for node "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710"
2022-08-22 11:38:32.788875 (Thread-4): Writing injected SQL for node "test.dbt_test.unique_my_first_dbt_model_id.16e066b321"
2022-08-22 11:38:32.789320 (Thread-3): Finished running node snapshot.dbt_test.actor_snapshot
2022-08-22 11:38:32.789827 (Thread-3): Began running node model.dbt_test.mart
2022-08-22 11:38:32.790216 (Thread-3): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:38:32.790558 (Thread-3): Compiling model.dbt_test.mart
2022-08-22 11:38:32.790783 (Thread-1): finished collecting timing info
2022-08-22 11:38:32.790995 (Thread-2): finished collecting timing info
2022-08-22 11:38:32.793726 (Thread-3): Writing injected SQL for node "model.dbt_test.mart"
2022-08-22 11:38:32.793929 (Thread-4): finished collecting timing info
2022-08-22 11:38:32.794183 (Thread-1): finished collecting timing info
2022-08-22 11:38:32.794426 (Thread-2): finished collecting timing info
2022-08-22 11:38:32.794714 (Thread-4): finished collecting timing info
2022-08-22 11:38:32.795122 (Thread-1): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 11:38:32.795492 (Thread-2): Finished running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:38:32.795706 (Thread-3): finished collecting timing info
2022-08-22 11:38:32.796053 (Thread-4): Finished running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:38:32.796584 (Thread-3): finished collecting timing info
2022-08-22 11:38:32.796781 (Thread-1): Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:38:32.797002 (Thread-2): Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:38:32.797431 (Thread-3): Finished running node model.dbt_test.mart
2022-08-22 11:38:32.797769 (Thread-1): Acquiring new postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 11:38:32.798098 (Thread-2): Acquiring new postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 11:38:32.798399 (Thread-1): Compiling test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:38:32.798614 (Thread-2): Compiling test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:38:32.802236 (Thread-1): Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 11:38:32.805580 (Thread-2): Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 11:38:32.806071 (Thread-1): finished collecting timing info
2022-08-22 11:38:32.806297 (Thread-2): finished collecting timing info
2022-08-22 11:38:32.806523 (Thread-1): finished collecting timing info
2022-08-22 11:38:32.806749 (Thread-2): finished collecting timing info
2022-08-22 11:38:32.807115 (Thread-1): Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:38:32.807457 (Thread-2): Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:38:32.843887 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:38:32.844090 (MainThread): Connection 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
2022-08-22 11:38:32.844271 (MainThread): Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
2022-08-22 11:38:32.844450 (MainThread): Connection 'model.dbt_test.mart' was properly closed.
2022-08-22 11:38:32.844628 (MainThread): Connection 'test.dbt_test.unique_my_first_dbt_model_id.16e066b321' was properly closed.
2022-08-22 11:38:32.851293 (MainThread): 14:38:32 | Done.
2022-08-22 11:38:32.854822 (MainThread): Acquiring new postgres connection "generate_catalog".
2022-08-22 11:38:32.855050 (MainThread): 14:38:32 | Building catalog
2022-08-22 11:38:32.858940 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "dvdrental.information_schema".
2022-08-22 11:38:32.867496 (ThreadPoolExecutor-1_0): Using postgres connection "dvdrental.information_schema".
2022-08-22 11:38:32.867718 (ThreadPoolExecutor-1_0): On dvdrental.information_schema: BEGIN
2022-08-22 11:38:32.867915 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-08-22 11:38:32.884752 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:38:32.885080 (ThreadPoolExecutor-1_0): Using postgres connection "dvdrental.information_schema".
2022-08-22 11:38:32.885293 (ThreadPoolExecutor-1_0): On dvdrental.information_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "dvdrental.information_schema"} */

    
    

    select
        'dvdrental' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dvd_schema_dbt_test__audit') or upper(sch.nspname) = upper('dvd_schema') or upper(sch.nspname) = upper('public') or upper(sch.nspname) = upper('snapshots'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2022-08-22 11:38:32.913173 (ThreadPoolExecutor-1_0): SQL status: SELECT 155 in 0.03 seconds
2022-08-22 11:38:32.933084 (ThreadPoolExecutor-1_0): On dvdrental.information_schema: ROLLBACK
2022-08-22 11:38:32.934189 (ThreadPoolExecutor-1_0): On dvdrental.information_schema: Close
2022-08-22 11:38:32.951572 (MainThread): 14:38:32 | Catalog written to /Users/victorchudnovskiy/PycharmProjects/dbt/dbt_test/target/catalog.json
2022-08-22 11:38:32.951981 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11243f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b34750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124487d0>]}
2022-08-22 11:38:32.952303 (MainThread): Flushing usage events
2022-08-22 11:38:33.559172 (MainThread): Connection 'generate_catalog' was properly closed.
2022-08-22 11:38:33.559916 (MainThread): Connection 'dvdrental.information_schema' was properly closed.
2022-08-22 11:38:45.666517 (MainThread): Running with dbt=0.21.1
2022-08-22 11:38:45.773246 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8001, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='serve', write_json=True)
2022-08-22 11:38:45.775043 (MainThread): Tracking: tracking
2022-08-22 11:38:45.788961 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f533c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f533b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f533c50>]}
2022-08-22 11:38:45.792838 (MainThread): Serving docs at 0.0.0.0:8001
2022-08-22 11:38:45.793194 (MainThread): To access from your browser, navigate to:  http://localhost:8001
2022-08-22 11:38:45.793412 (MainThread): Press Ctrl+C to exit.


2022-08-22 11:44:25.302080 (MainThread): Flushing usage events
2022-08-22 11:44:25.936759 (MainThread): ctrl-c
2022-08-22 11:45:03.541310 (MainThread): Running with dbt=0.21.1
2022-08-22 11:45:03.649251 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['my_first_dbt_model'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 11:45:03.651100 (MainThread): Tracking: tracking
2022-08-22 11:45:03.668180 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d020bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4f3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4f3150>]}
2022-08-22 11:45:03.683357 (MainThread): Partial parsing not enabled
2022-08-22 11:45:03.698333 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:45:03.702694 (MainThread): Parsing macros/relations.sql
2022-08-22 11:45:03.704556 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:45:03.735599 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:45:03.737930 (MainThread): Parsing macros/core.sql
2022-08-22 11:45:03.743026 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:45:03.752436 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:45:03.765649 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:45:03.767894 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:45:03.791748 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:45:03.839790 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:45:03.871461 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:45:03.873826 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:45:03.888326 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:45:03.916302 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:45:03.935575 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:45:03.946875 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:45:03.957320 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:45:03.962525 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:45:03.964482 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:45:03.965772 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:45:03.967865 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:45:03.979735 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:45:03.982137 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:45:03.985341 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:45:03.987426 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:45:04.062809 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:45:04.065134 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:45:04.066683 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:45:04.068551 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:45:04.301374 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:45:04.318180 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:45:04.322540 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:45:04.327266 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:45:04.331666 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:04.336509 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:45:04.352555 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:45:04.375963 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 11:45:04.379102 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:45:04.425289 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:45:04.427429 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:45:04.429526 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:45:04.450002 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49e14a68-ef99-4ee3-8013-d72ff0154115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5a7510>]}
2022-08-22 11:45:04.456598 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:45:04.457198 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49e14a68-ef99-4ee3-8013-d72ff0154115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d589b50>]}
2022-08-22 11:45:04.457522 (MainThread): Found 6 models, 4 tests, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:45:04.458938 (MainThread): 
2022-08-22 11:45:04.459335 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:45:04.460364 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 11:45:04.472590 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 11:45:04.472833 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 11:45:04.473046 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:45:04.549479 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.08 seconds
2022-08-22 11:45:04.551415 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 11:45:04.552977 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:45:04.553521 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:45:04.560839 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:45:04.562330 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:45:04.562601 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:45:04.562846 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:45:04.563073 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 11:45:04.563318 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 11:45:04.582334 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:45:04.582689 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:45:04.582912 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:45:04.583186 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:45:04.583443 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:45:04.583657 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:45:04.603703 (ThreadPoolExecutor-1_1): SQL status: SELECT 1 in 0.02 seconds
2022-08-22 11:45:04.605274 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:45:04.605546 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.02 seconds
2022-08-22 11:45:04.607040 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:45:04.607284 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: Close
2022-08-22 11:45:04.608623 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:45:04.614118 (MainThread): Using postgres connection "master".
2022-08-22 11:45:04.614406 (MainThread): On master: BEGIN
2022-08-22 11:45:04.614631 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:45:04.630211 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:45:04.630546 (MainThread): Using postgres connection "master".
2022-08-22 11:45:04.630793 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:45:04.852401 (MainThread): SQL status: SELECT 38 in 0.22 seconds
2022-08-22 11:45:04.858362 (MainThread): On master: ROLLBACK
2022-08-22 11:45:04.860097 (MainThread): Using postgres connection "master".
2022-08-22 11:45:04.860519 (MainThread): On master: BEGIN
2022-08-22 11:45:04.863300 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 11:45:04.879783 (MainThread): On master: COMMIT
2022-08-22 11:45:04.880915 (MainThread): Using postgres connection "master".
2022-08-22 11:45:04.881612 (MainThread): On master: COMMIT
2022-08-22 11:45:04.883237 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:45:04.883696 (MainThread): On master: Close
2022-08-22 11:45:04.884549 (MainThread): 14:45:04 | Concurrency: 4 threads (target='dev')
2022-08-22 11:45:04.885009 (MainThread): 14:45:04 | 
2022-08-22 11:45:04.889120 (Thread-1): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:45:04.889611 (Thread-1): 14:45:04 | 1 of 1 START table model dvd_schema.my_first_dbt_model............... [RUN]
2022-08-22 11:45:04.890067 (Thread-1): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:04.890328 (Thread-1): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:45:04.893221 (Thread-1): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:45:04.893810 (Thread-1): finished collecting timing info
2022-08-22 11:45:04.930006 (Thread-1): Writing runtime SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:45:04.930743 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:04.930993 (Thread-1): On model.dbt_test.my_first_dbt_model: BEGIN
2022-08-22 11:45:04.931228 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:45:04.947938 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:45:04.948292 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:04.948512 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */


  create  table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-08-22 11:45:04.966878 (Thread-1): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 11:45:04.974530 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:04.974781 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-08-22 11:45:04.976269 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:45:04.978623 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:04.978850 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-08-22 11:45:04.980680 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:45:04.994067 (Thread-1): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:45:04.994351 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:04.994595 (Thread-1): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:45:04.998488 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:45:05.004139 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:05.004394 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_backup" cascade
2022-08-22 11:45:05.017096 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2022-08-22 11:45:05.018574 (Thread-1): finished collecting timing info
2022-08-22 11:45:05.018861 (Thread-1): On model.dbt_test.my_first_dbt_model: Close
2022-08-22 11:45:05.019347 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e14a68-ef99-4ee3-8013-d72ff0154115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd4dfd0>]}
2022-08-22 11:45:05.019772 (Thread-1): 14:45:05 | 1 of 1 OK created table model dvd_schema.my_first_dbt_model.......... [SELECT 2 in 0.13s]
2022-08-22 11:45:05.020035 (Thread-1): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:45:05.100355 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:45:05.100989 (MainThread): Using postgres connection "master".
2022-08-22 11:45:05.101377 (MainThread): On master: BEGIN
2022-08-22 11:45:05.101752 (MainThread): Opening a new connection, currently in state closed
2022-08-22 11:45:05.118996 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:45:05.119367 (MainThread): On master: COMMIT
2022-08-22 11:45:05.119589 (MainThread): Using postgres connection "master".
2022-08-22 11:45:05.119791 (MainThread): On master: COMMIT
2022-08-22 11:45:05.120998 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:45:05.121286 (MainThread): On master: Close
2022-08-22 11:45:05.121743 (MainThread): 14:45:05 | 
2022-08-22 11:45:05.121989 (MainThread): 14:45:05 | Finished running 1 table model in 0.66s.
2022-08-22 11:45:05.122215 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:45:05.122409 (MainThread): Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
2022-08-22 11:45:05.122596 (MainThread): Connection 'list_dvdrental_snapshots' was properly closed.
2022-08-22 11:45:05.129830 (MainThread): 
2022-08-22 11:45:05.130150 (MainThread): Completed successfully
2022-08-22 11:45:05.130406 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-08-22 11:45:05.130710 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd56210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd56110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd34790>]}
2022-08-22 11:45:05.131024 (MainThread): Flushing usage events
2022-08-22 11:45:27.584054 (MainThread): Running with dbt=0.21.1
2022-08-22 11:45:27.676887 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['my_first_dbt_model'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 11:45:27.678450 (MainThread): Tracking: tracking
2022-08-22 11:45:27.690833 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0369d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f529c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f529510>]}
2022-08-22 11:45:27.705621 (MainThread): Partial parsing not enabled
2022-08-22 11:45:27.718119 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:45:27.722397 (MainThread): Parsing macros/relations.sql
2022-08-22 11:45:27.724329 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:45:27.755800 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:45:27.758169 (MainThread): Parsing macros/core.sql
2022-08-22 11:45:27.763325 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:45:27.772853 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:45:27.786245 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:45:27.788512 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:45:27.812694 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:45:27.862165 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:45:27.894755 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:45:27.897162 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:45:27.911863 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:45:27.940914 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:45:27.960793 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:45:27.972229 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:45:27.982958 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:45:27.988177 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:45:27.990174 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:45:27.991500 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:45:27.993599 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:45:28.005688 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:45:28.008166 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:45:28.011410 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:45:28.013512 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:45:28.091354 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:45:28.093662 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:45:28.095245 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:45:28.096999 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:45:28.330684 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:45:28.347279 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:45:28.351589 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:45:28.356441 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:45:28.360992 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:28.366459 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:45:28.383023 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:45:28.404550 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 11:45:28.408280 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:45:28.455229 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:45:28.457416 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:45:28.459511 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:45:28.480243 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc324b97-228b-4536-9218-8a720f7030e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd78390>]}
2022-08-22 11:45:28.487458 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:45:28.488108 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc324b97-228b-4536-9218-8a720f7030e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcd35d0>]}
2022-08-22 11:45:28.488444 (MainThread): Found 6 models, 4 tests, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:45:28.489962 (MainThread): 
2022-08-22 11:45:28.490377 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:45:28.491452 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 11:45:28.503839 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 11:45:28.504142 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 11:45:28.504361 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:45:28.543448 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.04 seconds
2022-08-22 11:45:28.545393 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 11:45:28.546996 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:45:28.553829 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:45:28.554965 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:45:28.556567 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:45:28.556881 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:45:28.557103 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:45:28.557346 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 11:45:28.557581 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 11:45:28.576471 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:45:28.576971 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:45:28.577192 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:45:28.578138 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:45:28.578398 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:45:28.578607 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:45:28.591916 (ThreadPoolExecutor-1_1): SQL status: SELECT 1 in 0.01 seconds
2022-08-22 11:45:28.593435 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:45:28.593698 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.01 seconds
2022-08-22 11:45:28.595189 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:45:28.595418 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: Close
2022-08-22 11:45:28.596517 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:45:28.602071 (MainThread): Using postgres connection "master".
2022-08-22 11:45:28.602372 (MainThread): On master: BEGIN
2022-08-22 11:45:28.602587 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:45:28.618792 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:45:28.619116 (MainThread): Using postgres connection "master".
2022-08-22 11:45:28.619352 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:45:28.824615 (MainThread): SQL status: SELECT 37 in 0.20 seconds
2022-08-22 11:45:28.831637 (MainThread): On master: ROLLBACK
2022-08-22 11:45:28.832996 (MainThread): Using postgres connection "master".
2022-08-22 11:45:28.833433 (MainThread): On master: BEGIN
2022-08-22 11:45:28.835920 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 11:45:28.836347 (MainThread): On master: COMMIT
2022-08-22 11:45:28.836739 (MainThread): Using postgres connection "master".
2022-08-22 11:45:28.837109 (MainThread): On master: COMMIT
2022-08-22 11:45:28.838539 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:45:28.839010 (MainThread): On master: Close
2022-08-22 11:45:28.839822 (MainThread): 14:45:28 | Concurrency: 4 threads (target='dev')
2022-08-22 11:45:28.840268 (MainThread): 14:45:28 | 
2022-08-22 11:45:28.843881 (Thread-1): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:45:28.844391 (Thread-1): 14:45:28 | 1 of 1 START table model dvd_schema.my_first_dbt_model............... [RUN]
2022-08-22 11:45:28.844846 (Thread-1): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:28.845106 (Thread-1): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:45:28.847987 (Thread-1): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:45:28.848567 (Thread-1): finished collecting timing info
2022-08-22 11:45:28.882063 (Thread-1): Writing runtime SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:45:28.882752 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:28.882979 (Thread-1): On model.dbt_test.my_first_dbt_model: BEGIN
2022-08-22 11:45:28.883186 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:45:28.900337 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:45:28.900688 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:28.900910 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */


  create  table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
2022-08-22 11:45:28.916025 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2022-08-22 11:45:28.923683 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:28.923930 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-08-22 11:45:28.925172 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:45:28.927581 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:28.927815 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-08-22 11:45:28.929133 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:45:28.942551 (Thread-1): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:45:28.942799 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:28.943007 (Thread-1): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:45:28.947028 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:45:28.952613 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:45:28.952854 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_backup" cascade
2022-08-22 11:45:28.964557 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2022-08-22 11:45:28.966001 (Thread-1): finished collecting timing info
2022-08-22 11:45:28.966281 (Thread-1): On model.dbt_test.my_first_dbt_model: Close
2022-08-22 11:45:28.966756 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc324b97-228b-4536-9218-8a720f7030e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe123d0>]}
2022-08-22 11:45:28.967184 (Thread-1): 14:45:28 | 1 of 1 OK created table model dvd_schema.my_first_dbt_model.......... [SELECT 1 in 0.12s]
2022-08-22 11:45:28.967434 (Thread-1): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:45:29.049995 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:45:29.050372 (MainThread): Using postgres connection "master".
2022-08-22 11:45:29.050592 (MainThread): On master: BEGIN
2022-08-22 11:45:29.050802 (MainThread): Opening a new connection, currently in state closed
2022-08-22 11:45:29.067611 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:45:29.067988 (MainThread): On master: COMMIT
2022-08-22 11:45:29.068207 (MainThread): Using postgres connection "master".
2022-08-22 11:45:29.068420 (MainThread): On master: COMMIT
2022-08-22 11:45:29.069684 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:45:29.069963 (MainThread): On master: Close
2022-08-22 11:45:29.070404 (MainThread): 14:45:29 | 
2022-08-22 11:45:29.070652 (MainThread): 14:45:29 | Finished running 1 table model in 0.58s.
2022-08-22 11:45:29.070886 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:45:29.071082 (MainThread): Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
2022-08-22 11:45:29.071270 (MainThread): Connection 'list_dvdrental_snapshots' was properly closed.
2022-08-22 11:45:29.077856 (MainThread): 
2022-08-22 11:45:29.078140 (MainThread): Completed successfully
2022-08-22 11:45:29.078372 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-08-22 11:45:29.078664 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0769d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe31110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe31510>]}
2022-08-22 11:45:29.078963 (MainThread): Flushing usage events
2022-08-22 11:46:34.322239 (MainThread): Running with dbt=0.21.1
2022-08-22 11:46:34.414283 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-08-22 11:46:34.415856 (MainThread): Tracking: tracking
2022-08-22 11:46:34.428365 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb852d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f06d990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f06d950>]}
2022-08-22 11:46:34.443194 (MainThread): Partial parsing not enabled
2022-08-22 11:46:34.455340 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:46:34.459559 (MainThread): Parsing macros/relations.sql
2022-08-22 11:46:34.461487 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:46:34.492599 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:46:34.494915 (MainThread): Parsing macros/core.sql
2022-08-22 11:46:34.499902 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:46:34.509332 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:46:34.522520 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:46:34.524718 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:46:34.548431 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:46:34.597439 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:46:34.629414 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:46:34.631802 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:46:34.646329 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:46:34.674905 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:46:34.694501 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:46:34.705834 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:46:34.716288 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:46:34.721441 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:46:34.723379 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:46:34.724632 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:46:34.726716 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:46:34.738543 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:46:34.740931 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:46:34.744104 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:46:34.746166 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:46:34.823323 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:46:34.825554 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:46:34.827076 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:46:34.828807 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:46:35.059199 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:46:35.076042 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:46:35.080308 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:46:35.085035 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:46:35.089381 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:46:35.094241 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:46:35.110042 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:46:35.130527 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 11:46:35.133615 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:46:35.189384 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca6fee34-7b19-4152-94c5-505d2dba2823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1363d0>]}
2022-08-22 11:46:35.195115 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:46:35.195766 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca6fee34-7b19-4152-94c5-505d2dba2823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8398d0>]}
2022-08-22 11:46:35.196093 (MainThread): Found 6 models, 1 test, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:46:35.197645 (MainThread): 
2022-08-22 11:46:35.198054 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:46:35.200171 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:46:35.212548 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:46:35.213025 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:46:35.213256 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:46:35.214859 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:46:35.215103 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-08-22 11:46:35.215318 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:46:35.215812 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 11:46:35.272361 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.06 seconds
2022-08-22 11:46:35.272705 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:46:35.272924 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:46:35.273176 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.06 seconds
2022-08-22 11:46:35.273630 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:46:35.273864 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:46:35.296223 (ThreadPoolExecutor-1_1): SQL status: SELECT 5 in 0.02 seconds
2022-08-22 11:46:35.298391 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:46:35.298646 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.03 seconds
2022-08-22 11:46:35.299903 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:46:35.300142 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: Close
2022-08-22 11:46:35.301219 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: Close
2022-08-22 11:46:35.306689 (MainThread): Using postgres connection "master".
2022-08-22 11:46:35.307004 (MainThread): On master: BEGIN
2022-08-22 11:46:35.307223 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:46:35.324160 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:46:35.324511 (MainThread): Using postgres connection "master".
2022-08-22 11:46:35.324728 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:46:35.535804 (MainThread): SQL status: SELECT 37 in 0.21 seconds
2022-08-22 11:46:35.542383 (MainThread): On master: ROLLBACK
2022-08-22 11:46:35.543935 (MainThread): On master: Close
2022-08-22 11:46:35.544750 (MainThread): 14:46:35 | Concurrency: 4 threads (target='dev')
2022-08-22 11:46:35.545222 (MainThread): 14:46:35 | 
2022-08-22 11:46:35.548421 (Thread-1): Began running node test.dbt_test.my_test
2022-08-22 11:46:35.548791 (Thread-1): 14:46:35 | 1 of 1 START test my_test............................................ [RUN]
2022-08-22 11:46:35.549229 (Thread-1): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 11:46:35.549490 (Thread-1): Compiling test.dbt_test.my_test
2022-08-22 11:46:35.552165 (Thread-1): Writing injected SQL for node "test.dbt_test.my_test"
2022-08-22 11:46:35.552796 (Thread-1): finished collecting timing info
2022-08-22 11:46:35.576348 (Thread-1): Writing runtime SQL for node "test.dbt_test.my_test"
2022-08-22 11:46:35.577193 (Thread-1): Using postgres connection "test.dbt_test.my_test".
2022-08-22 11:46:35.577493 (Thread-1): On test.dbt_test.my_test: BEGIN
2022-08-22 11:46:35.577780 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:46:35.595406 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:46:35.595790 (Thread-1): Using postgres connection "test.dbt_test.my_test".
2022-08-22 11:46:35.596008 (Thread-1): On test.dbt_test.my_test: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.my_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "dvdrental"."dvd_schema"."my_first_dbt_model"
where id is null
      
    ) dbt_internal_test
2022-08-22 11:46:35.600601 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-08-22 11:46:35.603017 (Thread-1): finished collecting timing info
2022-08-22 11:46:35.603303 (Thread-1): On test.dbt_test.my_test: ROLLBACK
2022-08-22 11:46:35.604474 (Thread-1): On test.dbt_test.my_test: Close
2022-08-22 11:46:35.605002 (Thread-1): 14:46:35 | 1 of 1 PASS my_test.................................................. [PASS in 0.06s]
2022-08-22 11:46:35.605276 (Thread-1): Finished running node test.dbt_test.my_test
2022-08-22 11:46:35.653487 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:46:35.653966 (MainThread): 14:46:35 | 
2022-08-22 11:46:35.654216 (MainThread): 14:46:35 | Finished running 1 test in 0.46s.
2022-08-22 11:46:35.654446 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:46:35.654636 (MainThread): Connection 'test.dbt_test.my_test' was properly closed.
2022-08-22 11:46:35.654830 (MainThread): Connection 'list_dvdrental_dvd_schema' was properly closed.
2022-08-22 11:46:35.660307 (MainThread): 
2022-08-22 11:46:35.660573 (MainThread): Completed successfully
2022-08-22 11:46:35.660809 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-08-22 11:46:35.661247 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f118710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f813c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f891110>]}
2022-08-22 11:46:35.661768 (MainThread): Flushing usage events
2022-08-22 11:47:35.266387 (MainThread): Running with dbt=0.21.1
2022-08-22 11:47:35.358409 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-08-22 11:47:35.360339 (MainThread): Tracking: tracking
2022-08-22 11:47:35.373216 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c8d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111783710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c62090>]}
2022-08-22 11:47:35.388158 (MainThread): Partial parsing not enabled
2022-08-22 11:47:35.400353 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:47:35.404496 (MainThread): Parsing macros/relations.sql
2022-08-22 11:47:35.406386 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:47:35.436881 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:47:35.439178 (MainThread): Parsing macros/core.sql
2022-08-22 11:47:35.444145 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:47:35.453499 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:47:35.466544 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:47:35.468800 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:47:35.492499 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:47:35.540525 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:47:35.572204 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:47:35.574541 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:47:35.588996 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:47:35.616909 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:47:35.636145 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:47:35.647396 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:47:35.657812 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:47:35.663002 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:47:35.664929 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:47:35.666184 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:47:35.668244 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:47:35.679984 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:47:35.682394 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:47:35.685625 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:47:35.687688 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:47:35.762828 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:47:35.765054 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:47:35.766578 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:47:35.768377 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:47:36.001196 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:47:36.020697 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:47:36.025506 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:47:36.030184 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:47:36.034523 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:47:36.039484 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:47:36.055332 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:47:36.075827 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 11:47:36.078929 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:47:36.134881 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '702fffe4-d7a2-4984-9655-244d1754b17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d55290>]}
2022-08-22 11:47:36.140607 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:47:36.141274 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '702fffe4-d7a2-4984-9655-244d1754b17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112459b90>]}
2022-08-22 11:47:36.141608 (MainThread): Found 6 models, 1 test, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:47:36.143152 (MainThread): 
2022-08-22 11:47:36.143555 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:47:36.145672 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:47:36.146315 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:47:36.158605 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:47:36.160092 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:47:36.160341 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:47:36.160552 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:47:36.160759 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-08-22 11:47:36.160958 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 11:47:36.214321 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.05 seconds
2022-08-22 11:47:36.214655 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:47:36.214875 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:47:36.215267 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.05 seconds
2022-08-22 11:47:36.215600 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:47:36.215830 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:47:36.234716 (ThreadPoolExecutor-1_1): SQL status: SELECT 5 in 0.02 seconds
2022-08-22 11:47:36.236857 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:47:36.237116 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.02 seconds
2022-08-22 11:47:36.238444 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:47:36.238681 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: Close
2022-08-22 11:47:36.240031 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: Close
2022-08-22 11:47:36.245383 (MainThread): Using postgres connection "master".
2022-08-22 11:47:36.245679 (MainThread): On master: BEGIN
2022-08-22 11:47:36.245889 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:47:36.263565 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:47:36.263914 (MainThread): Using postgres connection "master".
2022-08-22 11:47:36.264129 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:47:36.469691 (MainThread): SQL status: SELECT 37 in 0.21 seconds
2022-08-22 11:47:36.476745 (MainThread): On master: ROLLBACK
2022-08-22 11:47:36.478227 (MainThread): On master: Close
2022-08-22 11:47:36.478747 (MainThread): 14:47:36 | Concurrency: 4 threads (target='dev')
2022-08-22 11:47:36.479011 (MainThread): 14:47:36 | 
2022-08-22 11:47:36.481805 (Thread-1): Began running node test.dbt_test.my_test
2022-08-22 11:47:36.482208 (Thread-1): 14:47:36 | 1 of 1 START test my_test............................................ [RUN]
2022-08-22 11:47:36.482703 (Thread-1): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 11:47:36.482985 (Thread-1): Compiling test.dbt_test.my_test
2022-08-22 11:47:36.485677 (Thread-1): Writing injected SQL for node "test.dbt_test.my_test"
2022-08-22 11:47:36.486273 (Thread-1): finished collecting timing info
2022-08-22 11:47:36.508471 (Thread-1): Writing runtime SQL for node "test.dbt_test.my_test"
2022-08-22 11:47:36.509305 (Thread-1): Using postgres connection "test.dbt_test.my_test".
2022-08-22 11:47:36.509610 (Thread-1): On test.dbt_test.my_test: BEGIN
2022-08-22 11:47:36.509895 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:47:36.530896 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:47:36.531263 (Thread-1): Using postgres connection "test.dbt_test.my_test".
2022-08-22 11:47:36.531484 (Thread-1): On test.dbt_test.my_test: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.my_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "dvdrental"."dvd_schema"."my_first_dbt_model"
where id is null
      
    ) dbt_internal_test
2022-08-22 11:47:36.534843 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-08-22 11:47:36.537259 (Thread-1): finished collecting timing info
2022-08-22 11:47:36.537548 (Thread-1): On test.dbt_test.my_test: ROLLBACK
2022-08-22 11:47:36.538642 (Thread-1): On test.dbt_test.my_test: Close
2022-08-22 11:47:36.539136 (Thread-1): 14:47:36 | 1 of 1 PASS my_test.................................................. [PASS in 0.06s]
2022-08-22 11:47:36.539392 (Thread-1): Finished running node test.dbt_test.my_test
2022-08-22 11:47:36.582557 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:47:36.583062 (MainThread): 14:47:36 | 
2022-08-22 11:47:36.583312 (MainThread): 14:47:36 | Finished running 1 test in 0.44s.
2022-08-22 11:47:36.583714 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:47:36.584064 (MainThread): Connection 'test.dbt_test.my_test' was properly closed.
2022-08-22 11:47:36.584451 (MainThread): Connection 'list_dvdrental_dvd_schema' was properly closed.
2022-08-22 11:47:36.591747 (MainThread): 
2022-08-22 11:47:36.592014 (MainThread): Completed successfully
2022-08-22 11:47:36.592258 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-08-22 11:47:36.592550 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d61c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d40910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d37510>]}
2022-08-22 11:47:36.592858 (MainThread): Flushing usage events
2022-08-22 11:48:55.444940 (MainThread): Running with dbt=0.21.1
2022-08-22 11:48:55.537039 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['example'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 11:48:55.538665 (MainThread): Tracking: tracking
2022-08-22 11:48:55.551281 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117deb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11178c150>]}
2022-08-22 11:48:55.565899 (MainThread): Partial parsing not enabled
2022-08-22 11:48:55.578199 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:48:55.582440 (MainThread): Parsing macros/relations.sql
2022-08-22 11:48:55.584362 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:48:55.615641 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:48:55.617975 (MainThread): Parsing macros/core.sql
2022-08-22 11:48:55.622991 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:48:55.632437 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:48:55.645679 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:48:55.647901 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:48:55.671832 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:48:55.722266 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:48:55.754564 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:48:55.756918 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:48:55.771597 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:48:55.800554 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:48:55.820367 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:48:55.831990 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:48:55.842699 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:48:55.847873 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:48:55.849816 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:48:55.851081 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:48:55.853161 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:48:55.865074 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:48:55.867476 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:48:55.870703 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:48:55.872770 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:48:55.950508 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:48:55.952741 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:48:55.954264 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:48:55.956019 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:48:56.186163 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:48:56.202835 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:48:56.207166 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:48:56.211830 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:48:56.216210 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:48:56.221029 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:48:56.236855 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:48:56.257298 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 11:48:56.260346 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:48:56.316124 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e5e3cb-7f2f-46ee-9721-0a333f9a6404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d9bed0>]}
2022-08-22 11:48:56.321800 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:48:56.322414 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e5e3cb-7f2f-46ee-9721-0a333f9a6404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112480e90>]}
2022-08-22 11:48:56.322740 (MainThread): Found 6 models, 1 test, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:48:56.324185 (MainThread): 
2022-08-22 11:48:56.324584 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:48:56.325627 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 11:48:56.338509 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 11:48:56.338838 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 11:48:56.339053 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 11:48:56.394858 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.06 seconds
2022-08-22 11:48:56.396800 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 11:48:56.398382 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:48:56.405620 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:48:56.406114 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:48:56.406341 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:48:56.407920 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:48:56.408179 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 11:48:56.408432 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:48:56.408823 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 11:48:56.426788 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:48:56.427132 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:48:56.427350 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:48:56.428556 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:48:56.428817 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:48:56.429029 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:48:56.444478 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.02 seconds
2022-08-22 11:48:56.444959 (ThreadPoolExecutor-1_1): SQL status: SELECT 5 in 0.02 seconds
2022-08-22 11:48:56.446446 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:48:56.447763 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:48:56.449161 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: Close
2022-08-22 11:48:56.449876 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: Close
2022-08-22 11:48:56.455279 (MainThread): Using postgres connection "master".
2022-08-22 11:48:56.455574 (MainThread): On master: BEGIN
2022-08-22 11:48:56.455789 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:48:56.471947 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:48:56.472278 (MainThread): Using postgres connection "master".
2022-08-22 11:48:56.472516 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:48:56.678507 (MainThread): SQL status: SELECT 37 in 0.21 seconds
2022-08-22 11:48:56.685507 (MainThread): On master: ROLLBACK
2022-08-22 11:48:56.687092 (MainThread): Using postgres connection "master".
2022-08-22 11:48:56.687469 (MainThread): On master: BEGIN
2022-08-22 11:48:56.689578 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 11:48:56.689809 (MainThread): On master: COMMIT
2022-08-22 11:48:56.690022 (MainThread): Using postgres connection "master".
2022-08-22 11:48:56.690221 (MainThread): On master: COMMIT
2022-08-22 11:48:56.691339 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:48:56.691633 (MainThread): On master: Close
2022-08-22 11:48:56.692088 (MainThread): 14:48:56 | Concurrency: 4 threads (target='dev')
2022-08-22 11:48:56.692343 (MainThread): 14:48:56 | 
2022-08-22 11:48:56.694916 (Thread-1): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 11:48:56.695385 (Thread-1): 14:48:56 | 1 of 2 START table model dvd_schema.my_first_dbt_model............... [RUN]
2022-08-22 11:48:56.695857 (Thread-1): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:48:56.696115 (Thread-1): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 11:48:56.699370 (Thread-1): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:48:56.699997 (Thread-1): finished collecting timing info
2022-08-22 11:48:56.733013 (Thread-1): Writing runtime SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 11:48:56.733729 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:48:56.733976 (Thread-1): On model.dbt_test.my_first_dbt_model: BEGIN
2022-08-22 11:48:56.734209 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:48:56.752008 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:48:56.752362 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:48:56.752577 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */


  create  table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2022-08-22 11:48:56.768642 (Thread-1): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 11:48:56.776090 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:48:56.776334 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-08-22 11:48:56.777636 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:48:56.780030 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:48:56.780260 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-08-22 11:48:56.781679 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:48:56.794962 (Thread-1): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:48:56.795214 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:48:56.795427 (Thread-1): On model.dbt_test.my_first_dbt_model: COMMIT
2022-08-22 11:48:56.800022 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:48:56.805771 (Thread-1): Using postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:48:56.806018 (Thread-1): On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dvdrental"."dvd_schema"."my_first_dbt_model__dbt_backup" cascade
2022-08-22 11:48:56.817951 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2022-08-22 11:48:56.819338 (Thread-1): finished collecting timing info
2022-08-22 11:48:56.819623 (Thread-1): On model.dbt_test.my_first_dbt_model: Close
2022-08-22 11:48:56.820083 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e5e3cb-7f2f-46ee-9721-0a333f9a6404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11252b310>]}
2022-08-22 11:48:56.820507 (Thread-1): 14:48:56 | 1 of 2 OK created table model dvd_schema.my_first_dbt_model.......... [SELECT 2 in 0.12s]
2022-08-22 11:48:56.820764 (Thread-1): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 11:48:56.821187 (Thread-3): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 11:48:56.821495 (Thread-3): 14:48:56 | 2 of 2 START view model dvd_schema.my_second_dbt_model............... [RUN]
2022-08-22 11:48:56.821874 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:48:56.822091 (Thread-3): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 11:48:56.824946 (Thread-3): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:48:56.825507 (Thread-3): finished collecting timing info
2022-08-22 11:48:56.848243 (Thread-3): Writing runtime SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 11:48:56.848898 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:48:56.849117 (Thread-3): On model.dbt_test.my_second_dbt_model: BEGIN
2022-08-22 11:48:56.849325 (Thread-3): Opening a new connection, currently in state init
2022-08-22 11:48:56.866491 (Thread-3): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:48:56.866846 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:48:56.867064 (Thread-3): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dvdrental"."dvd_schema"."my_first_dbt_model"
where id = 1
  );

2022-08-22 11:48:56.877895 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-08-22 11:48:56.881734 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:48:56.881967 (Thread-3): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-08-22 11:48:56.883305 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 11:48:56.884537 (Thread-3): On model.dbt_test.my_second_dbt_model: COMMIT
2022-08-22 11:48:56.884765 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:48:56.884964 (Thread-3): On model.dbt_test.my_second_dbt_model: COMMIT
2022-08-22 11:48:56.889231 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:48:56.890941 (Thread-3): Using postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:48:56.891177 (Thread-3): On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dvdrental"."dvd_schema"."my_second_dbt_model__dbt_backup" cascade
2022-08-22 11:48:56.892417 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-08-22 11:48:56.893608 (Thread-3): finished collecting timing info
2022-08-22 11:48:56.893873 (Thread-3): On model.dbt_test.my_second_dbt_model: Close
2022-08-22 11:48:56.894318 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e5e3cb-7f2f-46ee-9721-0a333f9a6404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125ce750>]}
2022-08-22 11:48:56.894727 (Thread-3): 14:48:56 | 2 of 2 OK created view model dvd_schema.my_second_dbt_model.......... [CREATE VIEW in 0.07s]
2022-08-22 11:48:56.894968 (Thread-3): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 11:48:56.897537 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:48:56.897811 (MainThread): Using postgres connection "master".
2022-08-22 11:48:56.898005 (MainThread): On master: BEGIN
2022-08-22 11:48:56.898199 (MainThread): Opening a new connection, currently in state closed
2022-08-22 11:48:56.914512 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:48:56.914880 (MainThread): On master: COMMIT
2022-08-22 11:48:56.915090 (MainThread): Using postgres connection "master".
2022-08-22 11:48:56.915289 (MainThread): On master: COMMIT
2022-08-22 11:48:56.916367 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 11:48:56.916595 (MainThread): On master: Close
2022-08-22 11:48:56.917031 (MainThread): 14:48:56 | 
2022-08-22 11:48:56.917271 (MainThread): 14:48:56 | Finished running 1 table model, 1 view model in 0.59s.
2022-08-22 11:48:56.917492 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:48:56.917681 (MainThread): Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
2022-08-22 11:48:56.917865 (MainThread): Connection 'list_dvdrental_dvd_schema' was properly closed.
2022-08-22 11:48:56.918047 (MainThread): Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
2022-08-22 11:48:56.923543 (MainThread): 
2022-08-22 11:48:56.923828 (MainThread): Completed successfully
2022-08-22 11:48:56.924066 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-08-22 11:48:56.924371 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125c4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125be850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125be1d0>]}
2022-08-22 11:48:56.924669 (MainThread): Flushing usage events
2022-08-22 11:49:38.396503 (MainThread): Running with dbt=0.21.1
2022-08-22 11:49:38.491345 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-08-22 11:49:38.492894 (MainThread): Tracking: tracking
2022-08-22 11:49:38.506550 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec81e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1ac990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1acc10>]}
2022-08-22 11:49:38.521679 (MainThread): Partial parsing not enabled
2022-08-22 11:49:38.536610 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:49:38.540925 (MainThread): Parsing macros/relations.sql
2022-08-22 11:49:38.542777 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:49:38.572963 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:49:38.575237 (MainThread): Parsing macros/core.sql
2022-08-22 11:49:38.580152 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:49:38.589381 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:49:38.602282 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:49:38.604462 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:49:38.627775 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:49:38.675252 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:49:38.706480 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:49:38.708794 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:49:38.723068 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:49:38.750794 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:49:38.769807 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:49:38.780925 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:49:38.791183 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:49:38.796286 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:49:38.798215 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:49:38.799465 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:49:38.801502 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:49:38.813025 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:49:38.815385 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:49:38.818538 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:49:38.820569 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:49:38.894796 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:49:38.896988 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:49:38.898499 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:49:38.900227 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:49:39.127936 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:49:39.144446 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:49:39.148671 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:49:39.153333 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:49:39.157710 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:49:39.162545 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:49:39.178197 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:49:39.198507 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 11:49:39.201544 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:49:39.256856 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65c6151c-6bc5-4191-b44c-5e3d7ca57ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f280150>]}
2022-08-22 11:49:39.262456 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:49:39.263069 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65c6151c-6bc5-4191-b44c-5e3d7ca57ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f974090>]}
2022-08-22 11:49:39.263391 (MainThread): Found 6 models, 1 test, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:49:39.264948 (MainThread): 
2022-08-22 11:49:39.265342 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:49:39.267517 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:49:39.279876 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:49:39.280304 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:49:39.280514 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:49:39.282157 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:49:39.282389 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-08-22 11:49:39.282602 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:49:39.283114 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 11:49:39.425617 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.14 seconds
2022-08-22 11:49:39.425964 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:49:39.426181 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:49:39.432451 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.15 seconds
2022-08-22 11:49:39.432760 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:49:39.432988 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:49:39.441500 (ThreadPoolExecutor-1_1): SQL status: SELECT 1 in 0.02 seconds
2022-08-22 11:49:39.443610 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:49:39.445033 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: Close
2022-08-22 11:49:39.446832 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.01 seconds
2022-08-22 11:49:39.448303 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:49:39.450858 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:49:39.456353 (MainThread): Using postgres connection "master".
2022-08-22 11:49:39.456647 (MainThread): On master: BEGIN
2022-08-22 11:49:39.456861 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:49:39.485702 (MainThread): SQL status: BEGIN in 0.03 seconds
2022-08-22 11:49:39.486066 (MainThread): Using postgres connection "master".
2022-08-22 11:49:39.486295 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:49:39.701377 (MainThread): SQL status: SELECT 38 in 0.21 seconds
2022-08-22 11:49:39.708879 (MainThread): On master: ROLLBACK
2022-08-22 11:49:39.710339 (MainThread): On master: Close
2022-08-22 11:49:39.711205 (MainThread): 14:49:39 | Concurrency: 4 threads (target='dev')
2022-08-22 11:49:39.711655 (MainThread): 14:49:39 | 
2022-08-22 11:49:39.715655 (Thread-1): Began running node test.dbt_test.my_test
2022-08-22 11:49:39.716018 (Thread-1): 14:49:39 | 1 of 1 START test my_test............................................ [RUN]
2022-08-22 11:49:39.716469 (Thread-1): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 11:49:39.716739 (Thread-1): Compiling test.dbt_test.my_test
2022-08-22 11:49:39.719406 (Thread-1): Writing injected SQL for node "test.dbt_test.my_test"
2022-08-22 11:49:39.720010 (Thread-1): finished collecting timing info
2022-08-22 11:49:39.743306 (Thread-1): Writing runtime SQL for node "test.dbt_test.my_test"
2022-08-22 11:49:39.744139 (Thread-1): Using postgres connection "test.dbt_test.my_test".
2022-08-22 11:49:39.744439 (Thread-1): On test.dbt_test.my_test: BEGIN
2022-08-22 11:49:39.744730 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:49:39.763577 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:49:39.763940 (Thread-1): Using postgres connection "test.dbt_test.my_test".
2022-08-22 11:49:39.764160 (Thread-1): On test.dbt_test.my_test: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.my_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "dvdrental"."dvd_schema"."my_first_dbt_model"
where id is null
      
    ) dbt_internal_test
2022-08-22 11:49:39.767114 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-08-22 11:49:39.769517 (Thread-1): finished collecting timing info
2022-08-22 11:49:39.769807 (Thread-1): On test.dbt_test.my_test: ROLLBACK
2022-08-22 11:49:39.770918 (Thread-1): On test.dbt_test.my_test: Close
2022-08-22 11:49:39.771433 (Thread-1): 14:49:39 | 1 of 1 FAIL 1 my_test................................................ [FAIL 1 in 0.06s]
2022-08-22 11:49:39.771699 (Thread-1): Finished running node test.dbt_test.my_test
2022-08-22 11:49:39.816286 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:49:39.816767 (MainThread): 14:49:39 | 
2022-08-22 11:49:39.817008 (MainThread): 14:49:39 | Finished running 1 test in 0.55s.
2022-08-22 11:49:39.817230 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:49:39.817424 (MainThread): Connection 'test.dbt_test.my_test' was properly closed.
2022-08-22 11:49:39.817609 (MainThread): Connection 'list_dvdrental_snapshots' was properly closed.
2022-08-22 11:49:39.823007 (MainThread): 
2022-08-22 11:49:39.823345 (MainThread): Completed with 1 error and 0 warnings:
2022-08-22 11:49:39.823571 (MainThread): 
2022-08-22 11:49:39.823793 (MainThread): Failure in test my_test (tests/my_test.sql)
2022-08-22 11:49:39.824003 (MainThread):   Got 1 result, configured to fail if != 0
2022-08-22 11:49:39.824217 (MainThread): 
2022-08-22 11:49:39.824424 (MainThread):   compiled SQL at target/compiled/dbt_test/tests/my_test.sql
2022-08-22 11:49:39.824639 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-08-22 11:49:39.824922 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f25b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f967f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f97b690>]}
2022-08-22 11:49:39.825218 (MainThread): Flushing usage events
2022-08-22 11:55:42.894687 (MainThread): Running with dbt=0.21.1
2022-08-22 11:55:42.997159 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-08-22 11:55:42.998724 (MainThread): Tracking: tracking
2022-08-22 11:55:43.012109 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdbc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29ef50>]}
2022-08-22 11:55:43.027177 (MainThread): Partial parsing not enabled
2022-08-22 11:55:43.042044 (MainThread): Parsing macros/catalog.sql
2022-08-22 11:55:43.046726 (MainThread): Parsing macros/relations.sql
2022-08-22 11:55:43.048751 (MainThread): Parsing macros/adapters.sql
2022-08-22 11:55:43.082663 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 11:55:43.085063 (MainThread): Parsing macros/core.sql
2022-08-22 11:55:43.090186 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 11:55:43.099970 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 11:55:43.113955 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 11:55:43.116265 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 11:55:43.140932 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 11:55:43.201857 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 11:55:43.239476 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 11:55:43.242079 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 11:55:43.258128 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 11:55:43.290290 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 11:55:43.312021 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 11:55:43.325629 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 11:55:43.337968 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 11:55:43.343368 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 11:55:43.345405 (MainThread): Parsing macros/etc/query.sql
2022-08-22 11:55:43.346694 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 11:55:43.348878 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 11:55:43.361609 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 11:55:43.364147 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 11:55:43.367406 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 11:55:43.369753 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 11:55:43.458155 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 11:55:43.460564 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 11:55:43.462130 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 11:55:43.463911 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 11:55:43.694385 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 11:55:43.711092 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 11:55:43.715327 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 11:55:43.719998 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 11:55:43.724311 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 11:55:43.729150 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 11:55:43.744915 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 11:55:43.765257 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 11:55:43.768285 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:55:43.813498 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:55:43.815593 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:55:43.817669 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:55:43.819885 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 11:55:43.840663 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0385f628-8840-47ac-8719-1a00d97db932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c314950>]}
2022-08-22 11:55:43.846944 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 11:55:43.847647 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0385f628-8840-47ac-8719-1a00d97db932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da95ad0>]}
2022-08-22 11:55:43.847978 (MainThread): Found 6 models, 5 tests, 1 snapshot, 0 analyses, 162 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 11:55:43.849991 (MainThread): 
2022-08-22 11:55:43.850409 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:55:43.851853 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:55:43.859088 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 11:55:43.865082 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:55:43.866691 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:55:43.866978 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 11:55:43.867196 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: BEGIN
2022-08-22 11:55:43.867400 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-08-22 11:55:43.867604 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 11:55:43.926437 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.06 seconds
2022-08-22 11:55:43.926792 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.06 seconds
2022-08-22 11:55:43.927015 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 11:55:43.927242 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 11:55:43.927449 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 11:55:43.927654 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 11:55:43.952775 (ThreadPoolExecutor-1_1): SQL status: SELECT 1 in 0.02 seconds
2022-08-22 11:55:43.954731 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 11:55:43.954979 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.03 seconds
2022-08-22 11:55:43.956381 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 11:55:43.956611 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: Close
2022-08-22 11:55:43.957862 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: Close
2022-08-22 11:55:43.963729 (MainThread): Using postgres connection "master".
2022-08-22 11:55:43.964007 (MainThread): On master: BEGIN
2022-08-22 11:55:43.964210 (MainThread): Opening a new connection, currently in state init
2022-08-22 11:55:43.981155 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:55:43.981490 (MainThread): Using postgres connection "master".
2022-08-22 11:55:43.981701 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 11:55:44.202191 (MainThread): SQL status: SELECT 38 in 0.22 seconds
2022-08-22 11:55:44.209784 (MainThread): On master: ROLLBACK
2022-08-22 11:55:44.211154 (MainThread): On master: Close
2022-08-22 11:55:44.211773 (MainThread): 14:55:44 | Concurrency: 4 threads (target='dev')
2022-08-22 11:55:44.212047 (MainThread): 14:55:44 | 
2022-08-22 11:55:44.215557 (Thread-1): Began running node test.dbt_test.my_test
2022-08-22 11:55:44.215852 (Thread-2): Began running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:55:44.216218 (Thread-3): Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:55:44.216502 (Thread-1): 14:55:44 | 1 of 5 START test my_test............................................ [RUN]
2022-08-22 11:55:44.216742 (Thread-4): Began running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:55:44.217005 (Thread-2): 14:55:44 | 2 of 5 START test not_null_my_first_dbt_model_id..................... [RUN]
2022-08-22 11:55:44.217224 (Thread-3): 14:55:44 | 3 of 5 START test not_null_my_second_dbt_model_id.................... [RUN]
2022-08-22 11:55:44.217713 (Thread-1): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 11:55:44.217948 (Thread-4): 14:55:44 | 4 of 5 START test unique_my_first_dbt_model_id....................... [RUN]
2022-08-22 11:55:44.218398 (Thread-2): Acquiring new postgres connection "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710".
2022-08-22 11:55:44.218762 (Thread-3): Acquiring new postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 11:55:44.219012 (Thread-1): Compiling test.dbt_test.my_test
2022-08-22 11:55:44.219609 (Thread-4): Acquiring new postgres connection "test.dbt_test.unique_my_first_dbt_model_id.16e066b321".
2022-08-22 11:55:44.219824 (Thread-2): Compiling test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:55:44.220036 (Thread-3): Compiling test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:55:44.222767 (Thread-1): Writing injected SQL for node "test.dbt_test.my_test"
2022-08-22 11:55:44.223012 (Thread-4): Compiling test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:55:44.235138 (Thread-2): Writing injected SQL for node "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710"
2022-08-22 11:55:44.238818 (Thread-3): Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 11:55:44.246993 (Thread-4): Writing injected SQL for node "test.dbt_test.unique_my_first_dbt_model_id.16e066b321"
2022-08-22 11:55:44.247544 (Thread-1): finished collecting timing info
2022-08-22 11:55:44.248064 (Thread-3): finished collecting timing info
2022-08-22 11:55:44.254363 (Thread-2): finished collecting timing info
2022-08-22 11:55:44.267185 (Thread-4): finished collecting timing info
2022-08-22 11:55:44.277135 (Thread-1): Writing runtime SQL for node "test.dbt_test.my_test"
2022-08-22 11:55:44.285323 (Thread-2): Writing runtime SQL for node "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710"
2022-08-22 11:55:44.287696 (Thread-3): Writing runtime SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 11:55:44.289370 (Thread-4): Writing runtime SQL for node "test.dbt_test.unique_my_first_dbt_model_id.16e066b321"
2022-08-22 11:55:44.290226 (Thread-1): Using postgres connection "test.dbt_test.my_test".
2022-08-22 11:55:44.290488 (Thread-1): On test.dbt_test.my_test: BEGIN
2022-08-22 11:55:44.290750 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:55:44.291267 (Thread-4): Using postgres connection "test.dbt_test.unique_my_first_dbt_model_id.16e066b321".
2022-08-22 11:55:44.291538 (Thread-2): Using postgres connection "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710".
2022-08-22 11:55:44.291782 (Thread-3): Using postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 11:55:44.291986 (Thread-4): On test.dbt_test.unique_my_first_dbt_model_id.16e066b321: BEGIN
2022-08-22 11:55:44.292204 (Thread-2): On test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
2022-08-22 11:55:44.292469 (Thread-3): On test.dbt_test.not_null_my_second_dbt_model_id.151b76d778: BEGIN
2022-08-22 11:55:44.292709 (Thread-4): Opening a new connection, currently in state init
2022-08-22 11:55:44.292961 (Thread-2): Opening a new connection, currently in state closed
2022-08-22 11:55:44.293209 (Thread-3): Opening a new connection, currently in state init
2022-08-22 11:55:44.309944 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:55:44.310332 (Thread-1): Using postgres connection "test.dbt_test.my_test".
2022-08-22 11:55:44.310546 (Thread-1): On test.dbt_test.my_test: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.my_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "dvdrental"."dvd_schema"."my_first_dbt_model"
where id is null
      
    ) dbt_internal_test
2022-08-22 11:55:44.313426 (Thread-4): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:55:44.313774 (Thread-4): Using postgres connection "test.dbt_test.unique_my_first_dbt_model_id.16e066b321".
2022-08-22 11:55:44.313987 (Thread-4): On test.dbt_test.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dvdrental"."dvd_schema"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2022-08-22 11:55:44.317034 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2022-08-22 11:55:44.319753 (Thread-1): finished collecting timing info
2022-08-22 11:55:44.320222 (Thread-1): On test.dbt_test.my_test: ROLLBACK
2022-08-22 11:55:44.321113 (Thread-4): SQL status: SELECT 1 in 0.01 seconds
2022-08-22 11:55:44.322566 (Thread-4): finished collecting timing info
2022-08-22 11:55:44.322813 (Thread-1): On test.dbt_test.my_test: Close
2022-08-22 11:55:44.323129 (Thread-4): On test.dbt_test.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
2022-08-22 11:55:44.323342 (Thread-3): SQL status: BEGIN in 0.03 seconds
2022-08-22 11:55:44.323879 (Thread-1): 14:55:44 | 1 of 5 FAIL 1 my_test................................................ [FAIL 1 in 0.11s]
2022-08-22 11:55:44.324192 (Thread-3): Using postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 11:55:44.324405 (Thread-2): SQL status: BEGIN in 0.03 seconds
2022-08-22 11:55:44.324700 (Thread-3): On test.dbt_test.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dvdrental"."dvd_schema"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
2022-08-22 11:55:44.324939 (Thread-1): Finished running node test.dbt_test.my_test
2022-08-22 11:55:44.325192 (Thread-2): Using postgres connection "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710".
2022-08-22 11:55:44.325516 (Thread-1): Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:55:44.325762 (Thread-2): On test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dvdrental"."dvd_schema"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
2022-08-22 11:55:44.326084 (Thread-1): 14:55:44 | 5 of 5 START test unique_my_second_dbt_model_id...................... [RUN]
2022-08-22 11:55:44.326260 (Thread-4): On test.dbt_test.unique_my_first_dbt_model_id.16e066b321: Close
2022-08-22 11:55:44.326750 (Thread-1): Acquiring new postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 11:55:44.327049 (Thread-1): Compiling test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:55:44.330928 (Thread-1): Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 11:55:44.331273 (Thread-2): SQL status: SELECT 1 in 0.00 seconds
2022-08-22 11:55:44.331541 (Thread-3): SQL status: SELECT 1 in 0.01 seconds
2022-08-22 11:55:44.332302 (Thread-4): 14:55:44 | 4 of 5 PASS unique_my_first_dbt_model_id............................. [PASS in 0.11s]
2022-08-22 11:55:44.333914 (Thread-2): finished collecting timing info
2022-08-22 11:55:44.335525 (Thread-3): finished collecting timing info
2022-08-22 11:55:44.335967 (Thread-2): On test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
2022-08-22 11:55:44.336175 (Thread-1): finished collecting timing info
2022-08-22 11:55:44.336437 (Thread-4): Finished running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
2022-08-22 11:55:44.336692 (Thread-3): On test.dbt_test.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
2022-08-22 11:55:44.338687 (Thread-1): Writing runtime SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 11:55:44.339147 (Thread-2): On test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710: Close
2022-08-22 11:55:44.339683 (Thread-2): 14:55:44 | 2 of 5 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 0.12s]
2022-08-22 11:55:44.339970 (Thread-2): Finished running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
2022-08-22 11:55:44.340360 (Thread-1): Using postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 11:55:44.340599 (Thread-1): On test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
2022-08-22 11:55:44.340821 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 11:55:44.341176 (Thread-3): On test.dbt_test.not_null_my_second_dbt_model_id.151b76d778: Close
2022-08-22 11:55:44.341573 (Thread-3): 14:55:44 | 3 of 5 PASS not_null_my_second_dbt_model_id.......................... [PASS in 0.12s]
2022-08-22 11:55:44.341798 (Thread-3): Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 11:55:44.358161 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 11:55:44.358512 (Thread-1): Using postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 11:55:44.358725 (Thread-1): On test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dvdrental"."dvd_schema"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2022-08-22 11:55:44.362363 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-08-22 11:55:44.364047 (Thread-1): finished collecting timing info
2022-08-22 11:55:44.364330 (Thread-1): On test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
2022-08-22 11:55:44.365379 (Thread-1): On test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493: Close
2022-08-22 11:55:44.365859 (Thread-1): 14:55:44 | 5 of 5 PASS unique_my_second_dbt_model_id............................ [PASS in 0.04s]
2022-08-22 11:55:44.366116 (Thread-1): Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 11:55:44.416249 (MainThread): Acquiring new postgres connection "master".
2022-08-22 11:55:44.416723 (MainThread): 14:55:44 | 
2022-08-22 11:55:44.416959 (MainThread): 14:55:44 | Finished running 5 tests in 0.57s.
2022-08-22 11:55:44.417175 (MainThread): Connection 'master' was properly closed.
2022-08-22 11:55:44.417360 (MainThread): Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
2022-08-22 11:55:44.417542 (MainThread): Connection 'test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
2022-08-22 11:55:44.417725 (MainThread): Connection 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
2022-08-22 11:55:44.417907 (MainThread): Connection 'test.dbt_test.unique_my_first_dbt_model_id.16e066b321' was properly closed.
2022-08-22 11:55:44.423769 (MainThread): 
2022-08-22 11:55:44.424030 (MainThread): Completed with 2 errors and 0 warnings:
2022-08-22 11:55:44.424246 (MainThread): 
2022-08-22 11:55:44.424457 (MainThread): Failure in test my_test (tests/my_test.sql)
2022-08-22 11:55:44.424660 (MainThread):   Got 1 result, configured to fail if != 0
2022-08-22 11:55:44.424862 (MainThread): 
2022-08-22 11:55:44.425062 (MainThread):   compiled SQL at target/compiled/dbt_test/tests/my_test.sql
2022-08-22 11:55:44.425264 (MainThread): 
2022-08-22 11:55:44.425474 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2022-08-22 11:55:44.425673 (MainThread):   Got 1 result, configured to fail if != 0
2022-08-22 11:55:44.425874 (MainThread): 
2022-08-22 11:55:44.426078 (MainThread):   compiled SQL at target/compiled/dbt_test/models/example/schema.yml/schema_test/not_null_my_first_dbt_model_id.sql
2022-08-22 11:55:44.426299 (MainThread): 
Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
2022-08-22 11:55:44.426577 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdc51d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cda7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbc2790>]}
2022-08-22 11:55:44.426870 (MainThread): Flushing usage events
2022-08-22 12:15:28.272919 (MainThread): Running with dbt=0.21.1
2022-08-22 12:15:28.375588 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-08-22 12:15:28.377392 (MainThread): Tracking: tracking
2022-08-22 12:15:28.391908 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f22b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f236950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed4eb10>]}
2022-08-22 12:15:28.406702 (MainThread): Partial parsing not enabled
2022-08-22 12:15:28.422614 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:15:28.423731 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:15:28.427717 (MainThread): Parsing macros/relations.sql
2022-08-22 12:15:28.429603 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:15:28.459948 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:15:28.462235 (MainThread): Parsing macros/core.sql
2022-08-22 12:15:28.467218 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:15:28.476724 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:15:28.489859 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:15:28.492095 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:15:28.515720 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:15:28.563788 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:15:28.595515 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:15:28.597874 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:15:28.612245 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:15:28.640274 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:15:28.659598 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:15:28.670731 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:15:28.681112 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:15:28.686279 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:15:28.688241 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:15:28.689517 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:15:28.691587 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:15:28.703331 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:15:28.705726 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:15:28.708934 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:15:28.711010 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:15:28.786063 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:15:28.788288 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:15:28.789823 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:15:28.791594 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:15:29.021718 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:15:29.038383 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:15:29.042647 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:15:29.047344 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:15:29.051675 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:15:29.057259 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9c0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9c0e90>]}
2022-08-22 12:15:29.057639 (MainThread): Flushing usage events
2022-08-22 12:15:29.661133 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:15:29.662217 (MainThread): Encountered an error:
2022-08-22 12:15:29.663064 (MainThread): Compilation Error in model macro_use (models/staging/macro_use.sql)
  unexpected '}'
    line 2
      {{} macro my_macro("last_update") }}
2022-08-22 12:15:29.671396 (MainThread): Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 517, in catch_jinja
    yield
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: unexpected '}'
  line 2
    {{} macro my_macro("last_update") }}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 309, in load
    parser_types
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 416, in parse_project
    parser.parse_file(block)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 405, in parse_node
    self.render_update(node, config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/models.py", line 94, in render_update
    super().render_update(node, config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 380, in render_update
    context = self.render_with_context(node, config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 272, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 596, in get_rendered
    native=native,
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/Cellar/python@3.7/3.7.13_3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 520, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model macro_use (models/staging/macro_use.sql)
  unexpected '}'
    line 2
      {{} macro my_macro("last_update") }}

2022-08-22 12:15:53.054757 (MainThread): Running with dbt=0.21.1
2022-08-22 12:15:53.146894 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-08-22 12:15:53.148416 (MainThread): Tracking: tracking
2022-08-22 12:15:53.161083 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5a9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0af350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0af750>]}
2022-08-22 12:15:53.175411 (MainThread): Partial parsing not enabled
2022-08-22 12:15:53.188114 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:15:53.189138 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:15:53.192954 (MainThread): Parsing macros/relations.sql
2022-08-22 12:15:53.194815 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:15:53.225228 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:15:53.227540 (MainThread): Parsing macros/core.sql
2022-08-22 12:15:53.232520 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:15:53.241820 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:15:53.254900 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:15:53.257128 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:15:53.280703 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:15:53.328574 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:15:53.360198 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:15:53.362524 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:15:53.376899 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:15:53.404947 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:15:53.424214 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:15:53.435427 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:15:53.445786 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:15:53.450962 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:15:53.452896 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:15:53.454154 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:15:53.456217 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:15:53.468004 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:15:53.470409 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:15:53.473587 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:15:53.475660 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:15:53.550511 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:15:53.552776 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:15:53.554376 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:15:53.556110 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:15:53.787082 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:15:53.803719 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:15:53.807954 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:15:53.812638 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:15:53.816989 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:15:53.819787 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d63fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd43d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd43e90>]}
2022-08-22 12:15:53.820133 (MainThread): Flushing usage events
2022-08-22 12:15:54.420145 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:15:54.420891 (MainThread): Encountered an error:
2022-08-22 12:15:54.421411 (MainThread): Compilation Error in model macro_use (models/staging/macro_use.sql)
  expected token 'end of print statement', got 'my_macro'
    line 2
      {{macro my_macro("last_update")}}
2022-08-22 12:15:54.425515 (MainThread): Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 517, in catch_jinja
    yield
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of print statement', got 'my_macro'
  line 2
    {{macro my_macro("last_update")}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 309, in load
    parser_types
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 416, in parse_project
    parser.parse_file(block)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 405, in parse_node
    self.render_update(node, config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/models.py", line 94, in render_update
    super().render_update(node, config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 380, in render_update
    context = self.render_with_context(node, config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 272, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 596, in get_rendered
    native=native,
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/Cellar/python@3.7/3.7.13_3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 520, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model macro_use (models/staging/macro_use.sql)
  expected token 'end of print statement', got 'my_macro'
    line 2
      {{macro my_macro("last_update")}}

2022-08-22 12:18:09.453618 (MainThread): Running with dbt=0.21.1
2022-08-22 12:18:09.544613 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-08-22 12:18:09.546286 (MainThread): Tracking: tracking
2022-08-22 12:18:09.558287 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111be0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bca790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcadd0>]}
2022-08-22 12:18:09.572709 (MainThread): Partial parsing not enabled
2022-08-22 12:18:09.585345 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:18:09.586360 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:18:09.590242 (MainThread): Parsing macros/relations.sql
2022-08-22 12:18:09.592137 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:18:09.622477 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:18:09.624773 (MainThread): Parsing macros/core.sql
2022-08-22 12:18:09.629798 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:18:09.639078 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:18:09.652203 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:18:09.654434 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:18:09.678059 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:18:09.725907 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:18:09.757425 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:18:09.759769 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:18:09.774112 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:18:09.801969 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:18:09.821165 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:18:09.832318 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:18:09.842689 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:18:09.847855 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:18:09.849806 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:18:09.851084 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:18:09.853171 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:18:09.864864 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:18:09.867262 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:18:09.870456 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:18:09.872515 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:18:09.947126 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:18:09.949339 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:18:09.950866 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:18:09.952609 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:18:10.183511 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:18:10.200174 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:18:10.204403 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:18:10.209047 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:18:10.213377 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:18:10.216319 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112369c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112369e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112369690>]}
2022-08-22 12:18:10.216683 (MainThread): Flushing usage events
2022-08-22 12:18:10.776363 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:18:10.777600 (MainThread): Encountered an error:
2022-08-22 12:18:10.778382 (MainThread): Compilation Error in model macro_use (models/staging/macro_use.sql)
  expected token 'end of print statement', got 'my_macro'
    line 2
      {{macro my_macro("last_update")}}
2022-08-22 12:18:10.783652 (MainThread): Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 517, in catch_jinja
    yield
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of print statement', got 'my_macro'
  line 2
    {{macro my_macro("last_update")}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 309, in load
    parser_types
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 416, in parse_project
    parser.parse_file(block)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 405, in parse_node
    self.render_update(node, config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/models.py", line 94, in render_update
    super().render_update(node, config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 380, in render_update
    context = self.render_with_context(node, config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 272, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 596, in get_rendered
    native=native,
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/Cellar/python@3.7/3.7.13_3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 520, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model macro_use (models/staging/macro_use.sql)
  expected token 'end of print statement', got 'my_macro'
    line 2
      {{macro my_macro("last_update")}}

2022-08-22 12:18:24.724300 (MainThread): Running with dbt=0.21.1
2022-08-22 12:18:24.814701 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='snapshot', write_json=True)
2022-08-22 12:18:24.816342 (MainThread): Tracking: tracking
2022-08-22 12:18:24.828304 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116d0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116d0f10>]}
2022-08-22 12:18:24.842693 (MainThread): Partial parsing not enabled
2022-08-22 12:18:24.855465 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:18:24.856465 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:18:24.860221 (MainThread): Parsing macros/relations.sql
2022-08-22 12:18:24.862075 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:18:24.892504 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:18:24.894805 (MainThread): Parsing macros/core.sql
2022-08-22 12:18:24.899839 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:18:24.909153 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:18:24.922250 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:18:24.924487 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:18:24.948191 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:18:24.995943 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:18:25.027604 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:18:25.029963 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:18:25.044330 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:18:25.072690 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:18:25.091961 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:18:25.103116 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:18:25.113492 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:18:25.118689 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:18:25.120643 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:18:25.121899 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:18:25.124021 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:18:25.135747 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:18:25.138162 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:18:25.141439 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:18:25.143515 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:18:25.218363 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:18:25.220541 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:18:25.222064 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:18:25.223801 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:18:25.457364 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:18:25.474178 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:18:25.478461 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:18:25.483130 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:18:25.487545 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:18:25.490413 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11177cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e7cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e7ce90>]}
2022-08-22 12:18:25.490755 (MainThread): Flushing usage events
2022-08-22 12:18:26.086096 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:18:26.087424 (MainThread): Encountered an error:
2022-08-22 12:18:26.088294 (MainThread): Compilation Error in model macro_use (models/staging/macro_use.sql)
  expected token 'end of print statement', got 'my_macro'
    line 2
      {{macro my_macro("last_update")}}
2022-08-22 12:18:26.092364 (MainThread): Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 517, in catch_jinja
    yield
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of print statement', got 'my_macro'
  line 2
    {{macro my_macro("last_update")}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 309, in load
    parser_types
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 416, in parse_project
    parser.parse_file(block)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 405, in parse_node
    self.render_update(node, config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/models.py", line 94, in render_update
    super().render_update(node, config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 380, in render_update
    context = self.render_with_context(node, config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 272, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 596, in get_rendered
    native=native,
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/Cellar/python@3.7/3.7.13_3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 520, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model macro_use (models/staging/macro_use.sql)
  expected token 'end of print statement', got 'my_macro'
    line 2
      {{macro my_macro("last_update")}}

2022-08-22 12:19:35.752444 (MainThread): Running with dbt=0.21.1
2022-08-22 12:19:35.855045 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-08-22 12:19:35.856518 (MainThread): Tracking: tracking
2022-08-22 12:19:35.870361 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f089710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb95d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb95b10>]}
2022-08-22 12:19:35.885527 (MainThread): Partial parsing not enabled
2022-08-22 12:19:35.900960 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:19:35.902031 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:19:35.906125 (MainThread): Parsing macros/relations.sql
2022-08-22 12:19:35.907997 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:19:35.939116 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:19:35.941430 (MainThread): Parsing macros/core.sql
2022-08-22 12:19:35.946410 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:19:35.955711 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:19:35.969222 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:19:35.971507 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:19:35.995314 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:19:36.047660 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:19:36.079805 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:19:36.082143 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:19:36.096548 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:19:36.125015 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:19:36.144620 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:19:36.155853 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:19:36.166373 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:19:36.171550 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:19:36.173510 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:19:36.174772 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:19:36.176838 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:19:36.188691 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:19:36.191140 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:19:36.194315 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:19:36.196368 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:19:36.273221 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:19:36.275470 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:19:36.277015 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:19:36.278749 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:19:36.507857 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:19:36.524520 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:19:36.528715 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:19:36.533409 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:19:36.537734 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:19:36.542643 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:19:36.558424 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 12:19:36.567914 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 12:19:36.572385 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb90590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f02a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f119fd0>]}
2022-08-22 12:19:36.572725 (MainThread): Flushing usage events
2022-08-22 12:19:37.219626 (MainThread): Connection 'snapshot.dbt_test.actor_snapshot' was properly closed.
2022-08-22 12:19:37.220898 (MainThread): Encountered an error:
2022-08-22 12:19:37.221406 (MainThread): Compilation Error
  dbt found two resources with the name "actor_snapshot". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("actor_snapshot") is used. To fix this,
  change the name of one of these resources:
  - snapshot.dbt_test.actor_snapshot (snapshots/actor_snapshop_scd.sql)
  - snapshot.dbt_test.actor_snapshot (snapshots/actor_snapshop_check.sql)
2022-08-22 12:19:37.228158 (MainThread): Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 309, in load
    parser_types
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 416, in parse_project
    parser.parse_file(block)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/snapshots.py", line 80, in parse_file
    self.parse_node(block)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 407, in parse_node
    self.add_result_node(block, result)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 389, in add_result_node
    self.manifest.add_node(block.file, node)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/contracts/graph/manifest.py", line 1057, in add_node
    self.add_node_nofile(node)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/contracts/graph/manifest.py", line 1053, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/contracts/graph/manifest.py", line 1184, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/exceptions.py", line 808, in raise_duplicate_resource_name
    node_2.unique_id, node_2.original_file_path))
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/exceptions.py", line 447, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "actor_snapshot". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("actor_snapshot") is used. To fix this,
  change the name of one of these resources:
  - snapshot.dbt_test.actor_snapshot (snapshots/actor_snapshop_scd.sql)
  - snapshot.dbt_test.actor_snapshot (snapshots/actor_snapshop_check.sql)

2022-08-22 12:20:11.028333 (MainThread): Running with dbt=0.21.1
2022-08-22 12:20:11.119748 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='snapshot', write_json=True)
2022-08-22 12:20:11.121441 (MainThread): Tracking: tracking
2022-08-22 12:20:11.133360 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcaeb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcb7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcb7b90>]}
2022-08-22 12:20:11.147277 (MainThread): Partial parsing not enabled
2022-08-22 12:20:11.159805 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:20:11.160887 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:20:11.164638 (MainThread): Parsing macros/relations.sql
2022-08-22 12:20:11.166502 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:20:11.197156 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:20:11.199529 (MainThread): Parsing macros/core.sql
2022-08-22 12:20:11.204534 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:20:11.213795 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:20:11.226914 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:20:11.229156 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:20:11.252620 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:20:11.301500 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:20:11.336184 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:20:11.338539 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:20:11.352919 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:20:11.380727 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:20:11.399952 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:20:11.411052 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:20:11.421804 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:20:11.426954 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:20:11.428905 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:20:11.430177 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:20:11.432228 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:20:11.443942 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:20:11.446316 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:20:11.449555 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:20:11.451600 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:20:11.526291 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:20:11.528488 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:20:11.530019 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:20:11.531744 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:20:11.763093 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:20:11.779891 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:20:11.784149 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:20:11.788861 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:20:11.793219 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:20:11.798131 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:20:11.814023 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 12:20:11.823477 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot".
2022-08-22 12:20:11.828002 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc4f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc7f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110454950>]}
2022-08-22 12:20:11.828347 (MainThread): Flushing usage events
2022-08-22 12:20:12.356834 (MainThread): Connection 'snapshot.dbt_test.actor_snapshot' was properly closed.
2022-08-22 12:20:12.357865 (MainThread): Encountered an error:
2022-08-22 12:20:12.358805 (MainThread): Compilation Error
  dbt found two resources with the name "actor_snapshot". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("actor_snapshot") is used. To fix this,
  change the name of one of these resources:
  - snapshot.dbt_test.actor_snapshot (snapshots/actor_snapshop_scd.sql)
  - snapshot.dbt_test.actor_snapshot (snapshots/actor_snapshop_check.sql)
2022-08-22 12:20:12.362721 (MainThread): Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 309, in load
    parser_types
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/manifest.py", line 416, in parse_project
    parser.parse_file(block)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/snapshots.py", line 80, in parse_file
    self.parse_node(block)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 407, in parse_node
    self.add_result_node(block, result)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/parser/base.py", line 389, in add_result_node
    self.manifest.add_node(block.file, node)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/contracts/graph/manifest.py", line 1057, in add_node
    self.add_node_nofile(node)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/contracts/graph/manifest.py", line 1053, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/contracts/graph/manifest.py", line 1184, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/exceptions.py", line 808, in raise_duplicate_resource_name
    node_2.unique_id, node_2.original_file_path))
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/exceptions.py", line 447, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "actor_snapshot". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("actor_snapshot") is used. To fix this,
  change the name of one of these resources:
  - snapshot.dbt_test.actor_snapshot (snapshots/actor_snapshop_scd.sql)
  - snapshot.dbt_test.actor_snapshot (snapshots/actor_snapshop_check.sql)

2022-08-22 12:21:11.940579 (MainThread): Running with dbt=0.21.1
2022-08-22 12:21:12.031779 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='snapshot', write_json=True)
2022-08-22 12:21:12.033402 (MainThread): Tracking: tracking
2022-08-22 12:21:12.045973 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecfea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f213a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f213490>]}
2022-08-22 12:21:12.059960 (MainThread): Partial parsing not enabled
2022-08-22 12:21:12.072489 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:21:12.073556 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:21:12.077375 (MainThread): Parsing macros/relations.sql
2022-08-22 12:21:12.079273 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:21:12.110227 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:21:12.112514 (MainThread): Parsing macros/core.sql
2022-08-22 12:21:12.117486 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:21:12.126810 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:21:12.140072 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:21:12.142331 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:21:12.166019 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:21:12.214884 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:21:12.246788 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:21:12.249126 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:21:12.263541 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:21:12.292028 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:21:12.311613 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:21:12.322871 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:21:12.333325 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:21:12.338481 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:21:12.340421 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:21:12.341674 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:21:12.343742 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:21:12.355567 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:21:12.357962 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:21:12.361141 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:21:12.363190 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:21:12.440074 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:21:12.442280 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:21:12.443794 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:21:12.445523 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:21:12.676381 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:21:12.693061 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:21:12.697305 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:21:12.702012 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:21:12.706345 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:21:12.711312 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:21:12.727223 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:21:12.736614 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:21:12.753202 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:21:12.773606 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:21:12.819306 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:21:12.821459 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:21:12.842734 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bb10b07-e1e4-4014-a021-6b9ea188c79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa0e410>]}
2022-08-22 12:21:12.848719 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:21:12.849339 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bb10b07-e1e4-4014-a021-6b9ea188c79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa94790>]}
2022-08-22 12:21:12.849663 (MainThread): Found 6 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:21:12.851481 (MainThread): 
2022-08-22 12:21:12.851887 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:21:12.852879 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 12:21:12.864825 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 12:21:12.865057 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 12:21:12.865265 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 12:21:12.931580 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.07 seconds
2022-08-22 12:21:12.933667 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 12:21:12.935351 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:21:12.942015 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:21:12.943911 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:21:12.945723 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:21:12.945966 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:21:12.946197 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:21:12.946426 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 12:21:12.946636 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 12:21:12.965288 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:21:12.965731 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:21:12.965985 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:21:12.968041 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:21:12.968305 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:21:12.968518 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:21:12.990302 (ThreadPoolExecutor-1_1): SQL status: SELECT 6 in 0.02 seconds
2022-08-22 12:21:12.990636 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.02 seconds
2022-08-22 12:21:12.992230 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:21:12.993433 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:21:12.994796 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: Close
2022-08-22 12:21:12.995030 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: Close
2022-08-22 12:21:13.000881 (MainThread): Using postgres connection "master".
2022-08-22 12:21:13.001175 (MainThread): On master: BEGIN
2022-08-22 12:21:13.001394 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:21:13.017976 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:21:13.018313 (MainThread): Using postgres connection "master".
2022-08-22 12:21:13.018525 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:21:13.241411 (MainThread): SQL status: SELECT 38 in 0.22 seconds
2022-08-22 12:21:13.248991 (MainThread): On master: ROLLBACK
2022-08-22 12:21:13.250511 (MainThread): Using postgres connection "master".
2022-08-22 12:21:13.250883 (MainThread): On master: BEGIN
2022-08-22 12:21:13.252940 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 12:21:13.253457 (MainThread): On master: COMMIT
2022-08-22 12:21:13.253850 (MainThread): Using postgres connection "master".
2022-08-22 12:21:13.254219 (MainThread): On master: COMMIT
2022-08-22 12:21:13.255512 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:21:13.255920 (MainThread): On master: Close
2022-08-22 12:21:13.256683 (MainThread): 15:21:13 | Concurrency: 4 threads (target='dev')
2022-08-22 12:21:13.257128 (MainThread): 15:21:13 | 
2022-08-22 12:21:13.261477 (Thread-1): Began running node snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:21:13.261845 (Thread-2): Began running node snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:21:13.262278 (Thread-1): 15:21:13 | 1 of 2 START snapshot snapshots.actor_snapshot_check................. [RUN]
2022-08-22 12:21:13.262641 (Thread-2): 15:21:13 | 2 of 2 START snapshot snapshots.actor_snapshot_scd................... [RUN]
2022-08-22 12:21:13.263127 (Thread-1): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:21:13.263504 (Thread-2): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:21:13.263757 (Thread-1): Compiling snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:21:13.264013 (Thread-2): Compiling snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:21:13.268282 (Thread-1): finished collecting timing info
2022-08-22 12:21:13.271707 (Thread-2): finished collecting timing info
2022-08-22 12:21:13.329343 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:21:13.335915 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

    select count(*) from pg_namespace where nspname = 'snapshots'
  
2022-08-22 12:21:13.340804 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:21:13.341019 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 12:21:13.341233 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_scd"} */

    select count(*) from pg_namespace where nspname = 'snapshots'
  
2022-08-22 12:21:13.341605 (Thread-2): Opening a new connection, currently in state closed
2022-08-22 12:21:13.365112 (Thread-2): SQL status: SELECT 1 in 0.02 seconds
2022-08-22 12:21:13.374748 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2022-08-22 12:21:13.427880 (Thread-2): Writing runtime SQL for node "snapshot.dbt_test.actor_snapshot_scd"
2022-08-22 12:21:13.435427 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:21:13.435697 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

    select now()::timestamp without time zone as snapshot_start
  
2022-08-22 12:21:13.436135 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:21:13.436353 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: BEGIN
2022-08-22 12:21:13.437599 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-08-22 12:21:13.437866 (Thread-2): SQL status: BEGIN in 0.00 seconds
2022-08-22 12:21:13.442977 (Thread-1): Writing runtime SQL for node "snapshot.dbt_test.actor_snapshot_check"
2022-08-22 12:21:13.443243 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:21:13.443570 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_scd"} */

      

  create  table "dvdrental"."snapshots"."actor_snapshot_scd"
  as (
    

    select *,
        md5(coalesce(cast(actor_id as varchar ), '')
         || '|' || coalesce(cast(last_update as varchar ), '')
        ) as dbt_scd_id,
        last_update as dbt_updated_at,
        last_update as dbt_valid_from,
        nullif(last_update, last_update) as dbt_valid_to
    from (
        



select * from "dvdrental"."public"."actor"

    ) sbq


  );
  
2022-08-22 12:21:13.443963 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:21:13.444175 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: BEGIN
2022-08-22 12:21:13.445538 (Thread-1): SQL status: BEGIN in 0.00 seconds
2022-08-22 12:21:13.445801 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:21:13.446015 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

      

  create  table "dvdrental"."snapshots"."actor_snapshot_check"
  as (
    

    select *,
        md5(coalesce(cast(actor_id as varchar ), '')
         || '|' || coalesce(cast(last_update as varchar ), '')
        ) as dbt_scd_id,
        last_update as dbt_updated_at,
        last_update as dbt_valid_from,
        nullif(last_update, last_update) as dbt_valid_to
    from (
        



select * from "dvdrental"."public"."actor"

    ) sbq


  );
  
2022-08-22 12:21:13.512956 (Thread-2): SQL status: SELECT 200 in 0.07 seconds
2022-08-22 12:21:13.526816 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: COMMIT
2022-08-22 12:21:13.527113 (Thread-1): SQL status: SELECT 200 in 0.08 seconds
2022-08-22 12:21:13.527350 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:21:13.528772 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: COMMIT
2022-08-22 12:21:13.529005 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: COMMIT
2022-08-22 12:21:13.529221 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:21:13.529508 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: COMMIT
2022-08-22 12:21:13.536100 (Thread-2): SQL status: COMMIT in 0.01 seconds
2022-08-22 12:21:13.536758 (Thread-2): finished collecting timing info
2022-08-22 12:21:13.537030 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: Close
2022-08-22 12:21:13.537535 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb10b07-e1e4-4014-a021-6b9ea188c79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa37ad0>]}
2022-08-22 12:21:13.537988 (Thread-2): 15:21:13 | 2 of 2 OK snapshotted snapshots.actor_snapshot_scd................... [SELECT 200 in 0.27s]
2022-08-22 12:21:13.538237 (Thread-2): Finished running node snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:21:13.538655 (Thread-1): SQL status: COMMIT in 0.01 seconds
2022-08-22 12:21:13.539229 (Thread-1): finished collecting timing info
2022-08-22 12:21:13.539499 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: Close
2022-08-22 12:21:13.539932 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb10b07-e1e4-4014-a021-6b9ea188c79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb35610>]}
2022-08-22 12:21:13.540344 (Thread-1): 15:21:13 | 1 of 2 OK snapshotted snapshots.actor_snapshot_check................. [SELECT 200 in 0.28s]
2022-08-22 12:21:13.540583 (Thread-1): Finished running node snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:21:13.568206 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:21:13.568566 (MainThread): Using postgres connection "master".
2022-08-22 12:21:13.568776 (MainThread): On master: BEGIN
2022-08-22 12:21:13.568973 (MainThread): Opening a new connection, currently in state closed
2022-08-22 12:21:13.587006 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:21:13.587376 (MainThread): On master: COMMIT
2022-08-22 12:21:13.587594 (MainThread): Using postgres connection "master".
2022-08-22 12:21:13.587806 (MainThread): On master: COMMIT
2022-08-22 12:21:13.588877 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:21:13.589161 (MainThread): On master: Close
2022-08-22 12:21:13.589628 (MainThread): 15:21:13 | 
2022-08-22 12:21:13.589873 (MainThread): 15:21:13 | Finished running 2 snapshots in 0.74s.
2022-08-22 12:21:13.590096 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:21:13.590285 (MainThread): Connection 'snapshot.dbt_test.actor_snapshot_check' was properly closed.
2022-08-22 12:21:13.590470 (MainThread): Connection 'snapshot.dbt_test.actor_snapshot_scd' was properly closed.
2022-08-22 12:21:13.596230 (MainThread): 
2022-08-22 12:21:13.596521 (MainThread): Completed successfully
2022-08-22 12:21:13.596763 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-08-22 12:21:13.597054 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa37ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa10e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa10410>]}
2022-08-22 12:21:13.597352 (MainThread): Flushing usage events
2022-08-22 12:21:23.299828 (MainThread): Running with dbt=0.21.1
2022-08-22 12:21:23.392138 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-08-22 12:21:23.393752 (MainThread): Tracking: tracking
2022-08-22 12:21:23.406454 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109a4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c5990>]}
2022-08-22 12:21:23.421155 (MainThread): Partial parsing not enabled
2022-08-22 12:21:23.433767 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:21:23.434836 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:21:23.438614 (MainThread): Parsing macros/relations.sql
2022-08-22 12:21:23.440468 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:21:23.470666 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:21:23.472934 (MainThread): Parsing macros/core.sql
2022-08-22 12:21:23.477898 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:21:23.487122 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:21:23.500181 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:21:23.502397 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:21:23.525825 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:21:23.573511 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:21:23.604919 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:21:23.607249 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:21:23.621569 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:21:23.649302 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:21:23.668777 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:21:23.679938 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:21:23.690289 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:21:23.695436 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:21:23.697380 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:21:23.698657 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:21:23.700716 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:21:23.712352 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:21:23.714733 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:21:23.717924 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:21:23.719996 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:21:23.794314 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:21:23.796545 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:21:23.798075 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:21:23.799807 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:21:24.030593 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:21:24.047273 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:21:24.051577 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:21:24.056346 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:21:24.060712 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:21:24.065649 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:21:24.081718 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:21:24.091344 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:21:24.108264 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:21:24.111322 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:21:24.156761 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:21:24.158888 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:21:24.179597 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccde9682-269b-400e-ae81-46491dd76ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116e4f50>]}
2022-08-22 12:21:24.185430 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:21:24.186032 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccde9682-269b-400e-ae81-46491dd76ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116345d0>]}
2022-08-22 12:21:24.186356 (MainThread): Found 6 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:21:24.188231 (MainThread): 
2022-08-22 12:21:24.188652 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:21:24.190130 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:21:24.197094 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:21:24.203158 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:21:24.204941 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:21:24.205208 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:21:24.205426 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:21:24.205632 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-08-22 12:21:24.205849 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 12:21:24.241427 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.04 seconds
2022-08-22 12:21:24.241778 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:21:24.242001 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:21:24.242227 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.04 seconds
2022-08-22 12:21:24.242552 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:21:24.242822 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:21:24.260586 (ThreadPoolExecutor-1_1): SQL status: SELECT 6 in 0.02 seconds
2022-08-22 12:21:24.262794 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:21:24.263495 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.02 seconds
2022-08-22 12:21:24.264880 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:21:24.265155 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: Close
2022-08-22 12:21:24.266518 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: Close
2022-08-22 12:21:24.272277 (MainThread): Using postgres connection "master".
2022-08-22 12:21:24.272560 (MainThread): On master: BEGIN
2022-08-22 12:21:24.272776 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:21:24.288476 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:21:24.288813 (MainThread): Using postgres connection "master".
2022-08-22 12:21:24.289036 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:21:24.522841 (MainThread): SQL status: SELECT 38 in 0.23 seconds
2022-08-22 12:21:24.530262 (MainThread): On master: ROLLBACK
2022-08-22 12:21:24.531665 (MainThread): On master: Close
2022-08-22 12:21:24.532267 (MainThread): 15:21:24 | Concurrency: 4 threads (target='dev')
2022-08-22 12:21:24.532539 (MainThread): 15:21:24 | 
2022-08-22 12:21:24.534903 (Thread-1): Began running node test.dbt_test.my_test
2022-08-22 12:21:24.535240 (Thread-2): Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:21:24.535545 (Thread-3): Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:21:24.535832 (Thread-1): 15:21:24 | 1 of 3 START test my_test............................................ [RUN]
2022-08-22 12:21:24.536154 (Thread-2): 15:21:24 | 2 of 3 START test not_null_my_second_dbt_model_id.................... [RUN]
2022-08-22 12:21:24.536413 (Thread-3): 15:21:24 | 3 of 3 START test unique_my_second_dbt_model_id...................... [RUN]
2022-08-22 12:21:24.536898 (Thread-1): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:21:24.537383 (Thread-2): Acquiring new postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 12:21:24.537860 (Thread-3): Acquiring new postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 12:21:24.538143 (Thread-1): Compiling test.dbt_test.my_test
2022-08-22 12:21:24.538417 (Thread-2): Compiling test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:21:24.538662 (Thread-3): Compiling test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:21:24.541463 (Thread-1): Writing injected SQL for node "test.dbt_test.my_test"
2022-08-22 12:21:24.553486 (Thread-2): Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 12:21:24.562864 (Thread-3): Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 12:21:24.563772 (Thread-1): finished collecting timing info
2022-08-22 12:21:24.570460 (Thread-2): finished collecting timing info
2022-08-22 12:21:24.596459 (Thread-3): finished collecting timing info
2022-08-22 12:21:24.601551 (Thread-1): Writing runtime SQL for node "test.dbt_test.my_test"
2022-08-22 12:21:24.602175 (Thread-2): Writing runtime SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 12:21:24.605041 (Thread-3): Writing runtime SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 12:21:24.605802 (Thread-1): Using postgres connection "test.dbt_test.my_test".
2022-08-22 12:21:24.606081 (Thread-2): Using postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 12:21:24.606304 (Thread-1): On test.dbt_test.my_test: BEGIN
2022-08-22 12:21:24.606556 (Thread-3): Using postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 12:21:24.606757 (Thread-2): On test.dbt_test.not_null_my_second_dbt_model_id.151b76d778: BEGIN
2022-08-22 12:21:24.606990 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 12:21:24.607195 (Thread-3): On test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
2022-08-22 12:21:24.607417 (Thread-2): Opening a new connection, currently in state closed
2022-08-22 12:21:24.607756 (Thread-3): Opening a new connection, currently in state init
2022-08-22 12:21:24.627059 (Thread-3): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:21:24.627425 (Thread-3): Using postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 12:21:24.627654 (Thread-3): On test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dvdrental"."dvd_schema"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2022-08-22 12:21:24.627949 (Thread-2): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:21:24.628223 (Thread-2): Using postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 12:21:24.628439 (Thread-2): On test.dbt_test.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dvdrental"."dvd_schema"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
2022-08-22 12:21:24.629755 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:21:24.630010 (Thread-1): Using postgres connection "test.dbt_test.my_test".
2022-08-22 12:21:24.630213 (Thread-1): On test.dbt_test.my_test: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.my_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "dvdrental"."dvd_schema"."my_first_dbt_model"
where id is null
      
    ) dbt_internal_test
2022-08-22 12:21:24.631453 (Thread-3): SQL status: SELECT 1 in 0.00 seconds
2022-08-22 12:21:24.633921 (Thread-3): finished collecting timing info
2022-08-22 12:21:24.634205 (Thread-2): SQL status: SELECT 1 in 0.01 seconds
2022-08-22 12:21:24.634447 (Thread-3): On test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
2022-08-22 12:21:24.634639 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-08-22 12:21:24.636062 (Thread-2): finished collecting timing info
2022-08-22 12:21:24.637551 (Thread-1): finished collecting timing info
2022-08-22 12:21:24.637838 (Thread-3): On test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493: Close
2022-08-22 12:21:24.638056 (Thread-2): On test.dbt_test.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
2022-08-22 12:21:24.638285 (Thread-1): On test.dbt_test.my_test: ROLLBACK
2022-08-22 12:21:24.638756 (Thread-3): 15:21:24 | 3 of 3 PASS unique_my_second_dbt_model_id............................ [PASS in 0.10s]
2022-08-22 12:21:24.639141 (Thread-3): Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:21:24.640070 (Thread-2): On test.dbt_test.not_null_my_second_dbt_model_id.151b76d778: Close
2022-08-22 12:21:24.640568 (Thread-2): 15:21:24 | 2 of 3 PASS not_null_my_second_dbt_model_id.......................... [PASS in 0.10s]
2022-08-22 12:21:24.640784 (Thread-1): On test.dbt_test.my_test: Close
2022-08-22 12:21:24.641033 (Thread-2): Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:21:24.641539 (Thread-1): 15:21:24 | 1 of 3 FAIL 1 my_test................................................ [FAIL 1 in 0.10s]
2022-08-22 12:21:24.641929 (Thread-1): Finished running node test.dbt_test.my_test
2022-08-22 12:21:24.739989 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:21:24.740631 (MainThread): 15:21:24 | 
2022-08-22 12:21:24.740963 (MainThread): 15:21:24 | Finished running 3 tests in 0.55s.
2022-08-22 12:21:24.741260 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:21:24.741510 (MainThread): Connection 'test.dbt_test.my_test' was properly closed.
2022-08-22 12:21:24.741754 (MainThread): Connection 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
2022-08-22 12:21:24.742011 (MainThread): Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
2022-08-22 12:21:24.747642 (MainThread): 
2022-08-22 12:21:24.747952 (MainThread): Completed with 1 error and 0 warnings:
2022-08-22 12:21:24.748212 (MainThread): 
2022-08-22 12:21:24.748468 (MainThread): Failure in test my_test (tests/my_test.sql)
2022-08-22 12:21:24.748710 (MainThread):   Got 1 result, configured to fail if != 0
2022-08-22 12:21:24.748946 (MainThread): 
2022-08-22 12:21:24.749188 (MainThread):   compiled SQL at target/compiled/dbt_test/tests/my_test.sql
2022-08-22 12:21:24.749443 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-08-22 12:21:24.749784 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117bff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b41d0>]}
2022-08-22 12:21:24.750124 (MainThread): Flushing usage events
2022-08-22 12:23:55.647795 (MainThread): Running with dbt=0.21.1
2022-08-22 12:23:55.738753 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='snapshot', write_json=True)
2022-08-22 12:23:55.740311 (MainThread): Tracking: tracking
2022-08-22 12:23:55.752210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce88450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce84210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce84f10>]}
2022-08-22 12:23:55.766336 (MainThread): Partial parsing not enabled
2022-08-22 12:23:55.778741 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:23:55.779780 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:23:55.783655 (MainThread): Parsing macros/relations.sql
2022-08-22 12:23:55.785607 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:23:55.816470 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:23:55.818795 (MainThread): Parsing macros/core.sql
2022-08-22 12:23:55.823809 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:23:55.833195 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:23:55.846418 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:23:55.848678 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:23:55.872453 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:23:55.922796 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:23:55.954890 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:23:55.957240 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:23:55.971879 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:23:56.000638 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:23:56.020285 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:23:56.031859 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:23:56.042636 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:23:56.047813 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:23:56.049756 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:23:56.051011 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:23:56.053081 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:23:56.064877 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:23:56.067277 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:23:56.070464 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:23:56.072522 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:23:56.149233 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:23:56.151451 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:23:56.152990 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:23:56.154730 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:23:56.386258 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:23:56.403003 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:23:56.410278 (MainThread): 1699: statically parsed staging/mart.sql
2022-08-22 12:23:56.418143 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:23:56.421967 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'b7981979-bfed-4601-af88-0202e9c87cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6245d0>]}
2022-08-22 12:23:56.423366 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:23:56.427732 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:23:56.432176 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:23:56.448233 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:56.457749 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:56.474405 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:23:56.477511 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:23:56.523444 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:23:56.525582 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:23:56.547042 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7981979-bfed-4601-af88-0202e9c87cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d672690>]}
2022-08-22 12:23:56.552982 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:23:56.553583 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7981979-bfed-4601-af88-0202e9c87cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d644450>]}
2022-08-22 12:23:56.553899 (MainThread): Found 6 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:23:56.555641 (MainThread): 
2022-08-22 12:23:56.556040 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:23:56.556968 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 12:23:56.568977 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 12:23:56.569210 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 12:23:56.569429 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 12:23:56.625100 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.06 seconds
2022-08-22 12:23:56.627087 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 12:23:56.628699 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:23:56.635956 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:23:56.641231 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:23:56.641687 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:23:56.641898 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:23:56.642120 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:23:56.642325 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 12:23:56.642525 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 12:23:56.661193 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:23:56.661527 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:23:56.661759 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:23:56.661982 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:23:56.662190 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:23:56.662394 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:23:56.678665 (ThreadPoolExecutor-1_1): SQL status: SELECT 6 in 0.02 seconds
2022-08-22 12:23:56.678974 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.02 seconds
2022-08-22 12:23:56.680487 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:23:56.681753 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:23:56.682870 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: Close
2022-08-22 12:23:56.683091 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: Close
2022-08-22 12:23:56.689350 (MainThread): Using postgres connection "master".
2022-08-22 12:23:56.689654 (MainThread): On master: BEGIN
2022-08-22 12:23:56.689867 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:23:56.706704 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:23:56.707050 (MainThread): Using postgres connection "master".
2022-08-22 12:23:56.707266 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:23:56.942028 (MainThread): SQL status: SELECT 38 in 0.23 seconds
2022-08-22 12:23:56.948798 (MainThread): On master: ROLLBACK
2022-08-22 12:23:56.950242 (MainThread): Using postgres connection "master".
2022-08-22 12:23:56.950674 (MainThread): On master: BEGIN
2022-08-22 12:23:56.952825 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 12:23:56.953237 (MainThread): On master: COMMIT
2022-08-22 12:23:56.953643 (MainThread): Using postgres connection "master".
2022-08-22 12:23:56.954019 (MainThread): On master: COMMIT
2022-08-22 12:23:56.955215 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:23:56.955728 (MainThread): On master: Close
2022-08-22 12:23:56.956531 (MainThread): 15:23:56 | Concurrency: 4 threads (target='dev')
2022-08-22 12:23:56.956990 (MainThread): 15:23:56 | 
2022-08-22 12:23:56.960335 (Thread-1): Began running node snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:23:56.960686 (Thread-2): Began running node snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:23:56.961100 (Thread-1): 15:23:56 | 1 of 2 START snapshot snapshots.actor_snapshot_check................. [RUN]
2022-08-22 12:23:56.961422 (Thread-2): 15:23:56 | 2 of 2 START snapshot snapshots.actor_snapshot_scd................... [RUN]
2022-08-22 12:23:56.961914 (Thread-1): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:56.962299 (Thread-2): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:56.962553 (Thread-1): Compiling snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:23:56.962805 (Thread-2): Compiling snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:23:56.967776 (Thread-1): finished collecting timing info
2022-08-22 12:23:56.971266 (Thread-2): finished collecting timing info
2022-08-22 12:23:57.038446 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:57.039863 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:57.040121 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

    select count(*) from pg_namespace where nspname = 'snapshots'
  
2022-08-22 12:23:57.040338 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_scd"} */

    select count(*) from pg_namespace where nspname = 'snapshots'
  
2022-08-22 12:23:57.040546 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 12:23:57.040739 (Thread-2): Opening a new connection, currently in state closed
2022-08-22 12:23:57.065403 (Thread-2): SQL status: SELECT 1 in 0.02 seconds
2022-08-22 12:23:57.065741 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2022-08-22 12:23:57.128643 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:57.135186 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: BEGIN
2022-08-22 12:23:57.135565 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:57.135773 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

    select now()::timestamp without time zone as snapshot_start
  
2022-08-22 12:23:57.136708 (Thread-2): SQL status: BEGIN in 0.00 seconds
2022-08-22 12:23:57.136955 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:57.137159 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_scd"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dvdrental".INFORMATION_SCHEMA.columns
      where table_name = 'actor_snapshot_scd'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
2022-08-22 12:23:57.137664 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-08-22 12:23:57.144415 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:57.144688 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: BEGIN
2022-08-22 12:23:57.146095 (Thread-1): SQL status: BEGIN in 0.00 seconds
2022-08-22 12:23:57.146324 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:57.146519 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dvdrental".INFORMATION_SCHEMA.columns
      where table_name = 'actor_snapshot_check'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
2022-08-22 12:23:57.203265 (Thread-2): SQL status: SELECT 8 in 0.07 seconds
2022-08-22 12:23:57.203601 (Thread-1): SQL status: SELECT 8 in 0.06 seconds
2022-08-22 12:23:57.243816 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:57.241076 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:57.244088 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

        

  create temporary table "actor_snapshot_check__dbt_tmp152357230449"
  as (
    with snapshot_query as (

        



select * from "dvdrental"."public"."actor"


    ),

    snapshotted_data as (

        select *,
            actor_id as dbt_unique_key

        from "dvdrental"."snapshots"."actor_snapshot_check"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            actor_id as dbt_unique_key,
            last_update as dbt_updated_at,
            last_update as dbt_valid_from,
            nullif(last_update, last_update) as dbt_valid_to,
            md5(coalesce(cast(actor_id as varchar ), '')
         || '|' || coalesce(cast(last_update as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            actor_id as dbt_unique_key,
            last_update as dbt_updated_at,
            last_update as dbt_valid_from,
            last_update as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.first_name != source_data.first_name
        or
        (
            ((snapshotted_data.first_name is null) and not (source_data.first_name is null))
            or
            ((not snapshotted_data.first_name is null) and (source_data.first_name is null))
        ) or snapshotted_data.last_name != source_data.last_name
        or
        (
            ((snapshotted_data.last_name is null) and not (source_data.last_name is null))
            or
            ((not snapshotted_data.last_name is null) and (source_data.last_name is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.first_name != source_data.first_name
        or
        (
            ((snapshotted_data.first_name is null) and not (source_data.first_name is null))
            or
            ((not snapshotted_data.first_name is null) and (source_data.first_name is null))
        ) or snapshotted_data.last_name != source_data.last_name
        or
        (
            ((snapshotted_data.last_name is null) and not (source_data.last_name is null))
            or
            ((not snapshotted_data.last_name is null) and (source_data.last_name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates
  );
    
2022-08-22 12:23:57.244315 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_scd"} */

        

  create temporary table "actor_snapshot_scd__dbt_tmp152357222272"
  as (
    with snapshot_query as (

        



select * from "dvdrental"."public"."actor"


    ),

    snapshotted_data as (

        select *,
            actor_id as dbt_unique_key

        from "dvdrental"."snapshots"."actor_snapshot_scd"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            actor_id as dbt_unique_key,
            last_update as dbt_updated_at,
            last_update as dbt_valid_from,
            nullif(last_update, last_update) as dbt_valid_to,
            md5(coalesce(cast(actor_id as varchar ), '')
         || '|' || coalesce(cast(last_update as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            actor_id as dbt_unique_key,
            last_update as dbt_updated_at,
            last_update as dbt_valid_from,
            last_update as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.last_update)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.last_update)
        )
    )

    select * from insertions
    union all
    select * from updates
  );
    
2022-08-22 12:23:57.293785 (Thread-2): SQL status: SELECT 2 in 0.05 seconds
2022-08-22 12:23:57.296817 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:57.297066 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_scd"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'actor_snapshot_scd__dbt_tmp152357222272'
        
      order by ordinal_position

  
2022-08-22 12:23:57.301741 (Thread-1): SQL status: SELECT 2 in 0.06 seconds
2022-08-22 12:23:57.305570 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:57.305839 (Thread-2): SQL status: SELECT 10 in 0.01 seconds
2022-08-22 12:23:57.306079 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'actor_snapshot_check__dbt_tmp152357230449'
        
      order by ordinal_position

  
2022-08-22 12:23:57.309220 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:57.309542 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_scd"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dvdrental".INFORMATION_SCHEMA.columns
      where table_name = 'actor_snapshot_scd'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
2022-08-22 12:23:57.312679 (Thread-2): SQL status: SELECT 8 in 0.00 seconds
2022-08-22 12:23:57.312954 (Thread-1): SQL status: SELECT 10 in 0.00 seconds
2022-08-22 12:23:57.316790 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:57.319965 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:57.320201 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_scd"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'actor_snapshot_scd__dbt_tmp152357222272'
        
      order by ordinal_position

  
2022-08-22 12:23:57.320440 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dvdrental".INFORMATION_SCHEMA.columns
      where table_name = 'actor_snapshot_check'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
2022-08-22 12:23:57.323651 (Thread-1): SQL status: SELECT 8 in 0.00 seconds
2022-08-22 12:23:57.323924 (Thread-2): SQL status: SELECT 10 in 0.00 seconds
2022-08-22 12:23:57.327081 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:57.330287 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:57.330528 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'actor_snapshot_check__dbt_tmp152357230449'
        
      order by ordinal_position

  
2022-08-22 12:23:57.330733 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_scd"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dvdrental".INFORMATION_SCHEMA.columns
      where table_name = 'actor_snapshot_scd'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
2022-08-22 12:23:57.333718 (Thread-1): SQL status: SELECT 10 in 0.00 seconds
2022-08-22 12:23:57.333982 (Thread-2): SQL status: SELECT 8 in 0.00 seconds
2022-08-22 12:23:57.337284 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:57.345253 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:57.345461 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dvdrental".INFORMATION_SCHEMA.columns
      where table_name = 'actor_snapshot_check'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
2022-08-22 12:23:57.345672 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_scd"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'actor_snapshot_scd__dbt_tmp152357222272'
        
      order by ordinal_position

  
2022-08-22 12:23:57.348591 (Thread-2): SQL status: SELECT 10 in 0.00 seconds
2022-08-22 12:23:57.355257 (Thread-1): SQL status: SELECT 8 in 0.01 seconds
2022-08-22 12:23:57.357046 (Thread-2): Writing runtime SQL for node "snapshot.dbt_test.actor_snapshot_scd"
2022-08-22 12:23:57.360446 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:57.360792 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'actor_snapshot_check__dbt_tmp152357230449'
        
      order by ordinal_position

  
2022-08-22 12:23:57.361215 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:57.361497 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_scd"} */

      update "dvdrental"."snapshots"."actor_snapshot_scd"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "actor_snapshot_scd__dbt_tmp152357222272" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dvdrental"."snapshots"."actor_snapshot_scd".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "dvdrental"."snapshots"."actor_snapshot_scd".dbt_valid_to is null;

    insert into "dvdrental"."snapshots"."actor_snapshot_scd" ("actor_id", "first_name", "last_name", "last_update", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."actor_id",DBT_INTERNAL_SOURCE."first_name",DBT_INTERNAL_SOURCE."last_name",DBT_INTERNAL_SOURCE."last_update",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "actor_snapshot_scd__dbt_tmp152357222272" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
2022-08-22 12:23:57.363967 (Thread-1): SQL status: SELECT 10 in 0.00 seconds
2022-08-22 12:23:57.366513 (Thread-1): Writing runtime SQL for node "snapshot.dbt_test.actor_snapshot_check"
2022-08-22 12:23:57.367048 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:57.367260 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "snapshot.dbt_test.actor_snapshot_check"} */

      update "dvdrental"."snapshots"."actor_snapshot_check"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "actor_snapshot_check__dbt_tmp152357230449" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dvdrental"."snapshots"."actor_snapshot_check".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "dvdrental"."snapshots"."actor_snapshot_check".dbt_valid_to is null;

    insert into "dvdrental"."snapshots"."actor_snapshot_check" ("actor_id", "first_name", "last_name", "last_update", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."actor_id",DBT_INTERNAL_SOURCE."first_name",DBT_INTERNAL_SOURCE."last_name",DBT_INTERNAL_SOURCE."last_update",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "actor_snapshot_check__dbt_tmp152357230449" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
2022-08-22 12:23:57.372714 (Thread-1): SQL status: INSERT 0 1 in 0.01 seconds
2022-08-22 12:23:57.372966 (Thread-2): SQL status: INSERT 0 1 in 0.01 seconds
2022-08-22 12:23:57.381482 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: COMMIT
2022-08-22 12:23:57.382659 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: COMMIT
2022-08-22 12:23:57.382892 (Thread-1): Using postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:23:57.383096 (Thread-2): Using postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:23:57.383291 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: COMMIT
2022-08-22 12:23:57.383485 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: COMMIT
2022-08-22 12:23:57.389171 (Thread-2): SQL status: COMMIT in 0.01 seconds
2022-08-22 12:23:57.389427 (Thread-1): SQL status: COMMIT in 0.01 seconds
2022-08-22 12:23:57.392937 (Thread-2): finished collecting timing info
2022-08-22 12:23:57.393595 (Thread-1): finished collecting timing info
2022-08-22 12:23:57.393861 (Thread-2): On snapshot.dbt_test.actor_snapshot_scd: Close
2022-08-22 12:23:57.394083 (Thread-1): On snapshot.dbt_test.actor_snapshot_check: Close
2022-08-22 12:23:57.394547 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7981979-bfed-4601-af88-0202e9c87cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d672d90>]}
2022-08-22 12:23:57.394948 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7981979-bfed-4601-af88-0202e9c87cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf15e90>]}
2022-08-22 12:23:57.395416 (Thread-2): 15:23:57 | 2 of 2 OK snapshotted snapshots.actor_snapshot_scd................... [INSERT 0 1 in 0.43s]
2022-08-22 12:23:57.395960 (Thread-1): 15:23:57 | 1 of 2 OK snapshotted snapshots.actor_snapshot_check................. [INSERT 0 1 in 0.43s]
2022-08-22 12:23:57.396398 (Thread-2): Finished running node snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:23:57.396700 (Thread-1): Finished running node snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:23:57.465358 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:23:57.465725 (MainThread): Using postgres connection "master".
2022-08-22 12:23:57.465933 (MainThread): On master: BEGIN
2022-08-22 12:23:57.466161 (MainThread): Opening a new connection, currently in state closed
2022-08-22 12:23:57.482077 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:23:57.482421 (MainThread): On master: COMMIT
2022-08-22 12:23:57.482632 (MainThread): Using postgres connection "master".
2022-08-22 12:23:57.482829 (MainThread): On master: COMMIT
2022-08-22 12:23:57.484243 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:23:57.484502 (MainThread): On master: Close
2022-08-22 12:23:57.484941 (MainThread): 15:23:57 | 
2022-08-22 12:23:57.485181 (MainThread): 15:23:57 | Finished running 2 snapshots in 0.93s.
2022-08-22 12:23:57.485403 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:23:57.485590 (MainThread): Connection 'snapshot.dbt_test.actor_snapshot_check' was properly closed.
2022-08-22 12:23:57.485775 (MainThread): Connection 'snapshot.dbt_test.actor_snapshot_scd' was properly closed.
2022-08-22 12:23:57.491282 (MainThread): 
2022-08-22 12:23:57.491566 (MainThread): Completed successfully
2022-08-22 12:23:57.491803 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-08-22 12:23:57.492082 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d675890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d70a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7cd5d0>]}
2022-08-22 12:23:57.492371 (MainThread): Flushing usage events
2022-08-22 12:26:11.862767 (MainThread): Running with dbt=0.21.1
2022-08-22 12:26:11.965192 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-08-22 12:26:11.966993 (MainThread): Tracking: tracking
2022-08-22 12:26:11.980605 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109fe890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ee7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ee7050>]}
2022-08-22 12:26:11.995493 (MainThread): Partial parsing not enabled
2022-08-22 12:26:12.011282 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:26:12.012364 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:26:12.016488 (MainThread): Parsing macros/relations.sql
2022-08-22 12:26:12.018441 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:26:12.050609 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:26:12.052915 (MainThread): Parsing macros/core.sql
2022-08-22 12:26:12.057945 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:26:12.067398 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:26:12.080934 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:26:12.083193 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:26:12.107449 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:26:12.161485 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:26:12.194768 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:26:12.197147 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:26:12.212321 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:26:12.242474 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:26:12.262899 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:26:12.275181 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:26:12.286444 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:26:12.291684 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:26:12.293653 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:26:12.294930 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:26:12.297037 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:26:12.309176 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:26:12.311584 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:26:12.314821 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:26:12.316901 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:26:12.397207 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:26:12.399688 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:26:12.401376 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:26:12.403203 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:26:12.632750 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:26:12.649247 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:26:12.653458 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:26:12.658126 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:26:12.662420 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:26:12.668433 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:26:12.672817 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:26:12.688731 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:26:12.698163 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:26:12.715023 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:26:12.718052 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:26:12.763192 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:26:12.765332 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:26:12.786648 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29b703cb-9e76-4a98-b321-ea86aea94421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcb110>]}
2022-08-22 12:26:12.792659 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:26:12.793287 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29b703cb-9e76-4a98-b321-ea86aea94421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc4bd0>]}
2022-08-22 12:26:12.793622 (MainThread): Found 7 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:26:12.795734 (MainThread): 
2022-08-22 12:26:12.796192 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:26:12.797738 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:26:12.804763 (ThreadPoolExecutor-0_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:26:12.810628 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:26:12.812275 (ThreadPoolExecutor-0_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:26:12.812521 (ThreadPoolExecutor-0_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:26:12.812734 (ThreadPoolExecutor-0_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:26:12.812937 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 12:26:12.813136 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state init
2022-08-22 12:26:12.890628 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.08 seconds
2022-08-22 12:26:12.891003 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:26:12.891229 (ThreadPoolExecutor-0_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:26:12.891598 (ThreadPoolExecutor-0_1): SQL status: BEGIN in 0.08 seconds
2022-08-22 12:26:12.891869 (ThreadPoolExecutor-0_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:26:12.892084 (ThreadPoolExecutor-0_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:26:12.910536 (ThreadPoolExecutor-0_1): SQL status: SELECT 6 in 0.02 seconds
2022-08-22 12:26:12.910866 (ThreadPoolExecutor-0_0): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 12:26:12.912872 (ThreadPoolExecutor-0_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:26:12.914254 (ThreadPoolExecutor-0_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:26:12.915606 (ThreadPoolExecutor-0_1): On list_dvdrental_dvd_schema: Close
2022-08-22 12:26:12.915841 (ThreadPoolExecutor-0_0): On list_dvdrental_snapshots: Close
2022-08-22 12:26:12.922037 (MainThread): Using postgres connection "master".
2022-08-22 12:26:12.922337 (MainThread): On master: BEGIN
2022-08-22 12:26:12.922554 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:26:12.939605 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:26:12.939956 (MainThread): Using postgres connection "master".
2022-08-22 12:26:12.940172 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:26:13.164430 (MainThread): SQL status: SELECT 38 in 0.22 seconds
2022-08-22 12:26:13.170920 (MainThread): On master: ROLLBACK
2022-08-22 12:26:13.172344 (MainThread): On master: Close
2022-08-22 12:26:13.173194 (MainThread): 15:26:13 | Concurrency: 4 threads (target='dev')
2022-08-22 12:26:13.173647 (MainThread): 15:26:13 | 
2022-08-22 12:26:13.177413 (Thread-1): Began running node model.dbt_test.actor
2022-08-22 12:26:13.177774 (Thread-2): Began running node model.dbt_test.inventory
2022-08-22 12:26:13.178248 (Thread-1): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:26:13.178527 (Thread-3): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 12:26:13.178843 (Thread-4): Began running node model.dbt_test.rental
2022-08-22 12:26:13.179260 (Thread-2): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:26:13.179561 (Thread-1): Compiling model.dbt_test.actor
2022-08-22 12:26:13.179996 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:26:13.180637 (Thread-4): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:26:13.180909 (Thread-2): Compiling model.dbt_test.inventory
2022-08-22 12:26:13.183660 (Thread-1): Writing injected SQL for node "model.dbt_test.actor"
2022-08-22 12:26:13.183914 (Thread-3): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 12:26:13.184139 (Thread-4): Compiling model.dbt_test.rental
2022-08-22 12:26:13.186778 (Thread-2): Writing injected SQL for node "model.dbt_test.inventory"
2022-08-22 12:26:13.189497 (Thread-3): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 12:26:13.191833 (Thread-4): Writing injected SQL for node "model.dbt_test.rental"
2022-08-22 12:26:13.192250 (Thread-1): finished collecting timing info
2022-08-22 12:26:13.192828 (Thread-1): finished collecting timing info
2022-08-22 12:26:13.193072 (Thread-2): finished collecting timing info
2022-08-22 12:26:13.193528 (Thread-1): Finished running node model.dbt_test.actor
2022-08-22 12:26:13.193822 (Thread-2): finished collecting timing info
2022-08-22 12:26:13.194056 (Thread-3): finished collecting timing info
2022-08-22 12:26:13.194261 (Thread-4): finished collecting timing info
2022-08-22 12:26:13.194504 (Thread-1): Began running node snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:26:13.194970 (Thread-2): Finished running node model.dbt_test.inventory
2022-08-22 12:26:13.195211 (Thread-3): finished collecting timing info
2022-08-22 12:26:13.195458 (Thread-4): finished collecting timing info
2022-08-22 12:26:13.195814 (Thread-1): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:26:13.196055 (Thread-2): Began running node snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:26:13.196461 (Thread-3): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 12:26:13.197022 (Thread-4): Finished running node model.dbt_test.rental
2022-08-22 12:26:13.197257 (Thread-1): Compiling snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:26:13.197593 (Thread-2): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:26:13.198194 (Thread-3): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 12:26:13.202673 (Thread-1): finished collecting timing info
2022-08-22 12:26:13.203093 (Thread-4): Began running node test.dbt_test.my_test
2022-08-22 12:26:13.203391 (Thread-2): Compiling snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:26:13.203875 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:26:13.204207 (Thread-1): finished collecting timing info
2022-08-22 12:26:13.204617 (Thread-4): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:26:13.209467 (Thread-2): finished collecting timing info
2022-08-22 12:26:13.209771 (Thread-3): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 12:26:13.210153 (Thread-1): Finished running node snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:26:13.210380 (Thread-4): Compiling test.dbt_test.my_test
2022-08-22 12:26:13.210598 (Thread-2): finished collecting timing info
2022-08-22 12:26:13.212947 (Thread-3): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 12:26:13.213211 (Thread-1): Began running node model.dbt_test.mart
2022-08-22 12:26:13.215725 (Thread-4): Writing injected SQL for node "test.dbt_test.my_test"
2022-08-22 12:26:13.216184 (Thread-2): Finished running node snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:26:13.216703 (Thread-1): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:26:13.217224 (Thread-1): Compiling model.dbt_test.mart
2022-08-22 12:26:13.217619 (Thread-2): Began running node model.dbt_test.macro_use
2022-08-22 12:26:13.220368 (Thread-1): Writing injected SQL for node "model.dbt_test.mart"
2022-08-22 12:26:13.220669 (Thread-4): finished collecting timing info
2022-08-22 12:26:13.220944 (Thread-3): finished collecting timing info
2022-08-22 12:26:13.221352 (Thread-2): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:26:13.221959 (Thread-4): finished collecting timing info
2022-08-22 12:26:13.222444 (Thread-1): finished collecting timing info
2022-08-22 12:26:13.222707 (Thread-3): finished collecting timing info
2022-08-22 12:26:13.222982 (Thread-2): Compiling model.dbt_test.macro_use
2022-08-22 12:26:13.223391 (Thread-4): Finished running node test.dbt_test.my_test
2022-08-22 12:26:13.223663 (Thread-1): finished collecting timing info
2022-08-22 12:26:13.224078 (Thread-3): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 12:26:13.227112 (Thread-2): Writing injected SQL for node "model.dbt_test.macro_use"
2022-08-22 12:26:13.227657 (Thread-1): Finished running node model.dbt_test.mart
2022-08-22 12:26:13.228195 (Thread-4): Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:26:13.228444 (Thread-1): Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:26:13.228887 (Thread-4): Acquiring new postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 12:26:13.229293 (Thread-1): Acquiring new postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 12:26:13.229544 (Thread-4): Compiling test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:26:13.229758 (Thread-2): finished collecting timing info
2022-08-22 12:26:13.229968 (Thread-1): Compiling test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:26:13.241756 (Thread-4): Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 12:26:13.241999 (Thread-2): finished collecting timing info
2022-08-22 12:26:13.249163 (Thread-1): Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 12:26:13.249695 (Thread-2): Finished running node model.dbt_test.macro_use
2022-08-22 12:26:13.250246 (Thread-4): finished collecting timing info
2022-08-22 12:26:13.250498 (Thread-1): finished collecting timing info
2022-08-22 12:26:13.250728 (Thread-4): finished collecting timing info
2022-08-22 12:26:13.250967 (Thread-1): finished collecting timing info
2022-08-22 12:26:13.251334 (Thread-4): Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:26:13.251694 (Thread-1): Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:26:13.282134 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:26:13.282361 (MainThread): Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
2022-08-22 12:26:13.282557 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:26:13.282745 (MainThread): Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
2022-08-22 12:26:13.282960 (MainThread): Connection 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
2022-08-22 12:26:13.288523 (MainThread): 15:26:13 | Done.
2022-08-22 12:26:13.288830 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11168fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f8fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11169fdd0>]}
2022-08-22 12:26:13.289133 (MainThread): Flushing usage events
2022-08-22 12:26:35.072704 (MainThread): Running with dbt=0.21.1
2022-08-22 12:26:35.164575 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['macro_use'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 12:26:35.166094 (MainThread): Tracking: tracking
2022-08-22 12:26:35.178835 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1ecad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6d8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6d8b50>]}
2022-08-22 12:26:35.193468 (MainThread): Partial parsing not enabled
2022-08-22 12:26:35.206330 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:26:35.207365 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:26:35.211194 (MainThread): Parsing macros/relations.sql
2022-08-22 12:26:35.213060 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:26:35.243690 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:26:35.246000 (MainThread): Parsing macros/core.sql
2022-08-22 12:26:35.251009 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:26:35.260348 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:26:35.273469 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:26:35.275666 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:26:35.299417 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:26:35.347411 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:26:35.379132 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:26:35.381477 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:26:35.395974 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:26:35.424053 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:26:35.443406 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:26:35.454634 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:26:35.465133 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:26:35.470344 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:26:35.472306 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:26:35.473613 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:26:35.475732 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:26:35.487512 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:26:35.489913 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:26:35.493180 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:26:35.495254 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:26:35.570281 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:26:35.572524 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:26:35.574091 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:26:35.575851 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:26:35.810143 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:26:35.827041 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:26:35.831299 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:26:35.836004 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:26:35.840420 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:26:35.846589 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:26:35.851003 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:26:35.867013 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:26:35.876540 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:26:35.893421 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:26:35.896444 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:26:35.941895 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:26:35.944046 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:26:35.964986 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5709a846-c98c-471d-b086-701d82ca3f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7e2dd0>]}
2022-08-22 12:26:35.970951 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:26:35.971555 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5709a846-c98c-471d-b086-701d82ca3f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f79f610>]}
2022-08-22 12:26:35.971873 (MainThread): Found 7 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:26:35.973391 (MainThread): 
2022-08-22 12:26:35.973788 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:26:35.974686 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 12:26:35.986755 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 12:26:35.987025 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 12:26:35.987236 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 12:26:36.047108 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.06 seconds
2022-08-22 12:26:36.049098 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 12:26:36.050864 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:26:36.058298 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:26:36.058796 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:26:36.060522 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:26:36.060799 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:26:36.061052 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:26:36.061272 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 12:26:36.061477 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 12:26:36.079064 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:26:36.079405 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:26:36.079620 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:26:36.082908 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:26:36.083196 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:26:36.083408 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:26:36.100907 (ThreadPoolExecutor-1_1): SQL status: SELECT 6 in 0.02 seconds
2022-08-22 12:26:36.101228 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 12:26:36.102836 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:26:36.104157 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:26:36.105384 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: Close
2022-08-22 12:26:36.105613 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: Close
2022-08-22 12:26:36.111622 (MainThread): Using postgres connection "master".
2022-08-22 12:26:36.111929 (MainThread): On master: BEGIN
2022-08-22 12:26:36.112147 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:26:36.128331 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:26:36.128655 (MainThread): Using postgres connection "master".
2022-08-22 12:26:36.128897 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:26:36.360357 (MainThread): SQL status: SELECT 38 in 0.23 seconds
2022-08-22 12:26:36.368192 (MainThread): On master: ROLLBACK
2022-08-22 12:26:36.369656 (MainThread): Using postgres connection "master".
2022-08-22 12:26:36.370065 (MainThread): On master: BEGIN
2022-08-22 12:26:36.372376 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 12:26:36.372787 (MainThread): On master: COMMIT
2022-08-22 12:26:36.373191 (MainThread): Using postgres connection "master".
2022-08-22 12:26:36.373584 (MainThread): On master: COMMIT
2022-08-22 12:26:36.374811 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:26:36.375250 (MainThread): On master: Close
2022-08-22 12:26:36.376153 (MainThread): 15:26:36 | Concurrency: 4 threads (target='dev')
2022-08-22 12:26:36.376696 (MainThread): 15:26:36 | 
2022-08-22 12:26:36.379793 (Thread-1): Began running node model.dbt_test.macro_use
2022-08-22 12:26:36.380252 (Thread-1): 15:26:36 | 1 of 1 START table model dvd_schema.macro_use........................ [RUN]
2022-08-22 12:26:36.380721 (Thread-1): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:26:36.380977 (Thread-1): Compiling model.dbt_test.macro_use
2022-08-22 12:26:36.384182 (Thread-1): Writing injected SQL for node "model.dbt_test.macro_use"
2022-08-22 12:26:36.384808 (Thread-1): finished collecting timing info
2022-08-22 12:26:36.419235 (Thread-1): Writing runtime SQL for node "model.dbt_test.macro_use"
2022-08-22 12:26:36.419937 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:26:36.420161 (Thread-1): On model.dbt_test.macro_use: BEGIN
2022-08-22 12:26:36.420368 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 12:26:36.436880 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:26:36.437226 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:26:36.437440 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */


  create  table "dvdrental"."dvd_schema"."macro_use__dbt_tmp"
  as (
    select

    cast (last_update as timestamp) as column_name

from "dvdrental"."snapshots"."actor_snapshot_scd"
  );
2022-08-22 12:26:36.461938 (Thread-1): SQL status: SELECT 201 in 0.02 seconds
2022-08-22 12:26:36.469334 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:26:36.469591 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */
alter table "dvdrental"."dvd_schema"."macro_use__dbt_tmp" rename to "macro_use"
2022-08-22 12:26:36.471094 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 12:26:36.485540 (Thread-1): On model.dbt_test.macro_use: COMMIT
2022-08-22 12:26:36.485842 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:26:36.486088 (Thread-1): On model.dbt_test.macro_use: COMMIT
2022-08-22 12:26:36.490786 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:26:36.496439 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:26:36.496684 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */
drop table if exists "dvdrental"."dvd_schema"."macro_use__dbt_backup" cascade
2022-08-22 12:26:36.498066 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2022-08-22 12:26:36.499313 (Thread-1): finished collecting timing info
2022-08-22 12:26:36.499588 (Thread-1): On model.dbt_test.macro_use: Close
2022-08-22 12:26:36.500056 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5709a846-c98c-471d-b086-701d82ca3f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffc7a10>]}
2022-08-22 12:26:36.500485 (Thread-1): 15:26:36 | 1 of 1 OK created table model dvd_schema.macro_use................... [SELECT 201 in 0.12s]
2022-08-22 12:26:36.500739 (Thread-1): Finished running node model.dbt_test.macro_use
2022-08-22 12:26:36.591809 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:26:36.592409 (MainThread): Using postgres connection "master".
2022-08-22 12:26:36.592789 (MainThread): On master: BEGIN
2022-08-22 12:26:36.593168 (MainThread): Opening a new connection, currently in state closed
2022-08-22 12:26:36.610039 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:26:36.610377 (MainThread): On master: COMMIT
2022-08-22 12:26:36.610587 (MainThread): Using postgres connection "master".
2022-08-22 12:26:36.610785 (MainThread): On master: COMMIT
2022-08-22 12:26:36.612118 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:26:36.612397 (MainThread): On master: Close
2022-08-22 12:26:36.612844 (MainThread): 15:26:36 | 
2022-08-22 12:26:36.613094 (MainThread): 15:26:36 | Finished running 1 table model in 0.64s.
2022-08-22 12:26:36.613314 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:26:36.613506 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:26:36.613698 (MainThread): Connection 'list_dvdrental_dvd_schema' was properly closed.
2022-08-22 12:26:36.619419 (MainThread): 
2022-08-22 12:26:36.619704 (MainThread): Completed successfully
2022-08-22 12:26:36.619940 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-08-22 12:26:36.620233 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1d7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f236ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffc6550>]}
2022-08-22 12:26:36.620541 (MainThread): Flushing usage events
2022-08-22 12:27:49.199342 (MainThread): Running with dbt=0.21.1
2022-08-22 12:27:49.291066 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['macro_use'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 12:27:49.292580 (MainThread): Tracking: tracking
2022-08-22 12:27:49.305348 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d29e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d4a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d4a7d0>]}
2022-08-22 12:27:49.320012 (MainThread): Partial parsing not enabled
2022-08-22 12:27:49.332608 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:27:49.333686 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:27:49.337507 (MainThread): Parsing macros/relations.sql
2022-08-22 12:27:49.339374 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:27:49.369866 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:27:49.372192 (MainThread): Parsing macros/core.sql
2022-08-22 12:27:49.377225 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:27:49.386599 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:27:49.399763 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:27:49.401991 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:27:49.425877 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:27:49.473650 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:27:49.505174 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:27:49.507507 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:27:49.521873 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:27:49.549816 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:27:49.569046 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:27:49.580245 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:27:49.590621 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:27:49.595899 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:27:49.597845 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:27:49.599105 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:27:49.601172 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:27:49.612957 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:27:49.615373 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:27:49.618578 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:27:49.620634 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:27:49.695194 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:27:49.697407 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:27:49.698932 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:27:49.700666 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:27:49.932371 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:27:49.949306 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:27:49.953575 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:27:49.958284 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:27:49.962609 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:27:49.968841 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:27:49.973261 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:27:49.989232 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:27:49.998767 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:27:50.015630 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:27:50.018645 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:27:50.063959 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:27:50.066061 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:27:50.087273 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '415df8cb-7fd9-4649-858f-42bd90fa8c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119d9290>]}
2022-08-22 12:27:50.093394 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:27:50.093973 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '415df8cb-7fd9-4649-858f-42bd90fa8c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11131c910>]}
2022-08-22 12:27:50.094291 (MainThread): Found 7 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:27:50.095813 (MainThread): 
2022-08-22 12:27:50.096205 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:27:50.097185 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 12:27:50.108963 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 12:27:50.109199 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 12:27:50.109404 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 12:27:50.176338 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.07 seconds
2022-08-22 12:27:50.178379 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 12:27:50.180179 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:27:50.187481 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:27:50.187949 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:27:50.188163 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:27:50.189802 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:27:50.190034 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 12:27:50.190246 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:27:50.190632 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 12:27:50.207543 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:27:50.207891 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:27:50.208110 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:27:50.209522 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:27:50.209754 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:27:50.209950 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:27:50.226414 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.02 seconds
2022-08-22 12:27:50.228171 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:27:50.228452 (ThreadPoolExecutor-1_1): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 12:27:50.229845 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:27:50.230091 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: Close
2022-08-22 12:27:50.232212 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: Close
2022-08-22 12:27:50.237877 (MainThread): Using postgres connection "master".
2022-08-22 12:27:50.238356 (MainThread): On master: BEGIN
2022-08-22 12:27:50.238572 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:27:50.254214 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:27:50.254529 (MainThread): Using postgres connection "master".
2022-08-22 12:27:50.254761 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:27:50.490118 (MainThread): SQL status: SELECT 38 in 0.23 seconds
2022-08-22 12:27:50.497604 (MainThread): On master: ROLLBACK
2022-08-22 12:27:50.499082 (MainThread): Using postgres connection "master".
2022-08-22 12:27:50.499423 (MainThread): On master: BEGIN
2022-08-22 12:27:50.501474 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 12:27:50.501737 (MainThread): On master: COMMIT
2022-08-22 12:27:50.501963 (MainThread): Using postgres connection "master".
2022-08-22 12:27:50.502158 (MainThread): On master: COMMIT
2022-08-22 12:27:50.503262 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:27:50.503516 (MainThread): On master: Close
2022-08-22 12:27:50.503969 (MainThread): 15:27:50 | Concurrency: 4 threads (target='dev')
2022-08-22 12:27:50.504212 (MainThread): 15:27:50 | 
2022-08-22 12:27:50.506472 (Thread-1): Began running node model.dbt_test.macro_use
2022-08-22 12:27:50.506912 (Thread-1): 15:27:50 | 1 of 1 START table model dvd_schema.macro_use........................ [RUN]
2022-08-22 12:27:50.507376 (Thread-1): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:27:50.507635 (Thread-1): Compiling model.dbt_test.macro_use
2022-08-22 12:27:50.511149 (Thread-1): Writing injected SQL for node "model.dbt_test.macro_use"
2022-08-22 12:27:50.511794 (Thread-1): finished collecting timing info
2022-08-22 12:27:50.544501 (Thread-1): Writing runtime SQL for node "model.dbt_test.macro_use"
2022-08-22 12:27:50.545142 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:27:50.545357 (Thread-1): On model.dbt_test.macro_use: BEGIN
2022-08-22 12:27:50.545563 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 12:27:50.562511 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:27:50.574988 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:27:50.575230 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */


  create  table "dvdrental"."dvd_schema"."macro_use__dbt_tmp"
  as (
    select
a.*,

    cast (last_update as timestamp) as column_name

from "dvdrental"."snapshots"."actor_snapshot_scd" a
  );
2022-08-22 12:27:50.621401 (Thread-1): SQL status: SELECT 201 in 0.05 seconds
2022-08-22 12:27:50.628726 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:27:50.628968 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */
alter table "dvdrental"."dvd_schema"."macro_use" rename to "macro_use__dbt_backup"
2022-08-22 12:27:50.630369 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 12:27:50.633727 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:27:50.633959 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */
alter table "dvdrental"."dvd_schema"."macro_use__dbt_tmp" rename to "macro_use"
2022-08-22 12:27:50.635239 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 12:27:50.648666 (Thread-1): On model.dbt_test.macro_use: COMMIT
2022-08-22 12:27:50.648994 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:27:50.649260 (Thread-1): On model.dbt_test.macro_use: COMMIT
2022-08-22 12:27:50.654265 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:27:50.659795 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:27:50.660039 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */
drop table if exists "dvdrental"."dvd_schema"."macro_use__dbt_backup" cascade
2022-08-22 12:27:50.672015 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2022-08-22 12:27:50.673430 (Thread-1): finished collecting timing info
2022-08-22 12:27:50.673700 (Thread-1): On model.dbt_test.macro_use: Close
2022-08-22 12:27:50.674176 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '415df8cb-7fd9-4649-858f-42bd90fa8c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11019c4d0>]}
2022-08-22 12:27:50.674598 (Thread-1): 15:27:50 | 1 of 1 OK created table model dvd_schema.macro_use................... [SELECT 201 in 0.17s]
2022-08-22 12:27:50.674844 (Thread-1): Finished running node model.dbt_test.macro_use
2022-08-22 12:27:50.711304 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:27:50.711712 (MainThread): Using postgres connection "master".
2022-08-22 12:27:50.711919 (MainThread): On master: BEGIN
2022-08-22 12:27:50.712119 (MainThread): Opening a new connection, currently in state closed
2022-08-22 12:27:50.727730 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:27:50.728088 (MainThread): On master: COMMIT
2022-08-22 12:27:50.728305 (MainThread): Using postgres connection "master".
2022-08-22 12:27:50.728510 (MainThread): On master: COMMIT
2022-08-22 12:27:50.729640 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:27:50.729917 (MainThread): On master: Close
2022-08-22 12:27:50.730372 (MainThread): 15:27:50 | 
2022-08-22 12:27:50.730614 (MainThread): 15:27:50 | Finished running 1 table model in 0.63s.
2022-08-22 12:27:50.730835 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:27:50.731034 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:27:50.731221 (MainThread): Connection 'list_dvdrental_snapshots' was properly closed.
2022-08-22 12:27:50.737222 (MainThread): 
2022-08-22 12:27:50.737537 (MainThread): Completed successfully
2022-08-22 12:27:50.737775 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-08-22 12:27:50.738067 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d29e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111246950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b24450>]}
2022-08-22 12:27:50.738367 (MainThread): Flushing usage events
2022-08-22 12:28:39.293509 (MainThread): Running with dbt=0.21.1
2022-08-22 12:28:39.384606 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-08-22 12:28:39.386393 (MainThread): Tracking: tracking
2022-08-22 12:28:39.399527 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e71c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e7c8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e7c810>]}
2022-08-22 12:28:39.414130 (MainThread): Partial parsing not enabled
2022-08-22 12:28:39.426943 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:28:39.427979 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:28:39.431765 (MainThread): Parsing macros/relations.sql
2022-08-22 12:28:39.433605 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:28:39.463891 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:28:39.466191 (MainThread): Parsing macros/core.sql
2022-08-22 12:28:39.471161 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:28:39.480370 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:28:39.493433 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:28:39.495629 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:28:39.519077 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:28:39.566694 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:28:39.598023 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:28:39.600354 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:28:39.614611 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:28:39.642355 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:28:39.661473 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:28:39.672602 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:28:39.682919 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:28:39.688057 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:28:39.689996 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:28:39.691255 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:28:39.693311 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:28:39.704952 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:28:39.707341 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:28:39.710509 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:28:39.712559 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:28:39.786883 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:28:39.789077 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:28:39.790588 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:28:39.792305 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:28:40.021370 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:28:40.038082 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:28:40.042411 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:28:40.047164 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:28:40.051537 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:28:40.057587 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:28:40.066318 (MainThread): 1699: statically parsed example/my_second_dbt_model.sql
2022-08-22 12:28:40.074074 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:28:40.077499 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'b6a373dc-e71a-4b1c-b814-cf1e86aca68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f25e50>]}
2022-08-22 12:28:40.090905 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:28:40.100498 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:28:40.117557 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:28:40.121674 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:28:40.166737 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:28:40.168896 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:28:40.190501 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6a373dc-e71a-4b1c-b814-cf1e86aca68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111686b10>]}
2022-08-22 12:28:40.196661 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:28:40.197261 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6a373dc-e71a-4b1c-b814-cf1e86aca68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11164a7d0>]}
2022-08-22 12:28:40.197585 (MainThread): Found 7 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:28:40.199697 (MainThread): 
2022-08-22 12:28:40.200104 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:28:40.201523 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:28:40.208385 (ThreadPoolExecutor-0_1): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:28:40.214089 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:28:40.215731 (ThreadPoolExecutor-0_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:28:40.216030 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:28:40.216246 (ThreadPoolExecutor-0_1): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:28:40.216456 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 12:28:40.216651 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state init
2022-08-22 12:28:40.280298 (ThreadPoolExecutor-0_1): SQL status: BEGIN in 0.06 seconds
2022-08-22 12:28:40.280653 (ThreadPoolExecutor-0_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:28:40.280867 (ThreadPoolExecutor-0_1): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:28:40.281595 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.07 seconds
2022-08-22 12:28:40.281836 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:28:40.282037 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:28:40.297296 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.02 seconds
2022-08-22 12:28:40.299593 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:28:40.299844 (ThreadPoolExecutor-0_1): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 12:28:40.301113 (ThreadPoolExecutor-0_1): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:28:40.301325 (ThreadPoolExecutor-0_0): On list_dvdrental_dvd_schema: Close
2022-08-22 12:28:40.302506 (ThreadPoolExecutor-0_1): On list_dvdrental_snapshots: Close
2022-08-22 12:28:40.308183 (MainThread): Using postgres connection "master".
2022-08-22 12:28:40.308466 (MainThread): On master: BEGIN
2022-08-22 12:28:40.308681 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:28:40.324788 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:28:40.325120 (MainThread): Using postgres connection "master".
2022-08-22 12:28:40.325337 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:28:40.558530 (MainThread): SQL status: SELECT 38 in 0.23 seconds
2022-08-22 12:28:40.579565 (MainThread): On master: ROLLBACK
2022-08-22 12:28:40.581460 (MainThread): On master: Close
2022-08-22 12:28:40.582294 (MainThread): 15:28:40 | Concurrency: 4 threads (target='dev')
2022-08-22 12:28:40.582737 (MainThread): 15:28:40 | 
2022-08-22 12:28:40.586286 (Thread-1): Began running node model.dbt_test.actor
2022-08-22 12:28:40.586834 (Thread-2): Began running node model.dbt_test.inventory
2022-08-22 12:28:40.587283 (Thread-3): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 12:28:40.588068 (Thread-1): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:28:40.588445 (Thread-4): Began running node model.dbt_test.rental
2022-08-22 12:28:40.589155 (Thread-2): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:28:40.589844 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:28:40.590329 (Thread-1): Compiling model.dbt_test.actor
2022-08-22 12:28:40.591125 (Thread-4): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:28:40.591389 (Thread-2): Compiling model.dbt_test.inventory
2022-08-22 12:28:40.591605 (Thread-3): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 12:28:40.594580 (Thread-1): Writing injected SQL for node "model.dbt_test.actor"
2022-08-22 12:28:40.594900 (Thread-4): Compiling model.dbt_test.rental
2022-08-22 12:28:40.598065 (Thread-2): Writing injected SQL for node "model.dbt_test.inventory"
2022-08-22 12:28:40.600526 (Thread-3): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 12:28:40.603178 (Thread-4): Writing injected SQL for node "model.dbt_test.rental"
2022-08-22 12:28:40.603805 (Thread-2): finished collecting timing info
2022-08-22 12:28:40.604037 (Thread-1): finished collecting timing info
2022-08-22 12:28:40.604401 (Thread-2): finished collecting timing info
2022-08-22 12:28:40.604615 (Thread-3): finished collecting timing info
2022-08-22 12:28:40.604851 (Thread-1): finished collecting timing info
2022-08-22 12:28:40.605305 (Thread-2): Finished running node model.dbt_test.inventory
2022-08-22 12:28:40.605536 (Thread-4): finished collecting timing info
2022-08-22 12:28:40.605762 (Thread-3): finished collecting timing info
2022-08-22 12:28:40.606147 (Thread-1): Finished running node model.dbt_test.actor
2022-08-22 12:28:40.606393 (Thread-2): Began running node snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:28:40.606707 (Thread-4): finished collecting timing info
2022-08-22 12:28:40.607098 (Thread-3): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 12:28:40.607343 (Thread-1): Began running node snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:28:40.607962 (Thread-2): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:28:40.608336 (Thread-4): Finished running node model.dbt_test.rental
2022-08-22 12:28:40.608816 (Thread-1): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:28:40.609116 (Thread-2): Compiling snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:28:40.609319 (Thread-3): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 12:28:40.609598 (Thread-4): Began running node test.dbt_test.my_test
2022-08-22 12:28:40.609939 (Thread-1): Compiling snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:28:40.613714 (Thread-2): finished collecting timing info
2022-08-22 12:28:40.614104 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:28:40.614484 (Thread-4): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:28:40.618815 (Thread-1): finished collecting timing info
2022-08-22 12:28:40.619125 (Thread-2): finished collecting timing info
2022-08-22 12:28:40.619387 (Thread-3): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 12:28:40.619622 (Thread-4): Compiling test.dbt_test.my_test
2022-08-22 12:28:40.619909 (Thread-1): finished collecting timing info
2022-08-22 12:28:40.620426 (Thread-2): Finished running node snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:28:40.623676 (Thread-3): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 12:28:40.626420 (Thread-4): Writing injected SQL for node "test.dbt_test.my_test"
2022-08-22 12:28:40.626872 (Thread-1): Finished running node snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:28:40.627174 (Thread-2): Began running node model.dbt_test.mart
2022-08-22 12:28:40.627893 (Thread-3): finished collecting timing info
2022-08-22 12:28:40.628314 (Thread-2): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:28:40.628647 (Thread-4): finished collecting timing info
2022-08-22 12:28:40.628878 (Thread-3): finished collecting timing info
2022-08-22 12:28:40.629078 (Thread-1): Began running node model.dbt_test.macro_use
2022-08-22 12:28:40.629311 (Thread-2): Compiling model.dbt_test.mart
2022-08-22 12:28:40.629522 (Thread-4): finished collecting timing info
2022-08-22 12:28:40.629905 (Thread-3): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 12:28:40.630254 (Thread-1): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:28:40.633223 (Thread-2): Writing injected SQL for node "model.dbt_test.mart"
2022-08-22 12:28:40.633644 (Thread-4): Finished running node test.dbt_test.my_test
2022-08-22 12:28:40.633990 (Thread-1): Compiling model.dbt_test.macro_use
2022-08-22 12:28:40.634321 (Thread-3): Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:28:40.634591 (Thread-4): Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:28:40.637428 (Thread-1): Writing injected SQL for node "model.dbt_test.macro_use"
2022-08-22 12:28:40.637829 (Thread-3): Acquiring new postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 12:28:40.638055 (Thread-2): finished collecting timing info
2022-08-22 12:28:40.638394 (Thread-4): Acquiring new postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 12:28:40.638684 (Thread-3): Compiling test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:28:40.638955 (Thread-2): finished collecting timing info
2022-08-22 12:28:40.639188 (Thread-4): Compiling test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:28:40.639374 (Thread-1): finished collecting timing info
2022-08-22 12:28:40.651278 (Thread-3): Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 12:28:40.651685 (Thread-2): Finished running node model.dbt_test.mart
2022-08-22 12:28:40.658567 (Thread-4): Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 12:28:40.658797 (Thread-1): finished collecting timing info
2022-08-22 12:28:40.659499 (Thread-1): Finished running node model.dbt_test.macro_use
2022-08-22 12:28:40.659730 (Thread-3): finished collecting timing info
2022-08-22 12:28:40.660109 (Thread-3): finished collecting timing info
2022-08-22 12:28:40.660326 (Thread-4): finished collecting timing info
2022-08-22 12:28:40.660697 (Thread-3): Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:28:40.660935 (Thread-4): finished collecting timing info
2022-08-22 12:28:40.661378 (Thread-4): Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:28:40.690774 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:28:40.690984 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:28:40.691171 (MainThread): Connection 'model.dbt_test.mart' was properly closed.
2022-08-22 12:28:40.691354 (MainThread): Connection 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
2022-08-22 12:28:40.691535 (MainThread): Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
2022-08-22 12:28:40.697265 (MainThread): 15:28:40 | Done.
2022-08-22 12:28:40.697577 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11164add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f25290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116eb590>]}
2022-08-22 12:28:40.697878 (MainThread): Flushing usage events
2022-08-22 12:28:48.185532 (MainThread): Running with dbt=0.21.1
2022-08-22 12:28:48.277347 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['macro_use'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 12:28:48.282543 (MainThread): Tracking: tracking
2022-08-22 12:28:48.295552 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111109d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111604ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111604c10>]}
2022-08-22 12:28:48.310643 (MainThread): Partial parsing not enabled
2022-08-22 12:28:48.323282 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:28:48.324332 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:28:48.328150 (MainThread): Parsing macros/relations.sql
2022-08-22 12:28:48.329996 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:28:48.360326 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:28:48.362616 (MainThread): Parsing macros/core.sql
2022-08-22 12:28:48.367593 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:28:48.376910 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:28:48.390047 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:28:48.392261 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:28:48.415909 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:28:48.463794 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:28:48.495393 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:28:48.497725 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:28:48.512053 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:28:48.539981 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:28:48.559174 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:28:48.570333 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:28:48.580732 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:28:48.585901 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:28:48.587850 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:28:48.589119 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:28:48.591191 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:28:48.602915 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:28:48.605319 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:28:48.608498 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:28:48.610554 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:28:48.685407 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:28:48.687623 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:28:48.689157 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:28:48.690891 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:28:48.922089 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:28:48.939177 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:28:48.943746 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:28:48.948759 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:28:48.953255 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:28:48.959585 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:28:48.964043 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:28:48.980189 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:28:48.990164 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:28:49.007337 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:28:49.010542 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:28:49.056314 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:28:49.058441 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:28:49.080165 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b49feca-7420-4f18-a0ce-ea535a6a4181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111db2ad0>]}
2022-08-22 12:28:49.086257 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:28:49.086877 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b49feca-7420-4f18-a0ce-ea535a6a4181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111da0e10>]}
2022-08-22 12:28:49.087207 (MainThread): Found 7 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:28:49.088811 (MainThread): 
2022-08-22 12:28:49.089213 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:28:49.090219 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 12:28:49.102671 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 12:28:49.102952 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 12:28:49.103170 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 12:28:49.149974 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.05 seconds
2022-08-22 12:28:49.151961 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 12:28:49.153656 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:28:49.154158 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:28:49.161478 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:28:49.163138 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:28:49.163392 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:28:49.163603 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:28:49.163849 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 12:28:49.164105 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 12:28:49.181844 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:28:49.182174 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:28:49.182393 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:28:49.182663 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:28:49.182926 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:28:49.183141 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:28:49.197208 (ThreadPoolExecutor-1_1): SQL status: SELECT 7 in 0.01 seconds
2022-08-22 12:28:49.198856 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:28:49.199126 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 12:28:49.200538 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:28:49.200760 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: Close
2022-08-22 12:28:49.202044 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: Close
2022-08-22 12:28:49.207585 (MainThread): Using postgres connection "master".
2022-08-22 12:28:49.207884 (MainThread): On master: BEGIN
2022-08-22 12:28:49.208284 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:28:49.225717 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:28:49.226057 (MainThread): Using postgres connection "master".
2022-08-22 12:28:49.226298 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:28:49.459067 (MainThread): SQL status: SELECT 38 in 0.23 seconds
2022-08-22 12:28:49.464010 (MainThread): On master: ROLLBACK
2022-08-22 12:28:49.465572 (MainThread): Using postgres connection "master".
2022-08-22 12:28:49.466011 (MainThread): On master: BEGIN
2022-08-22 12:28:49.468288 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 12:28:49.468784 (MainThread): On master: COMMIT
2022-08-22 12:28:49.469165 (MainThread): Using postgres connection "master".
2022-08-22 12:28:49.469533 (MainThread): On master: COMMIT
2022-08-22 12:28:49.470955 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:28:49.471380 (MainThread): On master: Close
2022-08-22 12:28:49.472210 (MainThread): 15:28:49 | Concurrency: 4 threads (target='dev')
2022-08-22 12:28:49.472645 (MainThread): 15:28:49 | 
2022-08-22 12:28:49.475814 (Thread-1): Began running node model.dbt_test.macro_use
2022-08-22 12:28:49.476663 (Thread-1): 15:28:49 | 1 of 1 START table model dvd_schema.macro_use........................ [RUN]
2022-08-22 12:28:49.477148 (Thread-1): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:28:49.477411 (Thread-1): Compiling model.dbt_test.macro_use
2022-08-22 12:28:49.480554 (Thread-1): Writing injected SQL for node "model.dbt_test.macro_use"
2022-08-22 12:28:49.481119 (Thread-1): finished collecting timing info
2022-08-22 12:28:49.515171 (Thread-1): Writing runtime SQL for node "model.dbt_test.macro_use"
2022-08-22 12:28:49.515923 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:28:49.516169 (Thread-1): On model.dbt_test.macro_use: BEGIN
2022-08-22 12:28:49.516402 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 12:28:49.532726 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:28:49.533065 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:28:49.533281 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */


  create  table "dvdrental"."dvd_schema"."macro_use__dbt_tmp"
  as (
    select
a.*,

    cast (last_update as timestamp) as column_name
 as colonka
from "dvdrental"."snapshots"."actor_snapshot_scd" a
  );
2022-08-22 12:28:49.534679 (Thread-1): Postgres error: syntax error at or near "as"
LINE 10:  as colonka
          ^

2022-08-22 12:28:49.534948 (Thread-1): On model.dbt_test.macro_use: ROLLBACK
2022-08-22 12:28:49.537268 (Thread-1): finished collecting timing info
2022-08-22 12:28:49.537636 (Thread-1): On model.dbt_test.macro_use: Close
2022-08-22 12:28:49.538118 (Thread-1): Database Error in model macro_use (models/staging/macro_use.sql)
  syntax error at or near "as"
  LINE 10:  as colonka
            ^
  compiled SQL at target/run/dbt_test/models/staging/macro_use.sql
Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "as"
LINE 10:  as colonka
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.7/3.7.13_3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model macro_use (models/staging/macro_use.sql)
  syntax error at or near "as"
  LINE 10:  as colonka
            ^
  compiled SQL at target/run/dbt_test/models/staging/macro_use.sql
2022-08-22 12:28:49.542658 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b49feca-7420-4f18-a0ce-ea535a6a4181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e0b1d0>]}
2022-08-22 12:28:49.543168 (Thread-1): 15:28:49 | 1 of 1 ERROR creating table model dvd_schema.macro_use............... [ERROR in 0.07s]
2022-08-22 12:28:49.543451 (Thread-1): Finished running node model.dbt_test.macro_use
2022-08-22 12:28:49.577117 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:28:49.577493 (MainThread): Using postgres connection "master".
2022-08-22 12:28:49.577701 (MainThread): On master: BEGIN
2022-08-22 12:28:49.577902 (MainThread): Opening a new connection, currently in state closed
2022-08-22 12:28:49.597930 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:28:49.598312 (MainThread): On master: COMMIT
2022-08-22 12:28:49.598530 (MainThread): Using postgres connection "master".
2022-08-22 12:28:49.598734 (MainThread): On master: COMMIT
2022-08-22 12:28:49.600147 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:28:49.600441 (MainThread): On master: Close
2022-08-22 12:28:49.600896 (MainThread): 15:28:49 | 
2022-08-22 12:28:49.601148 (MainThread): 15:28:49 | Finished running 1 table model in 0.51s.
2022-08-22 12:28:49.601379 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:28:49.601570 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:28:49.601755 (MainThread): Connection 'list_dvdrental_dvd_schema' was properly closed.
2022-08-22 12:28:49.608369 (MainThread): 
2022-08-22 12:28:49.608663 (MainThread): Completed with 1 error and 0 warnings:
2022-08-22 12:28:49.608891 (MainThread): 
2022-08-22 12:28:49.609111 (MainThread): Database Error in model macro_use (models/staging/macro_use.sql)
2022-08-22 12:28:49.609325 (MainThread):   syntax error at or near "as"
2022-08-22 12:28:49.609528 (MainThread):   LINE 10:  as colonka
2022-08-22 12:28:49.609727 (MainThread):             ^
2022-08-22 12:28:49.609923 (MainThread):   compiled SQL at target/run/dbt_test/models/staging/macro_use.sql
2022-08-22 12:28:49.610140 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-08-22 12:28:49.610505 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115dc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eec350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eeccd0>]}
2022-08-22 12:28:49.610827 (MainThread): Flushing usage events
2022-08-22 12:29:07.168777 (MainThread): Running with dbt=0.21.1
2022-08-22 12:29:07.271010 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-08-22 12:29:07.272977 (MainThread): Tracking: tracking
2022-08-22 12:29:07.286082 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce35bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce60a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce78a90>]}
2022-08-22 12:29:07.301189 (MainThread): Partial parsing not enabled
2022-08-22 12:29:07.316561 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:29:07.317625 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:29:07.321733 (MainThread): Parsing macros/relations.sql
2022-08-22 12:29:07.323641 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:29:07.353865 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:29:07.356177 (MainThread): Parsing macros/core.sql
2022-08-22 12:29:07.361147 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:29:07.370363 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:29:07.383458 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:29:07.385701 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:29:07.409165 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:29:07.456982 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:29:07.488371 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:29:07.490706 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:29:07.505007 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:29:07.532797 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:29:07.551955 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:29:07.563095 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:29:07.573463 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:29:07.578614 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:29:07.580570 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:29:07.581835 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:29:07.583894 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:29:07.595592 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:29:07.597984 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:29:07.601161 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:29:07.603201 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:29:07.677675 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:29:07.679904 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:29:07.681422 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:29:07.683155 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:29:07.913187 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:29:07.929699 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:29:07.933985 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:29:07.938680 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:29:07.942972 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:29:07.948953 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:29:07.953257 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:29:07.968998 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:29:07.978397 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:29:07.995128 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:29:07.998157 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:29:08.043275 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:29:08.045417 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:29:08.066535 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49bd40c5-fde7-4413-b925-27b3dc7bdfed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db8ef90>]}
2022-08-22 12:29:08.073765 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:29:08.075048 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49bd40c5-fde7-4413-b925-27b3dc7bdfed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d442250>]}
2022-08-22 12:29:08.075379 (MainThread): Found 7 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:29:08.077947 (MainThread): 
2022-08-22 12:29:08.078403 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:29:08.080018 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:29:08.080536 (ThreadPoolExecutor-0_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:29:08.094283 (ThreadPoolExecutor-0_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:29:08.094599 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:29:08.094808 (ThreadPoolExecutor-0_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:29:08.095018 (ThreadPoolExecutor-0_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:29:08.095222 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state init
2022-08-22 12:29:08.095416 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 12:29:08.157411 (ThreadPoolExecutor-0_1): SQL status: BEGIN in 0.06 seconds
2022-08-22 12:29:08.157730 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.06 seconds
2022-08-22 12:29:08.157996 (ThreadPoolExecutor-0_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:29:08.158295 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:29:08.158515 (ThreadPoolExecutor-0_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:29:08.158725 (ThreadPoolExecutor-0_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:29:08.178132 (ThreadPoolExecutor-0_1): SQL status: SELECT 7 in 0.02 seconds
2022-08-22 12:29:08.178448 (ThreadPoolExecutor-0_0): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 12:29:08.180496 (ThreadPoolExecutor-0_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:29:08.181757 (ThreadPoolExecutor-0_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:29:08.182980 (ThreadPoolExecutor-0_1): On list_dvdrental_dvd_schema: Close
2022-08-22 12:29:08.183200 (ThreadPoolExecutor-0_0): On list_dvdrental_snapshots: Close
2022-08-22 12:29:08.189324 (MainThread): Using postgres connection "master".
2022-08-22 12:29:08.189606 (MainThread): On master: BEGIN
2022-08-22 12:29:08.189819 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:29:08.205748 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:29:08.206064 (MainThread): Using postgres connection "master".
2022-08-22 12:29:08.206283 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:29:08.445820 (MainThread): SQL status: SELECT 38 in 0.24 seconds
2022-08-22 12:29:08.453289 (MainThread): On master: ROLLBACK
2022-08-22 12:29:08.455001 (MainThread): On master: Close
2022-08-22 12:29:08.455522 (MainThread): 15:29:08 | Concurrency: 4 threads (target='dev')
2022-08-22 12:29:08.455783 (MainThread): 15:29:08 | 
2022-08-22 12:29:08.459476 (Thread-1): Began running node model.dbt_test.actor
2022-08-22 12:29:08.459877 (Thread-2): Began running node model.dbt_test.inventory
2022-08-22 12:29:08.460396 (Thread-1): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:29:08.460648 (Thread-3): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 12:29:08.461163 (Thread-2): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:29:08.461417 (Thread-4): Began running node model.dbt_test.rental
2022-08-22 12:29:08.461713 (Thread-1): Compiling model.dbt_test.actor
2022-08-22 12:29:08.462102 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:29:08.462374 (Thread-2): Compiling model.dbt_test.inventory
2022-08-22 12:29:08.462798 (Thread-4): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:29:08.465787 (Thread-1): Writing injected SQL for node "model.dbt_test.actor"
2022-08-22 12:29:08.466040 (Thread-3): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 12:29:08.468419 (Thread-2): Writing injected SQL for node "model.dbt_test.inventory"
2022-08-22 12:29:08.468716 (Thread-4): Compiling model.dbt_test.rental
2022-08-22 12:29:08.471517 (Thread-3): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 12:29:08.474040 (Thread-4): Writing injected SQL for node "model.dbt_test.rental"
2022-08-22 12:29:08.474501 (Thread-1): finished collecting timing info
2022-08-22 12:29:08.474725 (Thread-2): finished collecting timing info
2022-08-22 12:29:08.475069 (Thread-1): finished collecting timing info
2022-08-22 12:29:08.475340 (Thread-2): finished collecting timing info
2022-08-22 12:29:08.475540 (Thread-3): finished collecting timing info
2022-08-22 12:29:08.475993 (Thread-1): Finished running node model.dbt_test.actor
2022-08-22 12:29:08.476406 (Thread-2): Finished running node model.dbt_test.inventory
2022-08-22 12:29:08.476607 (Thread-4): finished collecting timing info
2022-08-22 12:29:08.476866 (Thread-3): finished collecting timing info
2022-08-22 12:29:08.477271 (Thread-1): Began running node snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:29:08.477751 (Thread-2): Began running node snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:29:08.478180 (Thread-4): finished collecting timing info
2022-08-22 12:29:08.478642 (Thread-3): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 12:29:08.479009 (Thread-1): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:29:08.479353 (Thread-2): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:29:08.479705 (Thread-4): Finished running node model.dbt_test.rental
2022-08-22 12:29:08.480039 (Thread-1): Compiling snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:29:08.480328 (Thread-3): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 12:29:08.480545 (Thread-2): Compiling snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:29:08.480768 (Thread-4): Began running node test.dbt_test.my_test
2022-08-22 12:29:08.484643 (Thread-1): finished collecting timing info
2022-08-22 12:29:08.485127 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:29:08.489551 (Thread-2): finished collecting timing info
2022-08-22 12:29:08.490000 (Thread-4): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:29:08.490273 (Thread-1): finished collecting timing info
2022-08-22 12:29:08.490521 (Thread-3): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 12:29:08.490762 (Thread-2): finished collecting timing info
2022-08-22 12:29:08.491003 (Thread-4): Compiling test.dbt_test.my_test
2022-08-22 12:29:08.491354 (Thread-1): Finished running node snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:29:08.493840 (Thread-3): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 12:29:08.494280 (Thread-2): Finished running node snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:29:08.496463 (Thread-4): Writing injected SQL for node "test.dbt_test.my_test"
2022-08-22 12:29:08.496721 (Thread-1): Began running node model.dbt_test.mart
2022-08-22 12:29:08.497356 (Thread-2): Began running node model.dbt_test.macro_use
2022-08-22 12:29:08.497738 (Thread-1): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:29:08.498148 (Thread-2): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:29:08.498368 (Thread-4): finished collecting timing info
2022-08-22 12:29:08.498564 (Thread-3): finished collecting timing info
2022-08-22 12:29:08.498758 (Thread-1): Compiling model.dbt_test.mart
2022-08-22 12:29:08.498967 (Thread-2): Compiling model.dbt_test.macro_use
2022-08-22 12:29:08.499177 (Thread-4): finished collecting timing info
2022-08-22 12:29:08.499393 (Thread-3): finished collecting timing info
2022-08-22 12:29:08.502143 (Thread-1): Writing injected SQL for node "model.dbt_test.mart"
2022-08-22 12:29:08.504799 (Thread-2): Writing injected SQL for node "model.dbt_test.macro_use"
2022-08-22 12:29:08.505208 (Thread-4): Finished running node test.dbt_test.my_test
2022-08-22 12:29:08.505578 (Thread-3): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 12:29:08.506268 (Thread-1): finished collecting timing info
2022-08-22 12:29:08.506499 (Thread-2): finished collecting timing info
2022-08-22 12:29:08.506743 (Thread-1): finished collecting timing info
2022-08-22 12:29:08.506941 (Thread-4): Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:29:08.507168 (Thread-3): Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:29:08.507376 (Thread-2): finished collecting timing info
2022-08-22 12:29:08.507752 (Thread-1): Finished running node model.dbt_test.mart
2022-08-22 12:29:08.508092 (Thread-4): Acquiring new postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 12:29:08.508444 (Thread-3): Acquiring new postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 12:29:08.508800 (Thread-2): Finished running node model.dbt_test.macro_use
2022-08-22 12:29:08.509135 (Thread-4): Compiling test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:29:08.509355 (Thread-3): Compiling test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:29:08.521265 (Thread-4): Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 12:29:08.528068 (Thread-3): Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 12:29:08.528653 (Thread-3): finished collecting timing info
2022-08-22 12:29:08.528931 (Thread-3): finished collecting timing info
2022-08-22 12:29:08.529163 (Thread-4): finished collecting timing info
2022-08-22 12:29:08.529539 (Thread-3): Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:29:08.529772 (Thread-4): finished collecting timing info
2022-08-22 12:29:08.530217 (Thread-4): Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:29:08.563889 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:29:08.564104 (MainThread): Connection 'model.dbt_test.mart' was properly closed.
2022-08-22 12:29:08.564289 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:29:08.564469 (MainThread): Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
2022-08-22 12:29:08.564649 (MainThread): Connection 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
2022-08-22 12:29:08.570264 (MainThread): 15:29:08 | Done.
2022-08-22 12:29:08.570580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db803d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db27f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d416190>]}
2022-08-22 12:29:08.570876 (MainThread): Flushing usage events
2022-08-22 12:29:17.932340 (MainThread): Running with dbt=0.21.1
2022-08-22 12:29:18.023901 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['macro_use'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 12:29:18.025527 (MainThread): Tracking: tracking
2022-08-22 12:29:18.038049 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef23b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef4ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef4e490>]}
2022-08-22 12:29:18.052607 (MainThread): Partial parsing not enabled
2022-08-22 12:29:18.065332 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:29:18.066361 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:29:18.070097 (MainThread): Parsing macros/relations.sql
2022-08-22 12:29:18.071925 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:29:18.102230 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:29:18.104534 (MainThread): Parsing macros/core.sql
2022-08-22 12:29:18.109493 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:29:18.118719 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:29:18.131909 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:29:18.134131 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:29:18.157714 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:29:18.205289 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:29:18.236687 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:29:18.239035 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:29:18.253405 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:29:18.281505 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:29:18.300664 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:29:18.311814 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:29:18.322148 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:29:18.327277 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:29:18.329224 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:29:18.330511 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:29:18.332565 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:29:18.344236 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:29:18.346634 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:29:18.349814 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:29:18.351879 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:29:18.426576 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:29:18.428778 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:29:18.430308 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:29:18.432046 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:29:18.663188 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:29:18.680105 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:29:18.684363 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:29:18.689067 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:29:18.698527 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:29:18.705067 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:29:18.709539 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:29:18.725540 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:29:18.734975 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:29:18.751760 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:29:18.754788 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:29:18.799942 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:29:18.802067 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:29:18.823509 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f76fe58e-65fd-4c1c-a5df-51954f0f1b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f48a6d0>]}
2022-08-22 12:29:18.829590 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:29:18.830187 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f76fe58e-65fd-4c1c-a5df-51954f0f1b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbe6cd0>]}
2022-08-22 12:29:18.830505 (MainThread): Found 7 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:29:18.832062 (MainThread): 
2022-08-22 12:29:18.832458 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:29:18.833338 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 12:29:18.845475 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 12:29:18.845739 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 12:29:18.845942 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 12:29:18.883192 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.04 seconds
2022-08-22 12:29:18.885135 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 12:29:18.886808 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:29:18.894045 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:29:18.894309 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:29:18.894519 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 12:29:18.895070 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:29:18.896951 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:29:18.897198 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:29:18.897404 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 12:29:18.914039 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:29:18.914370 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:29:18.914584 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:29:18.917161 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:29:18.917433 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:29:18.917641 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:29:18.929696 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-08-22 12:29:18.931370 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:29:18.932518 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: Close
2022-08-22 12:29:18.932768 (ThreadPoolExecutor-1_1): SQL status: SELECT 2 in 0.01 seconds
2022-08-22 12:29:18.934294 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:29:18.935894 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: Close
2022-08-22 12:29:18.941493 (MainThread): Using postgres connection "master".
2022-08-22 12:29:18.941770 (MainThread): On master: BEGIN
2022-08-22 12:29:18.942161 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:29:18.958390 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:29:18.958722 (MainThread): Using postgres connection "master".
2022-08-22 12:29:18.958961 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:29:19.192192 (MainThread): SQL status: SELECT 38 in 0.23 seconds
2022-08-22 12:29:19.199321 (MainThread): On master: ROLLBACK
2022-08-22 12:29:19.200715 (MainThread): Using postgres connection "master".
2022-08-22 12:29:19.201106 (MainThread): On master: BEGIN
2022-08-22 12:29:19.203336 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 12:29:19.203736 (MainThread): On master: COMMIT
2022-08-22 12:29:19.204129 (MainThread): Using postgres connection "master".
2022-08-22 12:29:19.204487 (MainThread): On master: COMMIT
2022-08-22 12:29:19.205777 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:29:19.206246 (MainThread): On master: Close
2022-08-22 12:29:19.207035 (MainThread): 15:29:19 | Concurrency: 4 threads (target='dev')
2022-08-22 12:29:19.207484 (MainThread): 15:29:19 | 
2022-08-22 12:29:19.210736 (Thread-1): Began running node model.dbt_test.macro_use
2022-08-22 12:29:19.211231 (Thread-1): 15:29:19 | 1 of 1 START table model dvd_schema.macro_use........................ [RUN]
2022-08-22 12:29:19.211703 (Thread-1): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:29:19.211964 (Thread-1): Compiling model.dbt_test.macro_use
2022-08-22 12:29:19.215272 (Thread-1): Writing injected SQL for node "model.dbt_test.macro_use"
2022-08-22 12:29:19.215869 (Thread-1): finished collecting timing info
2022-08-22 12:29:19.250414 (Thread-1): Writing runtime SQL for node "model.dbt_test.macro_use"
2022-08-22 12:29:19.251157 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:29:19.251436 (Thread-1): On model.dbt_test.macro_use: BEGIN
2022-08-22 12:29:19.251680 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 12:29:19.267751 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:29:19.268092 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:29:19.268305 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */


  create  table "dvdrental"."dvd_schema"."macro_use__dbt_tmp"
  as (
    select
a.*,

    cast (last_update as timestamp) as column_name
 as "colonka"
from "dvdrental"."snapshots"."actor_snapshot_scd" a
  );
2022-08-22 12:29:19.269608 (Thread-1): Postgres error: syntax error at or near "as"
LINE 10:  as "colonka"
          ^

2022-08-22 12:29:19.269871 (Thread-1): On model.dbt_test.macro_use: ROLLBACK
2022-08-22 12:29:19.271303 (Thread-1): finished collecting timing info
2022-08-22 12:29:19.271607 (Thread-1): On model.dbt_test.macro_use: Close
2022-08-22 12:29:19.272054 (Thread-1): Database Error in model macro_use (models/staging/macro_use.sql)
  syntax error at or near "as"
  LINE 10:  as "colonka"
            ^
  compiled SQL at target/run/dbt_test/models/staging/macro_use.sql
Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "as"
LINE 10:  as "colonka"
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.7/3.7.13_3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model macro_use (models/staging/macro_use.sql)
  syntax error at or near "as"
  LINE 10:  as "colonka"
            ^
  compiled SQL at target/run/dbt_test/models/staging/macro_use.sql
2022-08-22 12:29:19.276450 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76fe58e-65fd-4c1c-a5df-51954f0f1b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc62690>]}
2022-08-22 12:29:19.276925 (Thread-1): 15:29:19 | 1 of 1 ERROR creating table model dvd_schema.macro_use............... [ERROR in 0.06s]
2022-08-22 12:29:19.277180 (Thread-1): Finished running node model.dbt_test.macro_use
2022-08-22 12:29:19.315883 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:29:19.316338 (MainThread): Using postgres connection "master".
2022-08-22 12:29:19.316652 (MainThread): On master: BEGIN
2022-08-22 12:29:19.316955 (MainThread): Opening a new connection, currently in state closed
2022-08-22 12:29:19.334214 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:29:19.334560 (MainThread): On master: COMMIT
2022-08-22 12:29:19.334778 (MainThread): Using postgres connection "master".
2022-08-22 12:29:19.334974 (MainThread): On master: COMMIT
2022-08-22 12:29:19.336235 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:29:19.336504 (MainThread): On master: Close
2022-08-22 12:29:19.336951 (MainThread): 15:29:19 | 
2022-08-22 12:29:19.337199 (MainThread): 15:29:19 | Finished running 1 table model in 0.50s.
2022-08-22 12:29:19.337422 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:29:19.337612 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:29:19.337798 (MainThread): Connection 'list_dvdrental_snapshots' was properly closed.
2022-08-22 12:29:19.344442 (MainThread): 
2022-08-22 12:29:19.344731 (MainThread): Completed with 1 error and 0 warnings:
2022-08-22 12:29:19.344952 (MainThread): 
2022-08-22 12:29:19.345167 (MainThread): Database Error in model macro_use (models/staging/macro_use.sql)
2022-08-22 12:29:19.345371 (MainThread):   syntax error at or near "as"
2022-08-22 12:29:19.345571 (MainThread):   LINE 10:  as "colonka"
2022-08-22 12:29:19.345769 (MainThread):             ^
2022-08-22 12:29:19.345963 (MainThread):   compiled SQL at target/run/dbt_test/models/staging/macro_use.sql
2022-08-22 12:29:19.346168 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-08-22 12:29:19.346452 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd33210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd21990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd21190>]}
2022-08-22 12:29:19.346787 (MainThread): Flushing usage events
2022-08-22 12:32:37.961439 (MainThread): Running with dbt=0.21.1
2022-08-22 12:32:38.052826 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-08-22 12:32:38.054401 (MainThread): Tracking: tracking
2022-08-22 12:32:38.067243 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4e6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4d0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4d0d10>]}
2022-08-22 12:32:38.081791 (MainThread): Partial parsing not enabled
2022-08-22 12:32:38.094535 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:32:38.095585 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:32:38.099413 (MainThread): Parsing macros/relations.sql
2022-08-22 12:32:38.101300 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:32:38.131619 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:32:38.133885 (MainThread): Parsing macros/core.sql
2022-08-22 12:32:38.138874 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:32:38.148128 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:32:38.161153 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:32:38.163404 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:32:38.187042 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:32:38.234931 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:32:38.266428 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:32:38.268766 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:32:38.283153 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:32:38.311037 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:32:38.330342 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:32:38.341743 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:32:38.352352 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:32:38.357634 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:32:38.359649 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:32:38.360946 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:32:38.363083 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:32:38.374890 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:32:38.377308 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:32:38.380622 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:32:38.382683 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:32:38.457964 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:32:38.460180 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:32:38.461740 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:32:38.463501 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:32:38.696294 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:32:38.713004 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:32:38.717290 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:32:38.721980 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:32:38.726343 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:32:38.732473 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:32:38.736902 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:32:38.752808 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:32:38.762298 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:32:38.779189 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:32:38.782230 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:32:38.827459 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:32:38.829607 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:32:38.850426 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2566dad5-b2cd-48eb-aa85-54c48f79edb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c9c90>]}
2022-08-22 12:32:38.856419 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:32:38.857037 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2566dad5-b2cd-48eb-aa85-54c48f79edb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d59b8d0>]}
2022-08-22 12:32:38.857356 (MainThread): Found 7 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:32:38.859462 (MainThread): 
2022-08-22 12:32:38.859863 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:32:38.861258 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:32:38.861748 (ThreadPoolExecutor-0_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:32:38.873862 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:32:38.875417 (ThreadPoolExecutor-0_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:32:38.875653 (ThreadPoolExecutor-0_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:32:38.875858 (ThreadPoolExecutor-0_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:32:38.876077 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 12:32:38.876284 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state init
2022-08-22 12:32:38.935099 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.06 seconds
2022-08-22 12:32:38.935411 (ThreadPoolExecutor-0_1): SQL status: BEGIN in 0.06 seconds
2022-08-22 12:32:38.935671 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:32:38.935965 (ThreadPoolExecutor-0_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:32:38.936240 (ThreadPoolExecutor-0_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:32:38.936492 (ThreadPoolExecutor-0_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:32:38.961110 (ThreadPoolExecutor-0_0): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 12:32:38.961415 (ThreadPoolExecutor-0_1): SQL status: SELECT 7 in 0.02 seconds
2022-08-22 12:32:38.963507 (ThreadPoolExecutor-0_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:32:38.964905 (ThreadPoolExecutor-0_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:32:38.966163 (ThreadPoolExecutor-0_1): On list_dvdrental_dvd_schema: Close
2022-08-22 12:32:38.966400 (ThreadPoolExecutor-0_0): On list_dvdrental_snapshots: Close
2022-08-22 12:32:38.973196 (MainThread): Using postgres connection "master".
2022-08-22 12:32:38.973482 (MainThread): On master: BEGIN
2022-08-22 12:32:38.973695 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:32:38.989197 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:32:38.989514 (MainThread): Using postgres connection "master".
2022-08-22 12:32:38.989723 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:32:39.226600 (MainThread): SQL status: SELECT 38 in 0.24 seconds
2022-08-22 12:32:39.232096 (MainThread): On master: ROLLBACK
2022-08-22 12:32:39.233592 (MainThread): On master: Close
2022-08-22 12:32:39.234498 (MainThread): 15:32:39 | Concurrency: 4 threads (target='dev')
2022-08-22 12:32:39.235030 (MainThread): 15:32:39 | 
2022-08-22 12:32:39.238892 (Thread-1): Began running node model.dbt_test.actor
2022-08-22 12:32:39.239246 (Thread-2): Began running node model.dbt_test.inventory
2022-08-22 12:32:39.239537 (Thread-3): Began running node model.dbt_test.my_first_dbt_model
2022-08-22 12:32:39.240025 (Thread-1): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:32:39.240264 (Thread-4): Began running node model.dbt_test.rental
2022-08-22 12:32:39.240721 (Thread-2): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:32:39.241162 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:32:39.241440 (Thread-1): Compiling model.dbt_test.actor
2022-08-22 12:32:39.241867 (Thread-4): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:32:39.242111 (Thread-2): Compiling model.dbt_test.inventory
2022-08-22 12:32:39.242359 (Thread-3): Compiling model.dbt_test.my_first_dbt_model
2022-08-22 12:32:39.245339 (Thread-1): Writing injected SQL for node "model.dbt_test.actor"
2022-08-22 12:32:39.245594 (Thread-4): Compiling model.dbt_test.rental
2022-08-22 12:32:39.248140 (Thread-2): Writing injected SQL for node "model.dbt_test.inventory"
2022-08-22 12:32:39.250657 (Thread-3): Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
2022-08-22 12:32:39.253174 (Thread-4): Writing injected SQL for node "model.dbt_test.rental"
2022-08-22 12:32:39.253744 (Thread-1): finished collecting timing info
2022-08-22 12:32:39.254121 (Thread-2): finished collecting timing info
2022-08-22 12:32:39.254366 (Thread-3): finished collecting timing info
2022-08-22 12:32:39.254666 (Thread-1): finished collecting timing info
2022-08-22 12:32:39.254900 (Thread-2): finished collecting timing info
2022-08-22 12:32:39.255197 (Thread-3): finished collecting timing info
2022-08-22 12:32:39.255430 (Thread-4): finished collecting timing info
2022-08-22 12:32:39.255838 (Thread-1): Finished running node model.dbt_test.actor
2022-08-22 12:32:39.256214 (Thread-2): Finished running node model.dbt_test.inventory
2022-08-22 12:32:39.256570 (Thread-3): Finished running node model.dbt_test.my_first_dbt_model
2022-08-22 12:32:39.256800 (Thread-4): finished collecting timing info
2022-08-22 12:32:39.257047 (Thread-1): Began running node snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:32:39.257374 (Thread-2): Began running node snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:32:39.257920 (Thread-4): Finished running node model.dbt_test.rental
2022-08-22 12:32:39.258345 (Thread-1): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:32:39.258535 (Thread-3): Began running node model.dbt_test.my_second_dbt_model
2022-08-22 12:32:39.258881 (Thread-2): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:32:39.259112 (Thread-4): Began running node test.dbt_test.my_test
2022-08-22 12:32:39.259389 (Thread-1): Compiling snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:32:39.259959 (Thread-3): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:32:39.260167 (Thread-2): Compiling snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:32:39.260524 (Thread-4): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:32:39.264970 (Thread-1): finished collecting timing info
2022-08-22 12:32:39.265230 (Thread-3): Compiling model.dbt_test.my_second_dbt_model
2022-08-22 12:32:39.270609 (Thread-2): finished collecting timing info
2022-08-22 12:32:39.270927 (Thread-4): Compiling test.dbt_test.my_test
2022-08-22 12:32:39.271223 (Thread-1): finished collecting timing info
2022-08-22 12:32:39.273862 (Thread-3): Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
2022-08-22 12:32:39.274140 (Thread-2): finished collecting timing info
2022-08-22 12:32:39.276587 (Thread-4): Writing injected SQL for node "test.dbt_test.my_test"
2022-08-22 12:32:39.276986 (Thread-1): Finished running node snapshot.dbt_test.actor_snapshot_check
2022-08-22 12:32:39.277486 (Thread-2): Finished running node snapshot.dbt_test.actor_snapshot_scd
2022-08-22 12:32:39.277908 (Thread-1): Began running node model.dbt_test.mart
2022-08-22 12:32:39.278267 (Thread-3): finished collecting timing info
2022-08-22 12:32:39.278649 (Thread-4): finished collecting timing info
2022-08-22 12:32:39.279085 (Thread-1): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:32:39.279370 (Thread-2): Began running node model.dbt_test.macro_use
2022-08-22 12:32:39.279657 (Thread-3): finished collecting timing info
2022-08-22 12:32:39.279919 (Thread-4): finished collecting timing info
2022-08-22 12:32:39.280166 (Thread-1): Compiling model.dbt_test.mart
2022-08-22 12:32:39.280563 (Thread-2): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:32:39.280965 (Thread-3): Finished running node model.dbt_test.my_second_dbt_model
2022-08-22 12:32:39.281335 (Thread-4): Finished running node test.dbt_test.my_test
2022-08-22 12:32:39.284153 (Thread-1): Writing injected SQL for node "model.dbt_test.mart"
2022-08-22 12:32:39.284389 (Thread-2): Compiling model.dbt_test.macro_use
2022-08-22 12:32:39.284895 (Thread-3): Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:32:39.285133 (Thread-4): Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:32:39.287876 (Thread-2): Writing injected SQL for node "model.dbt_test.macro_use"
2022-08-22 12:32:39.288285 (Thread-3): Acquiring new postgres connection "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778".
2022-08-22 12:32:39.288652 (Thread-4): Acquiring new postgres connection "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493".
2022-08-22 12:32:39.288864 (Thread-1): finished collecting timing info
2022-08-22 12:32:39.289126 (Thread-3): Compiling test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:32:39.289339 (Thread-4): Compiling test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:32:39.289602 (Thread-1): finished collecting timing info
2022-08-22 12:32:39.289812 (Thread-2): finished collecting timing info
2022-08-22 12:32:39.301535 (Thread-3): Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
2022-08-22 12:32:39.308381 (Thread-4): Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
2022-08-22 12:32:39.308758 (Thread-1): Finished running node model.dbt_test.mart
2022-08-22 12:32:39.309006 (Thread-2): finished collecting timing info
2022-08-22 12:32:39.309693 (Thread-2): Finished running node model.dbt_test.macro_use
2022-08-22 12:32:39.310126 (Thread-3): finished collecting timing info
2022-08-22 12:32:39.310389 (Thread-3): finished collecting timing info
2022-08-22 12:32:39.310604 (Thread-4): finished collecting timing info
2022-08-22 12:32:39.310965 (Thread-3): Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
2022-08-22 12:32:39.311197 (Thread-4): finished collecting timing info
2022-08-22 12:32:39.311651 (Thread-4): Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
2022-08-22 12:32:39.343263 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:32:39.343471 (MainThread): Connection 'model.dbt_test.mart' was properly closed.
2022-08-22 12:32:39.343657 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:32:39.343838 (MainThread): Connection 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
2022-08-22 12:32:39.344017 (MainThread): Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
2022-08-22 12:32:39.349782 (MainThread): 15:32:39 | Done.
2022-08-22 12:32:39.350092 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc86910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d485210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4e9e50>]}
2022-08-22 12:32:39.350394 (MainThread): Flushing usage events
2022-08-22 12:32:48.604693 (MainThread): Running with dbt=0.21.1
2022-08-22 12:32:48.696467 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['macro_use'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 12:32:48.697964 (MainThread): Tracking: tracking
2022-08-22 12:32:48.709931 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8afa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed91e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed91110>]}
2022-08-22 12:32:48.724496 (MainThread): Partial parsing not enabled
2022-08-22 12:32:48.737061 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:32:48.738111 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:32:48.741897 (MainThread): Parsing macros/relations.sql
2022-08-22 12:32:48.743741 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:32:48.773973 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:32:48.776259 (MainThread): Parsing macros/core.sql
2022-08-22 12:32:48.781199 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:32:48.790386 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:32:48.803430 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:32:48.805665 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:32:48.829310 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:32:48.876783 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:32:48.908036 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:32:48.910350 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:32:48.924645 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:32:48.952738 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:32:48.971808 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:32:48.982977 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:32:48.993297 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:32:48.998415 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:32:49.000347 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:32:49.001601 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:32:49.003646 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:32:49.015235 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:32:49.017621 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:32:49.020791 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:32:49.022845 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:32:49.097205 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:32:49.099406 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:32:49.100916 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:32:49.102638 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:32:49.333013 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:32:49.349705 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:32:49.353952 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:32:49.358659 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:32:49.362972 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:32:49.369128 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:32:49.373485 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:32:49.389322 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:32:49.398828 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:32:49.415627 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:32:49.418577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:32:49.463876 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:32:49.466002 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:32:49.487241 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5b71703-07a6-4458-8d0c-f7662e27d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f520750>]}
2022-08-22 12:32:49.493293 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:32:49.493916 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5b71703-07a6-4458-8d0c-f7662e27d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee7b250>]}
2022-08-22 12:32:49.494236 (MainThread): Found 7 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:32:49.495823 (MainThread): 
2022-08-22 12:32:49.496241 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:32:49.497157 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 12:32:49.509197 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 12:32:49.509457 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 12:32:49.509656 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 12:32:49.550833 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.04 seconds
2022-08-22 12:32:49.552759 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 12:32:49.554414 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:32:49.561650 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:32:49.562121 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:32:49.563724 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:32:49.563954 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:32:49.564175 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:32:49.564395 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 12:32:49.564595 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 12:32:49.581583 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:32:49.581916 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:32:49.582128 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:32:49.583371 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:32:49.583641 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:32:49.583849 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:32:49.599261 (ThreadPoolExecutor-1_1): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 12:32:49.600780 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:32:49.601045 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.02 seconds
2022-08-22 12:32:49.602432 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:32:49.602646 (ThreadPoolExecutor-1_1): On list_dvdrental_snapshots: Close
2022-08-22 12:32:49.604027 (ThreadPoolExecutor-1_0): On list_dvdrental_dvd_schema: Close
2022-08-22 12:32:49.609711 (MainThread): Using postgres connection "master".
2022-08-22 12:32:49.610005 (MainThread): On master: BEGIN
2022-08-22 12:32:49.610382 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:32:49.626511 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:32:49.626840 (MainThread): Using postgres connection "master".
2022-08-22 12:32:49.627076 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:32:49.862593 (MainThread): SQL status: SELECT 38 in 0.24 seconds
2022-08-22 12:32:49.870086 (MainThread): On master: ROLLBACK
2022-08-22 12:32:49.871590 (MainThread): Using postgres connection "master".
2022-08-22 12:32:49.871981 (MainThread): On master: BEGIN
2022-08-22 12:32:49.874439 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 12:32:49.874927 (MainThread): On master: COMMIT
2022-08-22 12:32:49.875334 (MainThread): Using postgres connection "master".
2022-08-22 12:32:49.875711 (MainThread): On master: COMMIT
2022-08-22 12:32:49.877019 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:32:49.877448 (MainThread): On master: Close
2022-08-22 12:32:49.878228 (MainThread): 15:32:49 | Concurrency: 4 threads (target='dev')
2022-08-22 12:32:49.878660 (MainThread): 15:32:49 | 
2022-08-22 12:32:49.881864 (Thread-1): Began running node model.dbt_test.macro_use
2022-08-22 12:32:49.882359 (Thread-1): 15:32:49 | 1 of 1 START table model dvd_schema.macro_use........................ [RUN]
2022-08-22 12:32:49.882824 (Thread-1): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:32:49.883118 (Thread-1): Compiling model.dbt_test.macro_use
2022-08-22 12:32:49.886381 (Thread-1): Writing injected SQL for node "model.dbt_test.macro_use"
2022-08-22 12:32:49.887031 (Thread-1): finished collecting timing info
2022-08-22 12:32:49.922801 (Thread-1): Writing runtime SQL for node "model.dbt_test.macro_use"
2022-08-22 12:32:49.923448 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:32:49.923660 (Thread-1): On model.dbt_test.macro_use: BEGIN
2022-08-22 12:32:49.923861 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 12:32:49.940440 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:32:49.940771 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:32:49.940985 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */


  create  table "dvdrental"."dvd_schema"."macro_use__dbt_tmp"
  as (
    select
a.*,

    cast (last_update as timestamp)
 as "last_update"
from "dvdrental"."snapshots"."actor_snapshot_scd" a
  );
2022-08-22 12:32:49.944239 (Thread-1): Postgres error: column "last_update" specified more than once

2022-08-22 12:32:49.944515 (Thread-1): On model.dbt_test.macro_use: ROLLBACK
2022-08-22 12:32:49.945895 (Thread-1): finished collecting timing info
2022-08-22 12:32:49.946187 (Thread-1): On model.dbt_test.macro_use: Close
2022-08-22 12:32:49.946634 (Thread-1): Database Error in model macro_use (models/staging/macro_use.sql)
  column "last_update" specified more than once
  compiled SQL at target/run/dbt_test/models/staging/macro_use.sql
Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DuplicateColumn: column "last_update" specified more than once


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.7/3.7.13_3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/victorchudnovskiy/PycharmProjects/dbt/venv/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model macro_use (models/staging/macro_use.sql)
  column "last_update" specified more than once
  compiled SQL at target/run/dbt_test/models/staging/macro_use.sql
2022-08-22 12:32:49.951046 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5b71703-07a6-4458-8d0c-f7662e27d675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f560190>]}
2022-08-22 12:32:49.951498 (Thread-1): 15:32:49 | 1 of 1 ERROR creating table model dvd_schema.macro_use............... [ERROR in 0.07s]
2022-08-22 12:32:49.951748 (Thread-1): Finished running node model.dbt_test.macro_use
2022-08-22 12:32:49.986950 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:32:49.987345 (MainThread): Using postgres connection "master".
2022-08-22 12:32:49.987638 (MainThread): On master: BEGIN
2022-08-22 12:32:49.987960 (MainThread): Opening a new connection, currently in state closed
2022-08-22 12:32:50.003343 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:32:50.003695 (MainThread): On master: COMMIT
2022-08-22 12:32:50.003906 (MainThread): Using postgres connection "master".
2022-08-22 12:32:50.004103 (MainThread): On master: COMMIT
2022-08-22 12:32:50.005278 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:32:50.005543 (MainThread): On master: Close
2022-08-22 12:32:50.005976 (MainThread): 15:32:50 | 
2022-08-22 12:32:50.006216 (MainThread): 15:32:50 | Finished running 1 table model in 0.51s.
2022-08-22 12:32:50.006437 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:32:50.006623 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:32:50.006804 (MainThread): Connection 'list_dvdrental_snapshots' was properly closed.
2022-08-22 12:32:50.013698 (MainThread): 
2022-08-22 12:32:50.014011 (MainThread): Completed with 1 error and 0 warnings:
2022-08-22 12:32:50.014243 (MainThread): 
2022-08-22 12:32:50.014462 (MainThread): Database Error in model macro_use (models/staging/macro_use.sql)
2022-08-22 12:32:50.014670 (MainThread):   column "last_update" specified more than once
2022-08-22 12:32:50.014874 (MainThread):   compiled SQL at target/run/dbt_test/models/staging/macro_use.sql
2022-08-22 12:32:50.015090 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-08-22 12:32:50.015376 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee353d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f67a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f580050>]}
2022-08-22 12:32:50.015670 (MainThread): Flushing usage events
2022-08-22 12:33:34.240963 (MainThread): Running with dbt=0.21.1
2022-08-22 12:33:34.332186 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['macro_use'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-22 12:33:34.333642 (MainThread): Tracking: tracking
2022-08-22 12:33:34.346435 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d65a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d637710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d65ac50>]}
2022-08-22 12:33:34.360941 (MainThread): Partial parsing not enabled
2022-08-22 12:33:34.373511 (MainThread): Parsing macros/my_macro.sql
2022-08-22 12:33:34.374538 (MainThread): Parsing macros/catalog.sql
2022-08-22 12:33:34.378358 (MainThread): Parsing macros/relations.sql
2022-08-22 12:33:34.380230 (MainThread): Parsing macros/adapters.sql
2022-08-22 12:33:34.411297 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-08-22 12:33:34.413609 (MainThread): Parsing macros/core.sql
2022-08-22 12:33:34.418678 (MainThread): Parsing macros/materializations/test.sql
2022-08-22 12:33:34.428014 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-22 12:33:34.441299 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-22 12:33:34.443546 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-22 12:33:34.467351 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-22 12:33:34.517543 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-22 12:33:34.549714 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-22 12:33:34.552058 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-22 12:33:34.566652 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-08-22 12:33:34.595301 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-22 12:33:34.614896 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-22 12:33:34.626479 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-22 12:33:34.637166 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-22 12:33:34.642312 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-22 12:33:34.644281 (MainThread): Parsing macros/etc/query.sql
2022-08-22 12:33:34.645555 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-22 12:33:34.647628 (MainThread): Parsing macros/etc/datetime.sql
2022-08-22 12:33:34.659429 (MainThread): Parsing macros/etc/where_subquery.sql
2022-08-22 12:33:34.661826 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-22 12:33:34.665033 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-22 12:33:34.667087 (MainThread): Parsing macros/adapters/common.sql
2022-08-22 12:33:34.743657 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-22 12:33:34.745875 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-22 12:33:34.747393 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-22 12:33:34.749131 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-22 12:33:34.979225 (MainThread): Acquiring new postgres connection "model.dbt_test.actor".
2022-08-22 12:33:34.995965 (MainThread): Acquiring new postgres connection "model.dbt_test.rental".
2022-08-22 12:33:35.000195 (MainThread): Acquiring new postgres connection "model.dbt_test.mart".
2022-08-22 12:33:35.004868 (MainThread): Acquiring new postgres connection "model.dbt_test.inventory".
2022-08-22 12:33:35.009181 (MainThread): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:33:35.015318 (MainThread): Acquiring new postgres connection "model.dbt_test.my_first_dbt_model".
2022-08-22 12:33:35.019723 (MainThread): Acquiring new postgres connection "model.dbt_test.my_second_dbt_model".
2022-08-22 12:33:35.035553 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_check".
2022-08-22 12:33:35.045065 (MainThread): Acquiring new postgres connection "snapshot.dbt_test.actor_snapshot_scd".
2022-08-22 12:33:35.061872 (MainThread): Acquiring new postgres connection "test.dbt_test.my_test".
2022-08-22 12:33:35.064926 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:33:35.110564 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:33:35.112658 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-08-22 12:33:35.133900 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07acb8e6-6ebb-4e29-a534-d017b851a3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbf24d0>]}
2022-08-22 12:33:35.139935 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-08-22 12:33:35.140548 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07acb8e6-6ebb-4e29-a534-d017b851a3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc2a4d0>]}
2022-08-22 12:33:35.140872 (MainThread): Found 7 models, 3 tests, 2 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2022-08-22 12:33:35.142443 (MainThread): 
2022-08-22 12:33:35.142839 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:33:35.143789 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvdrental".
2022-08-22 12:33:35.155859 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvdrental".
2022-08-22 12:33:35.156099 (ThreadPoolExecutor-0_0): On list_dvdrental: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
2022-08-22 12:33:35.156303 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-22 12:33:35.215078 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.06 seconds
2022-08-22 12:33:35.217036 (ThreadPoolExecutor-0_0): On list_dvdrental: Close
2022-08-22 12:33:35.218731 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvdrental_snapshots".
2022-08-22 12:33:35.219211 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:33:35.226623 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:33:35.228282 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:33:35.228522 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: BEGIN
2022-08-22 12:33:35.228762 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: BEGIN
2022-08-22 12:33:35.228992 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-22 12:33:35.229230 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-08-22 12:33:35.248212 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:33:35.248572 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvdrental_snapshots".
2022-08-22 12:33:35.248786 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_snapshots"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
2022-08-22 12:33:35.249802 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:33:35.250069 (ThreadPoolExecutor-1_1): Using postgres connection "list_dvdrental_dvd_schema".
2022-08-22 12:33:35.250281 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dvdrental_dvd_schema"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dvd_schema'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dvd_schema'
  
2022-08-22 12:33:35.265245 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.02 seconds
2022-08-22 12:33:35.266817 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: ROLLBACK
2022-08-22 12:33:35.267071 (ThreadPoolExecutor-1_1): SQL status: SELECT 7 in 0.02 seconds
2022-08-22 12:33:35.268553 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: ROLLBACK
2022-08-22 12:33:35.268790 (ThreadPoolExecutor-1_0): On list_dvdrental_snapshots: Close
2022-08-22 12:33:35.270169 (ThreadPoolExecutor-1_1): On list_dvdrental_dvd_schema: Close
2022-08-22 12:33:35.276081 (MainThread): Using postgres connection "master".
2022-08-22 12:33:35.276368 (MainThread): On master: BEGIN
2022-08-22 12:33:35.276756 (MainThread): Opening a new connection, currently in state init
2022-08-22 12:33:35.294704 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:33:35.295030 (MainThread): Using postgres connection "master".
2022-08-22 12:33:35.295267 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-08-22 12:33:35.531449 (MainThread): SQL status: SELECT 38 in 0.24 seconds
2022-08-22 12:33:35.539041 (MainThread): On master: ROLLBACK
2022-08-22 12:33:35.540621 (MainThread): Using postgres connection "master".
2022-08-22 12:33:35.540976 (MainThread): On master: BEGIN
2022-08-22 12:33:35.542882 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-08-22 12:33:35.543164 (MainThread): On master: COMMIT
2022-08-22 12:33:35.543386 (MainThread): Using postgres connection "master".
2022-08-22 12:33:35.543584 (MainThread): On master: COMMIT
2022-08-22 12:33:35.544678 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:33:35.544959 (MainThread): On master: Close
2022-08-22 12:33:35.545424 (MainThread): 15:33:35 | Concurrency: 4 threads (target='dev')
2022-08-22 12:33:35.545681 (MainThread): 15:33:35 | 
2022-08-22 12:33:35.547798 (Thread-1): Began running node model.dbt_test.macro_use
2022-08-22 12:33:35.548240 (Thread-1): 15:33:35 | 1 of 1 START table model dvd_schema.macro_use........................ [RUN]
2022-08-22 12:33:35.548680 (Thread-1): Acquiring new postgres connection "model.dbt_test.macro_use".
2022-08-22 12:33:35.548936 (Thread-1): Compiling model.dbt_test.macro_use
2022-08-22 12:33:35.552163 (Thread-1): Writing injected SQL for node "model.dbt_test.macro_use"
2022-08-22 12:33:35.552898 (Thread-1): finished collecting timing info
2022-08-22 12:33:35.587223 (Thread-1): Writing runtime SQL for node "model.dbt_test.macro_use"
2022-08-22 12:33:35.587979 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:33:35.588225 (Thread-1): On model.dbt_test.macro_use: BEGIN
2022-08-22 12:33:35.588458 (Thread-1): Opening a new connection, currently in state closed
2022-08-22 12:33:35.605147 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:33:35.605493 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:33:35.605705 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */


  create  table "dvdrental"."dvd_schema"."macro_use__dbt_tmp"
  as (
    select
a.*,

    cast (last_update as timestamp)
 as "last_update_2"
from "dvdrental"."snapshots"."actor_snapshot_scd" a
  );
2022-08-22 12:33:35.651249 (Thread-1): SQL status: SELECT 201 in 0.05 seconds
2022-08-22 12:33:35.658648 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:33:35.658895 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */
alter table "dvdrental"."dvd_schema"."macro_use" rename to "macro_use__dbt_backup"
2022-08-22 12:33:35.660550 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 12:33:35.663886 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:33:35.664118 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */
alter table "dvdrental"."dvd_schema"."macro_use__dbt_tmp" rename to "macro_use"
2022-08-22 12:33:35.665428 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-08-22 12:33:35.678430 (Thread-1): On model.dbt_test.macro_use: COMMIT
2022-08-22 12:33:35.678680 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:33:35.678897 (Thread-1): On model.dbt_test.macro_use: COMMIT
2022-08-22 12:33:35.686996 (Thread-1): SQL status: COMMIT in 0.01 seconds
2022-08-22 12:33:35.692701 (Thread-1): Using postgres connection "model.dbt_test.macro_use".
2022-08-22 12:33:35.692947 (Thread-1): On model.dbt_test.macro_use: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.macro_use"} */
drop table if exists "dvdrental"."dvd_schema"."macro_use__dbt_backup" cascade
2022-08-22 12:33:35.717989 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2022-08-22 12:33:35.719429 (Thread-1): finished collecting timing info
2022-08-22 12:33:35.719708 (Thread-1): On model.dbt_test.macro_use: Close
2022-08-22 12:33:35.720183 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07acb8e6-6ebb-4e29-a534-d017b851a3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbf2410>]}
2022-08-22 12:33:35.720624 (Thread-1): 15:33:35 | 1 of 1 OK created table model dvd_schema.macro_use................... [SELECT 201 in 0.17s]
2022-08-22 12:33:35.720870 (Thread-1): Finished running node model.dbt_test.macro_use
2022-08-22 12:33:35.753170 (MainThread): Acquiring new postgres connection "master".
2022-08-22 12:33:35.753530 (MainThread): Using postgres connection "master".
2022-08-22 12:33:35.753735 (MainThread): On master: BEGIN
2022-08-22 12:33:35.753936 (MainThread): Opening a new connection, currently in state closed
2022-08-22 12:33:35.771220 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-08-22 12:33:35.771549 (MainThread): On master: COMMIT
2022-08-22 12:33:35.771751 (MainThread): Using postgres connection "master".
2022-08-22 12:33:35.771943 (MainThread): On master: COMMIT
2022-08-22 12:33:35.773210 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-08-22 12:33:35.773487 (MainThread): On master: Close
2022-08-22 12:33:35.773933 (MainThread): 15:33:35 | 
2022-08-22 12:33:35.774182 (MainThread): 15:33:35 | Finished running 1 table model in 0.63s.
2022-08-22 12:33:35.774408 (MainThread): Connection 'master' was properly closed.
2022-08-22 12:33:35.774595 (MainThread): Connection 'model.dbt_test.macro_use' was properly closed.
2022-08-22 12:33:35.774777 (MainThread): Connection 'list_dvdrental_dvd_schema' was properly closed.
2022-08-22 12:33:35.780609 (MainThread): 
2022-08-22 12:33:35.780893 (MainThread): Completed successfully
2022-08-22 12:33:35.781122 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-08-22 12:33:35.781418 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dae0b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d616ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e40c4d0>]}
2022-08-22 12:33:35.781713 (MainThread): Flushing usage events
2022-08-22 12:37:43.332457 (MainThread): Running with dbt=0.21.1
2022-08-22 12:37:43.430560 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/victorchudnovskiy/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-08-22 12:37:43.431287 (MainThread): Tracking: tracking
2022-08-22 12:37:43.446677 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c82950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c8d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c8d610>]}
2022-08-22 12:37:43.448723 (MainThread): Set downloads directory='/var/folders/4g/qkbvy9w95bqfkcs94vtl99ph0000gn/T/dbt-downloads-kb7e_dvu'
2022-08-22 12:37:43.449590 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-08-22 12:37:43.604940 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-08-22 12:37:43.605458 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-08-22 12:37:43.695263 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-08-22 12:37:43.726253 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.6.json
2022-08-22 12:37:43.813773 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.6.json 200
2022-08-22 12:37:43.814317 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-08-22 12:37:43.913541 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-08-22 12:37:43.950039 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.6.json
2022-08-22 12:37:44.049800 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.6.json 200
2022-08-22 12:37:44.050485 (MainThread): Installing dbt-labs/dbt_utils@0.8.6
2022-08-22 12:37:44.576972 (MainThread):   Installed from version 0.8.6
2022-08-22 12:37:44.577287 (MainThread):   Up to date!
2022-08-22 12:37:44.577603 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '363f8891-acc0-4189-957a-7f758ddddc8f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c69a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d0ac90>]}
2022-08-22 12:37:44.578336 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c82f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c82950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c698d0>]}
2022-08-22 12:37:44.578620 (MainThread): Flushing usage events
